<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>openbiz: E:/E/GEAMP/www/openbiz/openbiz/others/Zend/Json/Server/Smd.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>E:/E/GEAMP/www/openbiz/openbiz/others/Zend/Json/Server/Smd.php</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00030"></a><a class="code" href="class_zend___json___server___smd.html">00030</a> <span class="keyword">class </span><a class="code" href="class_zend___json___server___smd.html">Zend_Json_Server_Smd</a>
<a name="l00031"></a>00031 {
<a name="l00032"></a>00032     <span class="keyword">const</span> ENV_JSONRPC_1 = <span class="stringliteral">&#39;JSON-RPC-1.0&#39;</span>;
<a name="l00033"></a>00033     <span class="keyword">const</span> ENV_JSONRPC_2 = <span class="stringliteral">&#39;JSON-RPC-2.0&#39;</span>;
<a name="l00034"></a>00034     <span class="keyword">const</span> SMD_VERSION   = <span class="stringliteral">&#39;2.0&#39;</span>;
<a name="l00035"></a>00035 
<a name="l00040"></a>00040     <span class="keyword">protected</span> $_contentType = <span class="stringliteral">&#39;application/json&#39;</span>;
<a name="l00041"></a>00041 
<a name="l00046"></a>00046     <span class="keyword">protected</span> $_contentTypeRegex = <span class="stringliteral">&#39;#[a-z]+/[a-z][a-z-]+#i&#39;</span>;
<a name="l00047"></a>00047 
<a name="l00052"></a>00052     <span class="keyword">protected</span> $_description;
<a name="l00053"></a>00053 
<a name="l00058"></a>00058     <span class="keyword">protected</span> $_dojoCompatible = <span class="keyword">false</span>;
<a name="l00059"></a>00059 
<a name="l00064"></a>00064     <span class="keyword">protected</span> $_envelope = self::ENV_JSONRPC_1;
<a name="l00065"></a>00065 
<a name="l00070"></a>00070     <span class="keyword">protected</span> $_envelopeTypes = array(
<a name="l00071"></a>00071         self::ENV_JSONRPC_1,
<a name="l00072"></a>00072         self::ENV_JSONRPC_2,
<a name="l00073"></a>00073     );
<a name="l00074"></a>00074 
<a name="l00079"></a>00079     <span class="keyword">protected</span> $_id;
<a name="l00080"></a>00080 
<a name="l00085"></a>00085     <span class="keyword">protected</span> $_services = array();
<a name="l00086"></a>00086 
<a name="l00091"></a>00091     <span class="keyword">protected</span> $_target;
<a name="l00092"></a>00092 
<a name="l00097"></a>00097     <span class="keyword">protected</span> $_transport = <span class="stringliteral">&#39;POST&#39;</span>;
<a name="l00098"></a>00098 
<a name="l00103"></a>00103     <span class="keyword">protected</span> $_transportTypes = array(<span class="stringliteral">&#39;POST&#39;</span>);
<a name="l00104"></a>00104 
<a name="l00111"></a><a class="code" href="class_zend___json___server___smd.html#a673b5e9db470a52ea28b56a44e23e2d0">00111</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a673b5e9db470a52ea28b56a44e23e2d0">setOptions</a>(array $options)
<a name="l00112"></a>00112     {
<a name="l00113"></a>00113         $methods = get_class_methods($this);
<a name="l00114"></a>00114         <span class="keywordflow">foreach</span> ($options as $key =&gt; $value) {
<a name="l00115"></a>00115             $method = <span class="stringliteral">&#39;set&#39;</span> . ucfirst($key);
<a name="l00116"></a>00116             <span class="keywordflow">if</span> (in_array($method, $methods)) {
<a name="l00117"></a>00117                 $this-&gt;$method($value);
<a name="l00118"></a>00118             }
<a name="l00119"></a>00119         }
<a name="l00120"></a>00120         <span class="keywordflow">return</span> $this;
<a name="l00121"></a>00121     }
<a name="l00122"></a>00122 
<a name="l00129"></a><a class="code" href="class_zend___json___server___smd.html#a284c7a972bd7222cdd1f5a96f369471c">00129</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a284c7a972bd7222cdd1f5a96f369471c">setTransport</a>($transport)
<a name="l00130"></a>00130     {
<a name="l00131"></a>00131         <span class="keywordflow">if</span> (!in_array($transport, $this-&gt;_transportTypes)) {
<a name="l00132"></a>00132             require_once <span class="stringliteral">&#39;Zend/Json/Server/Exception.php&#39;</span>;
<a name="l00133"></a>00133             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___json___server___exception.html">Zend_Json_Server_Exception</a>(sprintf(<span class="stringliteral">&#39;Invalid transport &quot;%s&quot; specified&#39;</span>, $transport));
<a name="l00134"></a>00134         }
<a name="l00135"></a>00135         $this-&gt;_transport = $transport;
<a name="l00136"></a>00136         <span class="keywordflow">return</span> $this;
<a name="l00137"></a>00137     }
<a name="l00138"></a>00138 
<a name="l00144"></a><a class="code" href="class_zend___json___server___smd.html#a62db13394d9416f4cfc864858cca433b">00144</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a62db13394d9416f4cfc864858cca433b">getTransport</a>()
<a name="l00145"></a>00145     {
<a name="l00146"></a>00146         <span class="keywordflow">return</span> $this-&gt;_transport;
<a name="l00147"></a>00147     }
<a name="l00148"></a>00148 
<a name="l00155"></a><a class="code" href="class_zend___json___server___smd.html#aa426d69a4342b561b690d3988fda4770">00155</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#aa426d69a4342b561b690d3988fda4770">setEnvelope</a>($envelopeType)
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157         <span class="keywordflow">if</span> (!in_array($envelopeType, $this-&gt;_envelopeTypes)) {
<a name="l00158"></a>00158             require_once <span class="stringliteral">&#39;Zend/Json/Server/Exception.php&#39;</span>;
<a name="l00159"></a>00159             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___json___server___exception.html">Zend_Json_Server_Exception</a>(sprintf(<span class="stringliteral">&#39;Invalid envelope type &quot;%s&quot;&#39;</span>, $envelopeType));
<a name="l00160"></a>00160         }
<a name="l00161"></a>00161         $this-&gt;_envelope = $envelopeType;
<a name="l00162"></a>00162         <span class="keywordflow">return</span> $this;
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164 
<a name="l00170"></a><a class="code" href="class_zend___json___server___smd.html#a16d85a51fe5b156ff2ddfd3b2c2dfc8f">00170</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a16d85a51fe5b156ff2ddfd3b2c2dfc8f">getEnvelope</a>()
<a name="l00171"></a>00171     {
<a name="l00172"></a>00172         <span class="keywordflow">return</span> $this-&gt;_envelope;
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     <span class="comment">// Content-Type of response; default to application/json</span>
<a name="l00182"></a><a class="code" href="class_zend___json___server___smd.html#a6dcde4eabba25c2d428ae6939a5e82b5">00182</a> <span class="comment"></span>    <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a6dcde4eabba25c2d428ae6939a5e82b5">setContentType</a>($type)
<a name="l00183"></a>00183     {
<a name="l00184"></a>00184         <span class="keywordflow">if</span> (!preg_match($this-&gt;_contentTypeRegex, $type)) {
<a name="l00185"></a>00185             require_once <span class="stringliteral">&#39;Zend/Json/Server/Exception.php&#39;</span>;
<a name="l00186"></a>00186             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___json___server___exception.html">Zend_Json_Server_Exception</a>(sprintf(<span class="stringliteral">&#39;Invalid content type &quot;%s&quot; specified&#39;</span>, $type));
<a name="l00187"></a>00187         }
<a name="l00188"></a>00188         $this-&gt;_contentType = $type;
<a name="l00189"></a>00189         <span class="keywordflow">return</span> $this;
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191 
<a name="l00197"></a><a class="code" href="class_zend___json___server___smd.html#aa843137beb02bc2516fe0551c00ff7d7">00197</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#aa843137beb02bc2516fe0551c00ff7d7">getContentType</a>()
<a name="l00198"></a>00198     {
<a name="l00199"></a>00199         <span class="keywordflow">return</span> $this-&gt;_contentType;
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201 
<a name="l00208"></a><a class="code" href="class_zend___json___server___smd.html#a67db5a56c9949f916f1b3d0629ff08ea">00208</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a67db5a56c9949f916f1b3d0629ff08ea">setTarget</a>($target)
<a name="l00209"></a>00209     {
<a name="l00210"></a>00210         $this-&gt;_target = (string) $target;
<a name="l00211"></a>00211         <span class="keywordflow">return</span> $this;
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213 
<a name="l00219"></a><a class="code" href="class_zend___json___server___smd.html#afd77d5a1c164c8d6f4a18cbf9c341410">00219</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#afd77d5a1c164c8d6f4a18cbf9c341410">getTarget</a>()
<a name="l00220"></a>00220     {
<a name="l00221"></a>00221         <span class="keywordflow">return</span> $this-&gt;_target;
<a name="l00222"></a>00222     }
<a name="l00223"></a>00223 
<a name="l00230"></a><a class="code" href="class_zend___json___server___smd.html#a87313ad678fb2a2a8efb435cf0bdb9a0">00230</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a87313ad678fb2a2a8efb435cf0bdb9a0">setId</a>($id)
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232         $this-&gt;_id = (string) $id;
<a name="l00233"></a>00233         <span class="keywordflow">return</span> $this-&gt;_id;
<a name="l00234"></a>00234     }
<a name="l00235"></a>00235 
<a name="l00241"></a><a class="code" href="class_zend___json___server___smd.html#a12251d0c022e9e21c137a105ff683f13">00241</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a12251d0c022e9e21c137a105ff683f13">getId</a>()
<a name="l00242"></a>00242     {
<a name="l00243"></a>00243         <span class="keywordflow">return</span> $this-&gt;_id;
<a name="l00244"></a>00244     }
<a name="l00245"></a>00245 
<a name="l00252"></a><a class="code" href="class_zend___json___server___smd.html#a31fad3e39336ea079ea758e051866627">00252</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a31fad3e39336ea079ea758e051866627">setDescription</a>($description)
<a name="l00253"></a>00253     {
<a name="l00254"></a>00254         $this-&gt;_description = (string) $description;
<a name="l00255"></a>00255         <span class="keywordflow">return</span> $this-&gt;_description;
<a name="l00256"></a>00256     }
<a name="l00257"></a>00257 
<a name="l00263"></a><a class="code" href="class_zend___json___server___smd.html#a2e7bb35c71bf1824456ceb944cb7a845">00263</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a2e7bb35c71bf1824456ceb944cb7a845">getDescription</a>()
<a name="l00264"></a>00264     {
<a name="l00265"></a>00265         <span class="keywordflow">return</span> $this-&gt;_description;
<a name="l00266"></a>00266     }
<a name="l00267"></a>00267 
<a name="l00274"></a><a class="code" href="class_zend___json___server___smd.html#aec1ba734987405abdef2a46fd47754fb">00274</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#aec1ba734987405abdef2a46fd47754fb">setDojoCompatible</a>($flag)
<a name="l00275"></a>00275     {
<a name="l00276"></a>00276         $this-&gt;_dojoCompatible = (bool) $flag;
<a name="l00277"></a>00277         <span class="keywordflow">return</span> $this;
<a name="l00278"></a>00278     }
<a name="l00279"></a>00279 
<a name="l00285"></a><a class="code" href="class_zend___json___server___smd.html#ae1d31e57b22505c6460219f844002ec9">00285</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#ae1d31e57b22505c6460219f844002ec9">isDojoCompatible</a>()
<a name="l00286"></a>00286     {
<a name="l00287"></a>00287         <span class="keywordflow">return</span> $this-&gt;_dojoCompatible;
<a name="l00288"></a>00288     }
<a name="l00289"></a>00289 
<a name="l00296"></a><a class="code" href="class_zend___json___server___smd.html#ab7aabcd2f0ab70d9ee3f6cc9ee1441d7">00296</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#ab7aabcd2f0ab70d9ee3f6cc9ee1441d7">addService</a>($service)
<a name="l00297"></a>00297     {
<a name="l00298"></a>00298         require_once <span class="stringliteral">&#39;Zend/Json/Server/Smd/Service.php&#39;</span>;
<a name="l00299"></a>00299 
<a name="l00300"></a>00300         <span class="keywordflow">if</span> ($service instanceof <a class="code" href="class_zend___json___server___smd___service.html">Zend_Json_Server_Smd_Service</a>) {
<a name="l00301"></a>00301             $name = $service-&gt;getName();
<a name="l00302"></a>00302         } elseif (is_array($service)) {
<a name="l00303"></a>00303             $service = <span class="keyword">new</span> Zend_Json_Server_Smd_Service($service);
<a name="l00304"></a>00304             $name = $service-&gt;getName();
<a name="l00305"></a>00305         } <span class="keywordflow">else</span> {
<a name="l00306"></a>00306             require_once <span class="stringliteral">&#39;Zend/Json/Server/Exception.php&#39;</span>;
<a name="l00307"></a>00307             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___json___server___exception.html">Zend_Json_Server_Exception</a>(<span class="stringliteral">&#39;Invalid service passed to addService()&#39;</span>);
<a name="l00308"></a>00308         }
<a name="l00309"></a>00309 
<a name="l00310"></a>00310         <span class="keywordflow">if</span> (array_key_exists($name, $this-&gt;_services)) {
<a name="l00311"></a>00311             require_once <span class="stringliteral">&#39;Zend/Json/Server/Exception.php&#39;</span>;
<a name="l00312"></a>00312             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___json___server___exception.html">Zend_Json_Server_Exception</a>(<span class="stringliteral">&#39;Attempt to register a service already registered detected&#39;</span>);
<a name="l00313"></a>00313         }
<a name="l00314"></a>00314         $this-&gt;_services[$name] = $service;
<a name="l00315"></a>00315         <span class="keywordflow">return</span> $this;
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317 
<a name="l00324"></a><a class="code" href="class_zend___json___server___smd.html#a5ced19d130a1a840bc27f811bac7cb48">00324</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a5ced19d130a1a840bc27f811bac7cb48">addServices</a>(array $services)
<a name="l00325"></a>00325     {
<a name="l00326"></a>00326         <span class="keywordflow">foreach</span> ($services as $service) {
<a name="l00327"></a>00327             $this-&gt;<a class="code" href="class_zend___json___server___smd.html#ab7aabcd2f0ab70d9ee3f6cc9ee1441d7">addService</a>($service);
<a name="l00328"></a>00328         }
<a name="l00329"></a>00329         <span class="keywordflow">return</span> $this;
<a name="l00330"></a>00330     }
<a name="l00331"></a>00331 
<a name="l00338"></a><a class="code" href="class_zend___json___server___smd.html#adf9a7ff9091d667605ba9cdf48043105">00338</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#adf9a7ff9091d667605ba9cdf48043105">setServices</a>(array $services)
<a name="l00339"></a>00339     {
<a name="l00340"></a>00340         $this-&gt;_services = array();
<a name="l00341"></a>00341         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___json___server___smd.html#a5ced19d130a1a840bc27f811bac7cb48">addServices</a>($services);
<a name="l00342"></a>00342     }
<a name="l00343"></a>00343 
<a name="l00350"></a><a class="code" href="class_zend___json___server___smd.html#a2488d36323e4b47e0af9bbc6f4772214">00350</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a2488d36323e4b47e0af9bbc6f4772214">getService</a>($name)
<a name="l00351"></a>00351     {
<a name="l00352"></a>00352         <span class="keywordflow">if</span> (array_key_exists($name, $this-&gt;_services)) {
<a name="l00353"></a>00353             <span class="keywordflow">return</span> $this-&gt;_services[$name];
<a name="l00354"></a>00354         }
<a name="l00355"></a>00355         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00356"></a>00356     }
<a name="l00357"></a>00357 
<a name="l00363"></a><a class="code" href="class_zend___json___server___smd.html#a36d7e45e7f713b49a02b4988be6cbcd1">00363</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a36d7e45e7f713b49a02b4988be6cbcd1">getServices</a>()
<a name="l00364"></a>00364     {
<a name="l00365"></a>00365         <span class="keywordflow">return</span> $this-&gt;_services;
<a name="l00366"></a>00366     }
<a name="l00367"></a>00367 
<a name="l00374"></a><a class="code" href="class_zend___json___server___smd.html#aefb66a44affeb8d469867a15b05913c2">00374</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#aefb66a44affeb8d469867a15b05913c2">removeService</a>($name)
<a name="l00375"></a>00375     {
<a name="l00376"></a>00376         <span class="keywordflow">if</span> (array_key_exists($name, $this-&gt;_services)) {
<a name="l00377"></a>00377             unset($this-&gt;_services[$name]);
<a name="l00378"></a>00378             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00379"></a>00379         }
<a name="l00380"></a>00380         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00381"></a>00381     }
<a name="l00382"></a>00382 
<a name="l00388"></a><a class="code" href="class_zend___json___server___smd.html#a658defb34762c8f40085aec87e16ba1a">00388</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a658defb34762c8f40085aec87e16ba1a">toArray</a>()
<a name="l00389"></a>00389     {
<a name="l00390"></a>00390         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_zend___json___server___smd.html#ae1d31e57b22505c6460219f844002ec9">isDojoCompatible</a>()) {
<a name="l00391"></a>00391             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___json___server___smd.html#afba38cf2155095d8ef27c22f28147e57">toDojoArray</a>();
<a name="l00392"></a>00392         }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394         $transport   = $this-&gt;<a class="code" href="class_zend___json___server___smd.html#a62db13394d9416f4cfc864858cca433b">getTransport</a>();
<a name="l00395"></a>00395         $envelope    = $this-&gt;<a class="code" href="class_zend___json___server___smd.html#a16d85a51fe5b156ff2ddfd3b2c2dfc8f">getEnvelope</a>();
<a name="l00396"></a>00396         $contentType = $this-&gt;<a class="code" href="class_zend___json___server___smd.html#aa843137beb02bc2516fe0551c00ff7d7">getContentType</a>();
<a name="l00397"></a>00397         $SMDVersion  = self::SMD_VERSION;
<a name="l00398"></a>00398         $service = compact(<span class="stringliteral">&#39;transport&#39;</span>, <span class="stringliteral">&#39;envelope&#39;</span>, <span class="stringliteral">&#39;contentType&#39;</span>, <span class="stringliteral">&#39;SMDVersion&#39;</span>);
<a name="l00399"></a>00399 
<a name="l00400"></a>00400         <span class="keywordflow">if</span> (null !== ($target = $this-&gt;<a class="code" href="class_zend___json___server___smd.html#afd77d5a1c164c8d6f4a18cbf9c341410">getTarget</a>())) {
<a name="l00401"></a>00401             $service[<span class="stringliteral">&#39;target&#39;</span>]     = $target;
<a name="l00402"></a>00402         }
<a name="l00403"></a>00403         <span class="keywordflow">if</span> (null !== ($id = $this-&gt;<a class="code" href="class_zend___json___server___smd.html#a12251d0c022e9e21c137a105ff683f13">getId</a>())) {
<a name="l00404"></a>00404             $service[<span class="stringliteral">&#39;id&#39;</span>] = $id;
<a name="l00405"></a>00405         }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407         $services = $this-&gt;<a class="code" href="class_zend___json___server___smd.html#a36d7e45e7f713b49a02b4988be6cbcd1">getServices</a>();
<a name="l00408"></a>00408         <span class="keywordflow">if</span> (!empty($services)) {
<a name="l00409"></a>00409             $service[<span class="stringliteral">&#39;services&#39;</span>] = array();
<a name="l00410"></a>00410             <span class="keywordflow">foreach</span> ($services as $name =&gt; $svc) {
<a name="l00411"></a>00411                 $svc-&gt;setEnvelope($envelope);
<a name="l00412"></a>00412                 $service[<span class="stringliteral">&#39;services&#39;</span>][$name] = $svc-&gt;toArray();
<a name="l00413"></a>00413             }
<a name="l00414"></a>00414             $service[<span class="stringliteral">&#39;methods&#39;</span>] = $service[<span class="stringliteral">&#39;services&#39;</span>];
<a name="l00415"></a>00415         }
<a name="l00416"></a>00416 
<a name="l00417"></a>00417         <span class="keywordflow">return</span> $service;
<a name="l00418"></a>00418     }
<a name="l00419"></a>00419 
<a name="l00425"></a><a class="code" href="class_zend___json___server___smd.html#afba38cf2155095d8ef27c22f28147e57">00425</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#afba38cf2155095d8ef27c22f28147e57">toDojoArray</a>()
<a name="l00426"></a>00426     {
<a name="l00427"></a>00427         $SMDVersion  = <span class="stringliteral">&#39;.1&#39;</span>;
<a name="l00428"></a>00428         $serviceType = <span class="stringliteral">&#39;JSON-RPC&#39;</span>;
<a name="l00429"></a>00429         $service = compact(<span class="stringliteral">&#39;SMDVersion&#39;</span>, <span class="stringliteral">&#39;serviceType&#39;</span>);
<a name="l00430"></a>00430 
<a name="l00431"></a>00431         $target = $this-&gt;<a class="code" href="class_zend___json___server___smd.html#afd77d5a1c164c8d6f4a18cbf9c341410">getTarget</a>();
<a name="l00432"></a>00432 
<a name="l00433"></a>00433         $services = $this-&gt;<a class="code" href="class_zend___json___server___smd.html#a36d7e45e7f713b49a02b4988be6cbcd1">getServices</a>();
<a name="l00434"></a>00434         <span class="keywordflow">if</span> (!empty($services)) {
<a name="l00435"></a>00435             $service[<span class="stringliteral">&#39;methods&#39;</span>] = array();
<a name="l00436"></a>00436             <span class="keywordflow">foreach</span> ($services as $name =&gt; $svc) {
<a name="l00437"></a>00437                 $method = array(
<a name="l00438"></a>00438                     <span class="stringliteral">&#39;name&#39;</span>       =&gt; $name,
<a name="l00439"></a>00439                     <span class="stringliteral">&#39;serviceURL&#39;</span> =&gt; $target,
<a name="l00440"></a>00440                 );
<a name="l00441"></a>00441                 $params = array();
<a name="l00442"></a>00442                 <span class="keywordflow">foreach</span> ($svc-&gt;getParams() as $param) {
<a name="l00443"></a>00443                     $paramName = array_key_exists(<span class="stringliteral">&#39;name&#39;</span>, $param) ? $param[<span class="stringliteral">&#39;name&#39;</span>] : $param[<span class="stringliteral">&#39;type&#39;</span>];
<a name="l00444"></a>00444                     $params[] = array(
<a name="l00445"></a>00445                         <span class="stringliteral">&#39;name&#39;</span> =&gt; $paramName,
<a name="l00446"></a>00446                         <span class="stringliteral">&#39;type&#39;</span> =&gt; $param[<span class="stringliteral">&#39;type&#39;</span>],
<a name="l00447"></a>00447                     );
<a name="l00448"></a>00448                 }
<a name="l00449"></a>00449                 <span class="keywordflow">if</span> (!empty($params)) {
<a name="l00450"></a>00450                     $method[<span class="stringliteral">&#39;parameters&#39;</span>] = $params;
<a name="l00451"></a>00451                 }
<a name="l00452"></a>00452                 $service[<span class="stringliteral">&#39;methods&#39;</span>][] = $method;
<a name="l00453"></a>00453             }
<a name="l00454"></a>00454         }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456         <span class="keywordflow">return</span> $service;
<a name="l00457"></a>00457     }
<a name="l00458"></a>00458 
<a name="l00464"></a><a class="code" href="class_zend___json___server___smd.html#abb4e56e2f91e542d8ce2c9f2a7a944c1">00464</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#abb4e56e2f91e542d8ce2c9f2a7a944c1">toJson</a>()
<a name="l00465"></a>00465     {
<a name="l00466"></a>00466         require_once <span class="stringliteral">&#39;Zend/Json.php&#39;</span>;
<a name="l00467"></a>00467         <span class="keywordflow">return</span> <a class="code" href="class_zend___json.html#a08a9eac5e7042af1e08b87614e41ec25">Zend_Json::encode</a>($this-&gt;<a class="code" href="class_zend___json___server___smd.html#a658defb34762c8f40085aec87e16ba1a">toArray</a>());
<a name="l00468"></a>00468     }
<a name="l00469"></a>00469 
<a name="l00475"></a><a class="code" href="class_zend___json___server___smd.html#a7516ca30af0db3cdbf9a7739b48ce91d">00475</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___json___server___smd.html#a7516ca30af0db3cdbf9a7739b48ce91d">__toString</a>()
<a name="l00476"></a>00476     {
<a name="l00477"></a>00477         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___json___server___smd.html#abb4e56e2f91e542d8ce2c9f2a7a944c1">toJson</a>();
<a name="l00478"></a>00478     }
<a name="l00479"></a>00479 }
<a name="l00480"></a>00480 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Apr 19 2012 17:01:17 for openbiz by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
