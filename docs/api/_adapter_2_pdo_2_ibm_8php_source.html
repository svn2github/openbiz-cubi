<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>openbiz: E:/E/GEAMP/www/openbiz/openbiz/others/Zend/Db/Adapter/Pdo/Ibm.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>E:/E/GEAMP/www/openbiz/openbiz/others/Zend/Db/Adapter/Pdo/Ibm.php</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00025"></a>00025 require_once <span class="stringliteral">&#39;Zend/Db/Adapter/Pdo/Abstract.php&#39;</span>;
<a name="l00026"></a>00026 
<a name="l00028"></a>00028 require_once <span class="stringliteral">&#39;Zend/Db/Adapter/Pdo/Ibm/Db2.php&#39;</span>;
<a name="l00029"></a>00029 
<a name="l00031"></a>00031 require_once <span class="stringliteral">&#39;Zend/Db/Adapter/Pdo/Ibm/Ids.php&#39;</span>;
<a name="l00032"></a>00032 
<a name="l00034"></a>00034 require_once <span class="stringliteral">&#39;Zend/Db/Statement/Pdo/Ibm.php&#39;</span>;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00044"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html">00044</a> <span class="keyword">class </span><a class="code" href="class_zend___db___adapter___pdo___ibm.html">Zend_Db_Adapter_Pdo_Ibm</a> <span class="keyword">extends</span> <a class="code" href="class_zend___db___adapter___pdo___abstract.html">Zend_Db_Adapter_Pdo_Abstract</a>
<a name="l00045"></a>00045 {
<a name="l00051"></a>00051     <span class="keyword">protected</span> $_pdoType = <span class="stringliteral">&#39;ibm&#39;</span>;
<a name="l00052"></a>00052 
<a name="l00058"></a>00058     <span class="keyword">protected</span> $_serverType = null;
<a name="l00059"></a>00059 
<a name="l00071"></a>00071     <span class="keyword">protected</span> $_numericDataTypes = array(
<a name="l00072"></a>00072                         <a class="code" href="class_zend___db.html#affecef211960acad23a2b28b618b207c">Zend_Db::INT_TYPE</a>    =&gt; <a class="code" href="class_zend___db.html#affecef211960acad23a2b28b618b207c">Zend_Db::INT_TYPE</a>,
<a name="l00073"></a>00073                         Zend_Db::BIGINT_TYPE =&gt; Zend_Db::BIGINT_TYPE,
<a name="l00074"></a>00074                         Zend_Db::FLOAT_TYPE  =&gt; Zend_Db::FLOAT_TYPE,
<a name="l00075"></a>00075                         <span class="stringliteral">&#39;INTEGER&#39;</span>            =&gt; <a class="code" href="class_zend___db.html#affecef211960acad23a2b28b618b207c">Zend_Db::INT_TYPE</a>,
<a name="l00076"></a>00076                         <span class="stringliteral">&#39;SMALLINT&#39;</span>           =&gt; <a class="code" href="class_zend___db.html#affecef211960acad23a2b28b618b207c">Zend_Db::INT_TYPE</a>,
<a name="l00077"></a>00077                         <span class="stringliteral">&#39;BIGINT&#39;</span>             =&gt; Zend_Db::BIGINT_TYPE,
<a name="l00078"></a>00078                         <span class="stringliteral">&#39;DECIMAL&#39;</span>            =&gt; Zend_Db::FLOAT_TYPE,
<a name="l00079"></a>00079                         <span class="stringliteral">&#39;DEC&#39;</span>                =&gt; Zend_Db::FLOAT_TYPE,
<a name="l00080"></a>00080                         <span class="stringliteral">&#39;REAL&#39;</span>               =&gt; Zend_Db::FLOAT_TYPE,
<a name="l00081"></a>00081                         <span class="stringliteral">&#39;NUMERIC&#39;</span>            =&gt; Zend_Db::FLOAT_TYPE,
<a name="l00082"></a>00082                         <span class="stringliteral">&#39;DOUBLE PRECISION&#39;</span>   =&gt; Zend_Db::FLOAT_TYPE,
<a name="l00083"></a>00083                         <span class="stringliteral">&#39;FLOAT&#39;</span>              =&gt; Zend_Db::FLOAT_TYPE
<a name="l00084"></a>00084                         );
<a name="l00085"></a>00085 
<a name="l00096"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">00096</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">_connect</a>()
<a name="l00097"></a>00097     {
<a name="l00098"></a>00098         <span class="keywordflow">if</span> ($this-&gt;_connection) {
<a name="l00099"></a>00099             <span class="keywordflow">return</span>;
<a name="l00100"></a>00100         }
<a name="l00101"></a>00101         <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">parent::_connect</a>();
<a name="l00102"></a>00102 
<a name="l00103"></a>00103         $this-&gt;<a class="code" href="class_zend___db___adapter___abstract.html#ab7a0a080d0e721c656eef11cd641638b">getConnection</a>()-&gt;setAttribute(Zend_Db::ATTR_STRINGIFY_FETCHES, <span class="keyword">true</span>);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105         <span class="keywordflow">try</span> {
<a name="l00106"></a>00106             <span class="keywordflow">if</span> ($this-&gt;_serverType === null) {
<a name="l00107"></a>00107                 $server = substr($this-&gt;<a class="code" href="class_zend___db___adapter___abstract.html#ab7a0a080d0e721c656eef11cd641638b">getConnection</a>()-&gt;getAttribute(PDO::ATTR_SERVER_INFO), 0, 3);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109                 <span class="keywordflow">switch</span> ($server) {
<a name="l00110"></a>00110                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;DB2&#39;</span>:
<a name="l00111"></a>00111                         $this-&gt;_serverType = <span class="keyword">new</span> <a class="code" href="class_zend___db___adapter___pdo___ibm___db2.html">Zend_Db_Adapter_Pdo_Ibm_Db2</a>($this);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113                         <span class="comment">// Add DB2-specific numeric types</span>
<a name="l00114"></a>00114                         $this-&gt;_numericDataTypes[<span class="stringliteral">&#39;DECFLOAT&#39;</span>] = Zend_Db::FLOAT_TYPE;
<a name="l00115"></a>00115                         $this-&gt;_numericDataTypes[<span class="stringliteral">&#39;DOUBLE&#39;</span>]   = Zend_Db::FLOAT_TYPE;
<a name="l00116"></a>00116                         $this-&gt;_numericDataTypes[<span class="stringliteral">&#39;NUM&#39;</span>]      = Zend_Db::FLOAT_TYPE;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118                         <span class="keywordflow">break</span>;
<a name="l00119"></a>00119                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;IDS&#39;</span>:
<a name="l00120"></a>00120                         $this-&gt;_serverType = <span class="keyword">new</span> <a class="code" href="class_zend___db___adapter___pdo___ibm___ids.html">Zend_Db_Adapter_Pdo_Ibm_Ids</a>($this);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122                         <span class="comment">// Add IDS-specific numeric types</span>
<a name="l00123"></a>00123                         $this-&gt;_numericDataTypes[<span class="stringliteral">&#39;SERIAL&#39;</span>]       = <a class="code" href="class_zend___db.html#affecef211960acad23a2b28b618b207c">Zend_Db::INT_TYPE</a>;
<a name="l00124"></a>00124                         $this-&gt;_numericDataTypes[<span class="stringliteral">&#39;SERIAL8&#39;</span>]      = Zend_Db::BIGINT_TYPE;
<a name="l00125"></a>00125                         $this-&gt;_numericDataTypes[<span class="stringliteral">&#39;INT8&#39;</span>]         = Zend_Db::BIGINT_TYPE;
<a name="l00126"></a>00126                         $this-&gt;_numericDataTypes[<span class="stringliteral">&#39;SMALLFLOAT&#39;</span>]   = Zend_Db::FLOAT_TYPE;
<a name="l00127"></a>00127                         $this-&gt;_numericDataTypes[<span class="stringliteral">&#39;MONEY&#39;</span>]        = Zend_Db::FLOAT_TYPE;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129                         <span class="keywordflow">break</span>;
<a name="l00130"></a>00130                     }
<a name="l00131"></a>00131             }
<a name="l00132"></a>00132         } <span class="keywordflow">catch</span> (PDOException $e) {
<a name="l00134"></a>00134             require_once <span class="stringliteral">&#39;Zend/Db/Adapter/Exception.php&#39;</span>;
<a name="l00135"></a>00135             $error = strpos($e-&gt;getMessage(), <span class="stringliteral">&#39;driver does not support that attribute&#39;</span>);
<a name="l00136"></a>00136             <span class="keywordflow">if</span> ($error) {
<a name="l00137"></a>00137                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___adapter___exception.html">Zend_Db_Adapter_Exception</a>(<span class="stringliteral">&quot;PDO_IBM driver extension is downlevel.  Please use driver release version 1.2.1 or later&quot;</span>);
<a name="l00138"></a>00138             } <span class="keywordflow">else</span> {
<a name="l00139"></a>00139                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___adapter___exception.html">Zend_Db_Adapter_Exception</a>($e-&gt;getMessage());
<a name="l00140"></a>00140             }
<a name="l00141"></a>00141         }
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143 
<a name="l00149"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a1ef31e338225f2ac32532039dd20192f">00149</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a1ef31e338225f2ac32532039dd20192f">_dsn</a>()
<a name="l00150"></a>00150     {
<a name="l00151"></a>00151         $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a1f1487c6bccef6c2bb84ae01e51de972">_checkRequiredOptions</a>($this-&gt;_config);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153         <span class="comment">// check if using full connection string</span>
<a name="l00154"></a>00154         <span class="keywordflow">if</span> (array_key_exists(<span class="stringliteral">&#39;host&#39;</span>, $this-&gt;_config)) {
<a name="l00155"></a>00155             $dsn = <span class="stringliteral">&#39;;DATABASE=&#39;</span> . $this-&gt;_config[<span class="stringliteral">&#39;dbname&#39;</span>]
<a name="l00156"></a>00156             . <span class="stringliteral">&#39;;HOSTNAME=&#39;</span> . $this-&gt;_config[<span class="stringliteral">&#39;host&#39;</span>]
<a name="l00157"></a>00157             . <span class="stringliteral">&#39;;PORT=&#39;</span>     . $this-&gt;_config[<span class="stringliteral">&#39;port&#39;</span>]
<a name="l00158"></a>00158             <span class="comment">// PDO_IBM supports only DB2 TCPIP protocol</span>
<a name="l00159"></a>00159             . <span class="stringliteral">&#39;;PROTOCOL=&#39;</span> . <span class="stringliteral">&#39;TCPIP;&#39;</span>;
<a name="l00160"></a>00160         } <span class="keywordflow">else</span> {
<a name="l00161"></a>00161             <span class="comment">// catalogued connection</span>
<a name="l00162"></a>00162             $dsn = $this-&gt;_config[<span class="stringliteral">&#39;dbname&#39;</span>];
<a name="l00163"></a>00163         }
<a name="l00164"></a>00164         <span class="keywordflow">return</span> $this-&gt;_pdoType . <span class="stringliteral">&#39;: &#39;</span> . $dsn;
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166 
<a name="l00174"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a1f1487c6bccef6c2bb84ae01e51de972">00174</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a1f1487c6bccef6c2bb84ae01e51de972">_checkRequiredOptions</a>(array $config)
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176         <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a1f1487c6bccef6c2bb84ae01e51de972">parent::_checkRequiredOptions</a>($config);
<a name="l00177"></a>00177 
<a name="l00178"></a>00178         <span class="keywordflow">if</span> (array_key_exists(<span class="stringliteral">&#39;host&#39;</span>, $this-&gt;_config) &amp;&amp;
<a name="l00179"></a>00179         !array_key_exists(<span class="stringliteral">&#39;port&#39;</span>, $config)) {
<a name="l00181"></a>00181             require_once <span class="stringliteral">&#39;Zend/Db/Adapter/Exception.php&#39;</span>;
<a name="l00182"></a>00182             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___adapter___exception.html">Zend_Db_Adapter_Exception</a>(<span class="stringliteral">&quot;Configuration must have a key for &#39;port&#39; when &#39;host&#39; is specified&quot;</span>);
<a name="l00183"></a>00183         }
<a name="l00184"></a>00184     }
<a name="l00185"></a>00185 
<a name="l00193"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a33cccb936edee27a1e17189105dd021c">00193</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a33cccb936edee27a1e17189105dd021c">prepare</a>($sql)
<a name="l00194"></a>00194     {
<a name="l00195"></a>00195         $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">_connect</a>();
<a name="l00196"></a>00196         $stmtClass = $this-&gt;_defaultStmtClass;
<a name="l00197"></a>00197         $stmt = <span class="keyword">new</span> $stmtClass($this, $sql);
<a name="l00198"></a>00198         $stmt-&gt;setFetchMode($this-&gt;_fetchMode);
<a name="l00199"></a>00199         <span class="keywordflow">return</span> $stmt;
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201 
<a name="l00207"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a0b89d51988f2b14063a1f8e0c163debf">00207</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a0b89d51988f2b14063a1f8e0c163debf">listTables</a>()
<a name="l00208"></a>00208     {
<a name="l00209"></a>00209         $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">_connect</a>();
<a name="l00210"></a>00210         <span class="keywordflow">return</span> $this-&gt;_serverType-&gt;listTables();
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212 
<a name="l00242"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a288cab0fb3686d239023c937a03b5b6f">00242</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a288cab0fb3686d239023c937a03b5b6f">describeTable</a>($tableName, $schemaName = null)
<a name="l00243"></a>00243     {
<a name="l00244"></a>00244         $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">_connect</a>();
<a name="l00245"></a>00245         <span class="keywordflow">return</span> $this-&gt;_serverType-&gt;describeTable($tableName, $schemaName);
<a name="l00246"></a>00246     }
<a name="l00247"></a>00247 
<a name="l00257"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a497ab0ea850b2fd65590545fd23e7d4a">00257</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a497ab0ea850b2fd65590545fd23e7d4a">insert</a>($table, array $bind)
<a name="l00258"></a>00258     {
<a name="l00259"></a>00259         $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">_connect</a>();
<a name="l00260"></a>00260         $newbind = array();
<a name="l00261"></a>00261         <span class="keywordflow">if</span> (is_array($bind)) {
<a name="l00262"></a>00262             <span class="keywordflow">foreach</span> ($bind as $name =&gt; $value) {
<a name="l00263"></a>00263                 <span class="keywordflow">if</span>($value !== null) {
<a name="l00264"></a>00264                     $newbind[$name] = $value;
<a name="l00265"></a>00265                 }
<a name="l00266"></a>00266             }
<a name="l00267"></a>00267         }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <span class="keywordflow">return</span> <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a497ab0ea850b2fd65590545fd23e7d4a">parent::insert</a>($table, $newbind);
<a name="l00270"></a>00270     }
<a name="l00271"></a>00271 
<a name="l00280"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#aad2efb060c4bfe653662bd962e17ef46">00280</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#aad2efb060c4bfe653662bd962e17ef46">limit</a>($sql, $count, $offset = 0)
<a name="l00281"></a>00281     {
<a name="l00282"></a>00282        $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">_connect</a>();
<a name="l00283"></a>00283        <span class="keywordflow">return</span> $this-&gt;_serverType-&gt;limit($sql, $count, $offset);
<a name="l00284"></a>00284     }
<a name="l00285"></a>00285 
<a name="l00294"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a54dc34c86d9a7deca9c7b88a6107adad">00294</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a54dc34c86d9a7deca9c7b88a6107adad">lastInsertId</a>($tableName = null, $primaryKey = null)
<a name="l00295"></a>00295     {
<a name="l00296"></a>00296         $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">_connect</a>();
<a name="l00297"></a>00297 
<a name="l00298"></a>00298          <span class="keywordflow">if</span> ($tableName !== null) {
<a name="l00299"></a>00299             $sequenceName = $tableName;
<a name="l00300"></a>00300             <span class="keywordflow">if</span> ($primaryKey) {
<a name="l00301"></a>00301                 $sequenceName .= <span class="stringliteral">&quot;_$primaryKey&quot;</span>;
<a name="l00302"></a>00302             }
<a name="l00303"></a>00303             $sequenceName .= <span class="stringliteral">&#39;_seq&#39;</span>;
<a name="l00304"></a>00304             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a677a4a3a74151c7319a926c9953d7ba0">lastSequenceId</a>($sequenceName);
<a name="l00305"></a>00305         }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307         $id = $this-&gt;<a class="code" href="class_zend___db___adapter___abstract.html#ab7a0a080d0e721c656eef11cd641638b">getConnection</a>()-&gt;lastInsertId();
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         <span class="keywordflow">return</span> $id;
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311 
<a name="l00318"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a677a4a3a74151c7319a926c9953d7ba0">00318</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a677a4a3a74151c7319a926c9953d7ba0">lastSequenceId</a>($sequenceName)
<a name="l00319"></a>00319     {
<a name="l00320"></a>00320         $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">_connect</a>();
<a name="l00321"></a>00321         <span class="keywordflow">return</span> $this-&gt;_serverType-&gt;lastSequenceId($sequenceName);
<a name="l00322"></a>00322     }
<a name="l00323"></a>00323 
<a name="l00331"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#aada1f1f761da6bb9b168863f0291f9f9">00331</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#aada1f1f761da6bb9b168863f0291f9f9">nextSequenceId</a>($sequenceName)
<a name="l00332"></a>00332     {
<a name="l00333"></a>00333         $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___ibm.html#a056510893d19074b6d9138db970a8843">_connect</a>();
<a name="l00334"></a>00334         <span class="keywordflow">return</span> $this-&gt;_serverType-&gt;nextSequenceId($sequenceName);
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336 
<a name="l00342"></a><a class="code" href="class_zend___db___adapter___pdo___ibm.html#a2d047b148eb053baba2150cc7d5d9545">00342</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___adapter___pdo___ibm.html#a2d047b148eb053baba2150cc7d5d9545">getServerVersion</a>()
<a name="l00343"></a>00343     {
<a name="l00344"></a>00344         <span class="keywordflow">try</span> {
<a name="l00345"></a>00345             $stmt = $this-&gt;<a class="code" href="class_zend___db___adapter___pdo___abstract.html#a0ab4447e4f026ef4f4c9087eb77a6f00">query</a>(<span class="stringliteral">&#39;SELECT service_level, fixpack_num FROM TABLE (sysproc.env_get_inst_info()) as INSTANCEINFO&#39;</span>);
<a name="l00346"></a>00346             $result = $stmt-&gt;fetchAll(Zend_Db::FETCH_NUM);
<a name="l00347"></a>00347             <span class="keywordflow">if</span> (count($result)) {
<a name="l00348"></a>00348                 $matches = null;
<a name="l00349"></a>00349                 <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/((?:[0-9]{1,2}\.){1,3}[0-9]{1,2})/&#39;</span>, $result[0][0], $matches)) {
<a name="l00350"></a>00350                     <span class="keywordflow">return</span> $matches[1];
<a name="l00351"></a>00351                 } <span class="keywordflow">else</span> {
<a name="l00352"></a>00352                     <span class="keywordflow">return</span> null;
<a name="l00353"></a>00353                 }
<a name="l00354"></a>00354             }
<a name="l00355"></a>00355             <span class="keywordflow">return</span> null;
<a name="l00356"></a>00356         } <span class="keywordflow">catch</span> (PDOException $e) {
<a name="l00357"></a>00357             <span class="keywordflow">return</span> null;
<a name="l00358"></a>00358         }
<a name="l00359"></a>00359     }
<a name="l00360"></a>00360 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Apr 19 2012 17:01:17 for openbiz by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
