<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>openbiz: E:/E/GEAMP/www/openbiz/openbiz/others/Zend/Db/Table/Abstract.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>E:/E/GEAMP/www/openbiz/openbiz/others/Zend/Db/Table/Abstract.php</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00026"></a>00026 require_once <span class="stringliteral">&#39;Zend/Db/Adapter/Abstract.php&#39;</span>;
<a name="l00027"></a>00027 
<a name="l00031"></a>00031 require_once <span class="stringliteral">&#39;Zend/Db/Select.php&#39;</span>;
<a name="l00032"></a>00032 
<a name="l00036"></a>00036 require_once <span class="stringliteral">&#39;Zend/Db.php&#39;</span>;
<a name="l00037"></a>00037 
<a name="l00047"></a><a class="code" href="class_zend___db___table___abstract.html">00047</a> <span class="keyword">abstract</span> <span class="keyword">class </span><a class="code" href="class_zend___db___table___abstract.html">Zend_Db_Table_Abstract</a>
<a name="l00048"></a>00048 {
<a name="l00049"></a>00049 
<a name="l00050"></a>00050     <span class="keyword">const</span> ADAPTER          = <span class="stringliteral">&#39;db&#39;</span>;
<a name="l00051"></a>00051     <span class="keyword">const</span> DEFINITION        = <span class="stringliteral">&#39;definition&#39;</span>;
<a name="l00052"></a>00052     <span class="keyword">const</span> DEFINITION_CONFIG_NAME = <span class="stringliteral">&#39;definitionConfigName&#39;</span>;
<a name="l00053"></a>00053     <span class="keyword">const</span> SCHEMA           = <span class="stringliteral">&#39;schema&#39;</span>;
<a name="l00054"></a>00054     <span class="keyword">const</span> NAME             = <span class="stringliteral">&#39;name&#39;</span>;
<a name="l00055"></a>00055     <span class="keyword">const</span> PRIMARY          = <span class="stringliteral">&#39;primary&#39;</span>;
<a name="l00056"></a>00056     <span class="keyword">const</span> COLS             = <span class="stringliteral">&#39;cols&#39;</span>;
<a name="l00057"></a>00057     <span class="keyword">const</span> METADATA         = <span class="stringliteral">&#39;metadata&#39;</span>;
<a name="l00058"></a>00058     <span class="keyword">const</span> METADATA_CACHE   = <span class="stringliteral">&#39;metadataCache&#39;</span>;
<a name="l00059"></a>00059     <span class="keyword">const</span> METADATA_CACHE_IN_CLASS = <span class="stringliteral">&#39;metadataCacheInClass&#39;</span>;
<a name="l00060"></a>00060     <span class="keyword">const</span> ROW_CLASS        = <span class="stringliteral">&#39;rowClass&#39;</span>;
<a name="l00061"></a>00061     <span class="keyword">const</span> ROWSET_CLASS     = <span class="stringliteral">&#39;rowsetClass&#39;</span>;
<a name="l00062"></a>00062     <span class="keyword">const</span> REFERENCE_MAP    = <span class="stringliteral">&#39;referenceMap&#39;</span>;
<a name="l00063"></a>00063     <span class="keyword">const</span> DEPENDENT_TABLES = <span class="stringliteral">&#39;dependentTables&#39;</span>;
<a name="l00064"></a>00064     <span class="keyword">const</span> SEQUENCE         = <span class="stringliteral">&#39;sequence&#39;</span>;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <span class="keyword">const</span> COLUMNS          = <span class="stringliteral">&#39;columns&#39;</span>;
<a name="l00067"></a>00067     <span class="keyword">const</span> REF_TABLE_CLASS  = <span class="stringliteral">&#39;refTableClass&#39;</span>;
<a name="l00068"></a>00068     <span class="keyword">const</span> REF_COLUMNS      = <span class="stringliteral">&#39;refColumns&#39;</span>;
<a name="l00069"></a>00069     <span class="keyword">const</span> ON_DELETE        = <span class="stringliteral">&#39;onDelete&#39;</span>;
<a name="l00070"></a>00070     <span class="keyword">const</span> ON_UPDATE        = <span class="stringliteral">&#39;onUpdate&#39;</span>;
<a name="l00071"></a>00071 
<a name="l00072"></a>00072     <span class="keyword">const</span> CASCADE          = <span class="stringliteral">&#39;cascade&#39;</span>;
<a name="l00073"></a>00073     <span class="keyword">const</span> RESTRICT         = <span class="stringliteral">&#39;restrict&#39;</span>;
<a name="l00074"></a>00074     <span class="keyword">const</span> SET_NULL         = <span class="stringliteral">&#39;setNull&#39;</span>;
<a name="l00075"></a>00075 
<a name="l00076"></a>00076     <span class="keyword">const</span> DEFAULT_NONE     = <span class="stringliteral">&#39;defaultNone&#39;</span>;
<a name="l00077"></a>00077     <span class="keyword">const</span> DEFAULT_CLASS    = <span class="stringliteral">&#39;defaultClass&#39;</span>;
<a name="l00078"></a>00078     <span class="keyword">const</span> DEFAULT_DB       = <span class="stringliteral">&#39;defaultDb&#39;</span>;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     <span class="keyword">const</span> SELECT_WITH_FROM_PART    = <span class="keyword">true</span>;
<a name="l00081"></a>00081     <span class="keyword">const</span> SELECT_WITHOUT_FROM_PART = <span class="keyword">false</span>;
<a name="l00082"></a>00082 
<a name="l00088"></a>00088     <span class="keyword">protected</span> <span class="keyword">static</span> $_defaultDb;
<a name="l00089"></a>00089 
<a name="l00095"></a>00095     <span class="keyword">protected</span> $_definition = null;
<a name="l00096"></a>00096 
<a name="l00102"></a>00102     <span class="keyword">protected</span> $_definitionConfigName = null;
<a name="l00103"></a>00103 
<a name="l00109"></a>00109     <span class="keyword">protected</span> <span class="keyword">static</span> $_defaultMetadataCache = null;
<a name="l00110"></a>00110 
<a name="l00116"></a>00116     <span class="keyword">protected</span> $_db;
<a name="l00117"></a>00117 
<a name="l00123"></a>00123     <span class="keyword">protected</span> $_schema = null;
<a name="l00124"></a>00124 
<a name="l00130"></a>00130     <span class="keyword">protected</span> $_name = null;
<a name="l00131"></a>00131 
<a name="l00137"></a>00137     <span class="keyword">protected</span> $_cols;
<a name="l00138"></a>00138 
<a name="l00147"></a>00147     <span class="keyword">protected</span> $_primary = null;
<a name="l00148"></a>00148 
<a name="l00159"></a>00159     <span class="keyword">protected</span> $_identity = 1;
<a name="l00160"></a>00160 
<a name="l00167"></a>00167     <span class="keyword">protected</span> $_sequence = <span class="keyword">true</span>;
<a name="l00168"></a>00168 
<a name="l00174"></a>00174     <span class="keyword">protected</span> $_metadata = array();
<a name="l00175"></a>00175 
<a name="l00181"></a>00181     <span class="keyword">protected</span> $_metadataCache = null;
<a name="l00182"></a>00182 
<a name="l00187"></a>00187     <span class="keyword">protected</span> $_metadataCacheInClass = <span class="keyword">true</span>;
<a name="l00188"></a>00188 
<a name="l00194"></a>00194     <span class="keyword">protected</span> $_rowClass = <span class="stringliteral">&#39;Zend_Db_Table_Row&#39;</span>;
<a name="l00195"></a>00195 
<a name="l00201"></a>00201     <span class="keyword">protected</span> $_rowsetClass = <span class="stringliteral">&#39;Zend_Db_Table_Rowset&#39;</span>;
<a name="l00202"></a>00202 
<a name="l00221"></a>00221     <span class="keyword">protected</span> $_referenceMap = array();
<a name="l00222"></a>00222 
<a name="l00231"></a>00231     <span class="keyword">protected</span> $_dependentTables = array();
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 
<a name="l00234"></a>00234     <span class="keyword">protected</span> $_defaultSource = self::DEFAULT_NONE;
<a name="l00235"></a>00235     <span class="keyword">protected</span> $_defaultValues = array();
<a name="l00236"></a>00236 
<a name="l00255"></a><a class="code" href="class_zend___db___table___abstract.html#af7f9493844d2d66e924e3c1df51ce616">00255</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#af7f9493844d2d66e924e3c1df51ce616">__construct</a>($config = array())
<a name="l00256"></a>00256     {
<a name="l00260"></a>00260         <span class="keywordflow">if</span> (!is_array($config)) {
<a name="l00261"></a>00261             $config = array(self::ADAPTER =&gt; $config);
<a name="l00262"></a>00262         }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264         <span class="keywordflow">if</span> ($config) {
<a name="l00265"></a>00265             $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a3ef7c4cf89b3fb4620d5fb67de46b95f">setOptions</a>($config);
<a name="l00266"></a>00266         }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a893edf931eab08c67a70d2e93bbf8c11">_setup</a>();
<a name="l00269"></a>00269         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a4be4055f3361d4800e16bc2e2e38cda6">init</a>();
<a name="l00270"></a>00270     }
<a name="l00271"></a>00271 
<a name="l00278"></a><a class="code" href="class_zend___db___table___abstract.html#a3ef7c4cf89b3fb4620d5fb67de46b95f">00278</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a3ef7c4cf89b3fb4620d5fb67de46b95f">setOptions</a>(Array $options)
<a name="l00279"></a>00279     {
<a name="l00280"></a>00280         <span class="keywordflow">foreach</span> ($options as $key =&gt; $value) {
<a name="l00281"></a>00281             <span class="keywordflow">switch</span> ($key) {
<a name="l00282"></a>00282                 <span class="keywordflow">case</span> self::ADAPTER:
<a name="l00283"></a>00283                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#add4640093cac9475245eb1027476aafa">_setAdapter</a>($value);
<a name="l00284"></a>00284                     <span class="keywordflow">break</span>;
<a name="l00285"></a>00285                 <span class="keywordflow">case</span> self::DEFINITION:
<a name="l00286"></a>00286                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a066c75520f878c265131c58fccad6dda">setDefinition</a>($value);
<a name="l00287"></a>00287                     <span class="keywordflow">break</span>;
<a name="l00288"></a>00288                 <span class="keywordflow">case</span> self::DEFINITION_CONFIG_NAME:
<a name="l00289"></a>00289                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a5a012d3027f4fa12f48d9e894008f283">setDefinitionConfigName</a>($value);
<a name="l00290"></a>00290                     <span class="keywordflow">break</span>;
<a name="l00291"></a>00291                 <span class="keywordflow">case</span> self::SCHEMA:
<a name="l00292"></a>00292                     $this-&gt;_schema = (string) $value;
<a name="l00293"></a>00293                     <span class="keywordflow">break</span>;
<a name="l00294"></a>00294                 <span class="keywordflow">case</span> self::NAME:
<a name="l00295"></a>00295                     $this-&gt;_name = (string) $value;
<a name="l00296"></a>00296                     <span class="keywordflow">break</span>;
<a name="l00297"></a>00297                 <span class="keywordflow">case</span> self::PRIMARY:
<a name="l00298"></a>00298                     $this-&gt;_primary = (array) $value;
<a name="l00299"></a>00299                     <span class="keywordflow">break</span>;
<a name="l00300"></a>00300                 <span class="keywordflow">case</span> self::ROW_CLASS:
<a name="l00301"></a>00301                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ad1bf445370cc6ffca47d0355a8549de0">setRowClass</a>($value);
<a name="l00302"></a>00302                     <span class="keywordflow">break</span>;
<a name="l00303"></a>00303                 <span class="keywordflow">case</span> self::ROWSET_CLASS:
<a name="l00304"></a>00304                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a586d19d1be44b52bf36601dae8fa57ac">setRowsetClass</a>($value);
<a name="l00305"></a>00305                     <span class="keywordflow">break</span>;
<a name="l00306"></a>00306                 <span class="keywordflow">case</span> self::REFERENCE_MAP:
<a name="l00307"></a>00307                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a492165afb9f66417bf505a820d1badba">setReferences</a>($value);
<a name="l00308"></a>00308                     <span class="keywordflow">break</span>;
<a name="l00309"></a>00309                 <span class="keywordflow">case</span> self::DEPENDENT_TABLES:
<a name="l00310"></a>00310                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#aa2a6c66c604211df91afe8dae99eccb4">setDependentTables</a>($value);
<a name="l00311"></a>00311                     <span class="keywordflow">break</span>;
<a name="l00312"></a>00312                 <span class="keywordflow">case</span> self::METADATA_CACHE:
<a name="l00313"></a>00313                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#affb8a7c0a83eab251de2948109877aa1">_setMetadataCache</a>($value);
<a name="l00314"></a>00314                     <span class="keywordflow">break</span>;
<a name="l00315"></a>00315                 <span class="keywordflow">case</span> self::METADATA_CACHE_IN_CLASS:
<a name="l00316"></a>00316                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a00c17947b2febbcc2a12c28258be3c6c">setMetadataCacheInClass</a>($value);
<a name="l00317"></a>00317                     <span class="keywordflow">break</span>;
<a name="l00318"></a>00318                 <span class="keywordflow">case</span> self::SEQUENCE:
<a name="l00319"></a>00319                     $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a8fbe4a882ab354d49a9e6b8a5e5b4096">_setSequence</a>($value);
<a name="l00320"></a>00320                     <span class="keywordflow">break</span>;
<a name="l00321"></a>00321                 <span class="keywordflow">default</span>:
<a name="l00322"></a>00322                     <span class="comment">// ignore unrecognized configuration directive</span>
<a name="l00323"></a>00323                     <span class="keywordflow">break</span>;
<a name="l00324"></a>00324             }
<a name="l00325"></a>00325         }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327         <span class="keywordflow">return</span> $this;
<a name="l00328"></a>00328     }
<a name="l00329"></a>00329 
<a name="l00336"></a><a class="code" href="class_zend___db___table___abstract.html#a066c75520f878c265131c58fccad6dda">00336</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a066c75520f878c265131c58fccad6dda">setDefinition</a>(<a class="code" href="class_zend___db___table___definition.html">Zend_Db_Table_Definition</a> $definition)
<a name="l00337"></a>00337     {
<a name="l00338"></a>00338         $this-&gt;_definition = $definition;
<a name="l00339"></a>00339         <span class="keywordflow">return</span> $this;
<a name="l00340"></a>00340     }
<a name="l00341"></a>00341 
<a name="l00347"></a><a class="code" href="class_zend___db___table___abstract.html#ada012e6c80eda0d807425b598b1dc611">00347</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#ada012e6c80eda0d807425b598b1dc611">getDefinition</a>()
<a name="l00348"></a>00348     {
<a name="l00349"></a>00349         <span class="keywordflow">return</span> $this-&gt;_definition;
<a name="l00350"></a>00350     }
<a name="l00351"></a>00351 
<a name="l00358"></a><a class="code" href="class_zend___db___table___abstract.html#a5a012d3027f4fa12f48d9e894008f283">00358</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a5a012d3027f4fa12f48d9e894008f283">setDefinitionConfigName</a>($definitionConfigName)
<a name="l00359"></a>00359     {
<a name="l00360"></a>00360         $this-&gt;_definitionConfigName = $definitionConfigName;
<a name="l00361"></a>00361         <span class="keywordflow">return</span> $this;
<a name="l00362"></a>00362     }
<a name="l00363"></a>00363 
<a name="l00369"></a><a class="code" href="class_zend___db___table___abstract.html#abe980d257f6489579a3bc6d661ea6922">00369</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#abe980d257f6489579a3bc6d661ea6922">getDefinitionConfigName</a>()
<a name="l00370"></a>00370     {
<a name="l00371"></a>00371         <span class="keywordflow">return</span> $this-&gt;_definitionConfigName;
<a name="l00372"></a>00372     }
<a name="l00373"></a>00373 
<a name="l00378"></a><a class="code" href="class_zend___db___table___abstract.html#ad1bf445370cc6ffca47d0355a8549de0">00378</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#ad1bf445370cc6ffca47d0355a8549de0">setRowClass</a>($classname)
<a name="l00379"></a>00379     {
<a name="l00380"></a>00380         $this-&gt;_rowClass = (string) $classname;
<a name="l00381"></a>00381 
<a name="l00382"></a>00382         <span class="keywordflow">return</span> $this;
<a name="l00383"></a>00383     }
<a name="l00384"></a>00384 
<a name="l00388"></a><a class="code" href="class_zend___db___table___abstract.html#a68212414ce0c242917be7470ce76c07a">00388</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a68212414ce0c242917be7470ce76c07a">getRowClass</a>()
<a name="l00389"></a>00389     {
<a name="l00390"></a>00390         <span class="keywordflow">return</span> $this-&gt;_rowClass;
<a name="l00391"></a>00391     }
<a name="l00392"></a>00392 
<a name="l00397"></a><a class="code" href="class_zend___db___table___abstract.html#a586d19d1be44b52bf36601dae8fa57ac">00397</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a586d19d1be44b52bf36601dae8fa57ac">setRowsetClass</a>($classname)
<a name="l00398"></a>00398     {
<a name="l00399"></a>00399         $this-&gt;_rowsetClass = (string) $classname;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401         <span class="keywordflow">return</span> $this;
<a name="l00402"></a>00402     }
<a name="l00403"></a>00403 
<a name="l00407"></a><a class="code" href="class_zend___db___table___abstract.html#a83520617bab9327cdc63a8d3f007fab2">00407</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a83520617bab9327cdc63a8d3f007fab2">getRowsetClass</a>()
<a name="l00408"></a>00408     {
<a name="l00409"></a>00409         <span class="keywordflow">return</span> $this-&gt;_rowsetClass;
<a name="l00410"></a>00410     }
<a name="l00411"></a>00411 
<a name="l00423"></a><a class="code" href="class_zend___db___table___abstract.html#a35115ec10fe23507230d3a863cbd4e90">00423</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a35115ec10fe23507230d3a863cbd4e90">addReference</a>($ruleKey, $columns, $refTableClass, $refColumns,
<a name="l00424"></a>00424                                  $onDelete = null, $onUpdate = null)
<a name="l00425"></a>00425     {
<a name="l00426"></a>00426         $reference = array(self::COLUMNS         =&gt; (array) $columns,
<a name="l00427"></a>00427                            self::REF_TABLE_CLASS =&gt; $refTableClass,
<a name="l00428"></a>00428                            self::REF_COLUMNS     =&gt; (array) $refColumns);
<a name="l00429"></a>00429 
<a name="l00430"></a>00430         <span class="keywordflow">if</span> (!empty($onDelete)) {
<a name="l00431"></a>00431             $reference[self::ON_DELETE] = $onDelete;
<a name="l00432"></a>00432         }
<a name="l00433"></a>00433 
<a name="l00434"></a>00434         <span class="keywordflow">if</span> (!empty($onUpdate)) {
<a name="l00435"></a>00435             $reference[self::ON_UPDATE] = $onUpdate;
<a name="l00436"></a>00436         }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438         $this-&gt;_referenceMap[$ruleKey] = $reference;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440         <span class="keywordflow">return</span> $this;
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442 
<a name="l00447"></a><a class="code" href="class_zend___db___table___abstract.html#a492165afb9f66417bf505a820d1badba">00447</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a492165afb9f66417bf505a820d1badba">setReferences</a>(array $referenceMap)
<a name="l00448"></a>00448     {
<a name="l00449"></a>00449         $this-&gt;_referenceMap = $referenceMap;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451         <span class="keywordflow">return</span> $this;
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453 
<a name="l00460"></a><a class="code" href="class_zend___db___table___abstract.html#a7c6ea59b9ef71d252a9c1491e06c5ebd">00460</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a7c6ea59b9ef71d252a9c1491e06c5ebd">getReference</a>($tableClassname, $ruleKey = null)
<a name="l00461"></a>00461     {
<a name="l00462"></a>00462         $thisClass = get_class($this);
<a name="l00463"></a>00463         <span class="keywordflow">if</span> ($thisClass === <span class="stringliteral">&#39;Zend_Db_Table&#39;</span>) {
<a name="l00464"></a>00464             $thisClass = $this-&gt;_definitionConfigName;
<a name="l00465"></a>00465         }
<a name="l00466"></a>00466         $refMap = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ac457237f9a210cfee68ddc2cb313a612">_getReferenceMapNormalized</a>();
<a name="l00467"></a>00467         <span class="keywordflow">if</span> ($ruleKey !== null) {
<a name="l00468"></a>00468             <span class="keywordflow">if</span> (!isset($refMap[$ruleKey])) {
<a name="l00469"></a>00469                 require_once <span class="stringliteral">&quot;Zend/Db/Table/Exception.php&quot;</span>;
<a name="l00470"></a>00470                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&quot;No reference rule \&quot;$ruleKey\&quot; from table $thisClass to table $tableClassname&quot;</span>);
<a name="l00471"></a>00471             }
<a name="l00472"></a>00472             <span class="keywordflow">if</span> ($refMap[$ruleKey][self::REF_TABLE_CLASS] != $tableClassname) {
<a name="l00473"></a>00473                 require_once <span class="stringliteral">&quot;Zend/Db/Table/Exception.php&quot;</span>;
<a name="l00474"></a>00474                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&quot;Reference rule \&quot;$ruleKey\&quot; does not reference table $tableClassname&quot;</span>);
<a name="l00475"></a>00475             }
<a name="l00476"></a>00476             <span class="keywordflow">return</span> $refMap[$ruleKey];
<a name="l00477"></a>00477         }
<a name="l00478"></a>00478         <span class="keywordflow">foreach</span> ($refMap as $reference) {
<a name="l00479"></a>00479             <span class="keywordflow">if</span> ($reference[self::REF_TABLE_CLASS] == $tableClassname) {
<a name="l00480"></a>00480                 <span class="keywordflow">return</span> $reference;
<a name="l00481"></a>00481             }
<a name="l00482"></a>00482         }
<a name="l00483"></a>00483         require_once <span class="stringliteral">&quot;Zend/Db/Table/Exception.php&quot;</span>;
<a name="l00484"></a>00484         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&quot;No reference from table $thisClass to table $tableClassname&quot;</span>);
<a name="l00485"></a>00485     }
<a name="l00486"></a>00486 
<a name="l00491"></a><a class="code" href="class_zend___db___table___abstract.html#aa2a6c66c604211df91afe8dae99eccb4">00491</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#aa2a6c66c604211df91afe8dae99eccb4">setDependentTables</a>(array $dependentTables)
<a name="l00492"></a>00492     {
<a name="l00493"></a>00493         $this-&gt;_dependentTables = $dependentTables;
<a name="l00494"></a>00494 
<a name="l00495"></a>00495         <span class="keywordflow">return</span> $this;
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497 
<a name="l00501"></a><a class="code" href="class_zend___db___table___abstract.html#aaef4aeb849df2ff5c74ad0ea35927a75">00501</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#aaef4aeb849df2ff5c74ad0ea35927a75">getDependentTables</a>()
<a name="l00502"></a>00502     {
<a name="l00503"></a>00503         <span class="keywordflow">return</span> $this-&gt;_dependentTables;
<a name="l00504"></a>00504     }
<a name="l00505"></a>00505 
<a name="l00512"></a><a class="code" href="class_zend___db___table___abstract.html#a4dfdfb70eae568577d0a7eb59c0df2e1">00512</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a4dfdfb70eae568577d0a7eb59c0df2e1">setDefaultSource</a>($defaultSource = self::DEFAULT_NONE)
<a name="l00513"></a>00513     {
<a name="l00514"></a>00514         <span class="keywordflow">if</span> (!in_array($defaultSource, array(self::DEFAULT_CLASS, self::DEFAULT_DB, self::DEFAULT_NONE))) {
<a name="l00515"></a>00515             $defaultSource = self::DEFAULT_NONE;
<a name="l00516"></a>00516         }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518         $this-&gt;_defaultSource = $defaultSource;
<a name="l00519"></a>00519         <span class="keywordflow">return</span> $this;
<a name="l00520"></a>00520     }
<a name="l00521"></a>00521 
<a name="l00527"></a><a class="code" href="class_zend___db___table___abstract.html#a858554412b93219d378e82161202372d">00527</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a858554412b93219d378e82161202372d">getDefaultSource</a>()
<a name="l00528"></a>00528     {
<a name="l00529"></a>00529         <span class="keywordflow">return</span> $this-&gt;_defaultSource;
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531 
<a name="l00538"></a><a class="code" href="class_zend___db___table___abstract.html#a176bb991a7b8697cd1fc87e0b57f4af7">00538</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a176bb991a7b8697cd1fc87e0b57f4af7">setDefaultValues</a>(Array $defaultValues)
<a name="l00539"></a>00539     {
<a name="l00540"></a>00540         <span class="keywordflow">foreach</span> ($defaultValues as $defaultName =&gt; $defaultValue) {
<a name="l00541"></a>00541             <span class="keywordflow">if</span> (array_key_exists($defaultName, $this-&gt;_metadata)) {
<a name="l00542"></a>00542                 $this-&gt;_defaultValues[$defaultName] = $defaultValue;
<a name="l00543"></a>00543             }
<a name="l00544"></a>00544         }
<a name="l00545"></a>00545         <span class="keywordflow">return</span> $this;
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="keyword">public</span> function getDefaultValues()
<a name="l00549"></a>00549     {
<a name="l00550"></a>00550         <span class="keywordflow">return</span> $this-&gt;_defaultValues;
<a name="l00551"></a>00551     }
<a name="l00552"></a>00552 
<a name="l00553"></a>00553 
<a name="l00560"></a><a class="code" href="class_zend___db___table___abstract.html#a51f4541935a995136e071073b6803d1f">00560</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_zend___db___table___abstract.html#a51f4541935a995136e071073b6803d1f">setDefaultAdapter</a>($db = null)
<a name="l00561"></a>00561     {
<a name="l00562"></a>00562         self::$_defaultDb = <a class="code" href="class_zend___db___table___abstract.html#a295b6ae21363104b9528f112e0fae503">self::_setupAdapter</a>($db);
<a name="l00563"></a>00563     }
<a name="l00564"></a>00564 
<a name="l00570"></a><a class="code" href="class_zend___db___table___abstract.html#ac3da964b15386bb592639a77e89f2dd6">00570</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_zend___db___table___abstract.html#ac3da964b15386bb592639a77e89f2dd6">getDefaultAdapter</a>()
<a name="l00571"></a>00571     {
<a name="l00572"></a>00572         <span class="keywordflow">return</span> self::$_defaultDb;
<a name="l00573"></a>00573     }
<a name="l00574"></a>00574 
<a name="l00579"></a><a class="code" href="class_zend___db___table___abstract.html#add4640093cac9475245eb1027476aafa">00579</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#add4640093cac9475245eb1027476aafa">_setAdapter</a>($db)
<a name="l00580"></a>00580     {
<a name="l00581"></a>00581         $this-&gt;_db = <a class="code" href="class_zend___db___table___abstract.html#a295b6ae21363104b9528f112e0fae503">self::_setupAdapter</a>($db);
<a name="l00582"></a>00582         <span class="keywordflow">return</span> $this;
<a name="l00583"></a>00583     }
<a name="l00584"></a>00584 
<a name="l00590"></a><a class="code" href="class_zend___db___table___abstract.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">00590</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()
<a name="l00591"></a>00591     {
<a name="l00592"></a>00592         <span class="keywordflow">return</span> $this-&gt;_db;
<a name="l00593"></a>00593     }
<a name="l00594"></a>00594 
<a name="l00600"></a><a class="code" href="class_zend___db___table___abstract.html#a295b6ae21363104b9528f112e0fae503">00600</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function <a class="code" href="class_zend___db___table___abstract.html#a295b6ae21363104b9528f112e0fae503">_setupAdapter</a>($db)
<a name="l00601"></a>00601     {
<a name="l00602"></a>00602         <span class="keywordflow">if</span> ($db === null) {
<a name="l00603"></a>00603             <span class="keywordflow">return</span> null;
<a name="l00604"></a>00604         }
<a name="l00605"></a>00605         <span class="keywordflow">if</span> (is_string($db)) {
<a name="l00606"></a>00606             require_once <span class="stringliteral">&#39;Zend/Registry.php&#39;</span>;
<a name="l00607"></a>00607             $db = <a class="code" href="class_zend___registry.html#a68c12da739beec9f01e66b9a8f0dd24d">Zend_Registry::get</a>($db);
<a name="l00608"></a>00608         }
<a name="l00609"></a>00609         <span class="keywordflow">if</span> (!$db instanceof <a class="code" href="class_zend___db___adapter___abstract.html">Zend_Db_Adapter_Abstract</a>) {
<a name="l00610"></a>00610             require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l00611"></a>00611             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&#39;Argument must be of type Zend_Db_Adapter_Abstract, or a Registry key where a Zend_Db_Adapter_Abstract object is stored&#39;</span>);
<a name="l00612"></a>00612         }
<a name="l00613"></a>00613         <span class="keywordflow">return</span> $db;
<a name="l00614"></a>00614     }
<a name="l00615"></a>00615 
<a name="l00624"></a><a class="code" href="class_zend___db___table___abstract.html#a4a442663f897fcc9cabd378c435d312f">00624</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_zend___db___table___abstract.html#a4a442663f897fcc9cabd378c435d312f">setDefaultMetadataCache</a>($metadataCache = null)
<a name="l00625"></a>00625     {
<a name="l00626"></a>00626         self::$_defaultMetadataCache = <a class="code" href="class_zend___db___table___abstract.html#a116ef6d9864f9a722650487eb0c16b02">self::_setupMetadataCache</a>($metadataCache);
<a name="l00627"></a>00627     }
<a name="l00628"></a>00628 
<a name="l00634"></a><a class="code" href="class_zend___db___table___abstract.html#a33dd539eead8af773ba22759837984e9">00634</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_zend___db___table___abstract.html#a33dd539eead8af773ba22759837984e9">getDefaultMetadataCache</a>()
<a name="l00635"></a>00635     {
<a name="l00636"></a>00636         <span class="keywordflow">return</span> self::$_defaultMetadataCache;
<a name="l00637"></a>00637     }
<a name="l00638"></a>00638 
<a name="l00650"></a><a class="code" href="class_zend___db___table___abstract.html#affb8a7c0a83eab251de2948109877aa1">00650</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#affb8a7c0a83eab251de2948109877aa1">_setMetadataCache</a>($metadataCache)
<a name="l00651"></a>00651     {
<a name="l00652"></a>00652         $this-&gt;_metadataCache = <a class="code" href="class_zend___db___table___abstract.html#a116ef6d9864f9a722650487eb0c16b02">self::_setupMetadataCache</a>($metadataCache);
<a name="l00653"></a>00653         <span class="keywordflow">return</span> $this;
<a name="l00654"></a>00654     }
<a name="l00655"></a>00655 
<a name="l00661"></a><a class="code" href="class_zend___db___table___abstract.html#af8e4ce927f97708b9baaa941de72e128">00661</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#af8e4ce927f97708b9baaa941de72e128">getMetadataCache</a>()
<a name="l00662"></a>00662     {
<a name="l00663"></a>00663         <span class="keywordflow">return</span> $this-&gt;_metadataCache;
<a name="l00664"></a>00664     }
<a name="l00665"></a>00665 
<a name="l00673"></a><a class="code" href="class_zend___db___table___abstract.html#a00c17947b2febbcc2a12c28258be3c6c">00673</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a00c17947b2febbcc2a12c28258be3c6c">setMetadataCacheInClass</a>($flag)
<a name="l00674"></a>00674     {
<a name="l00675"></a>00675         $this-&gt;_metadataCacheInClass = (bool) $flag;
<a name="l00676"></a>00676         <span class="keywordflow">return</span> $this;
<a name="l00677"></a>00677     }
<a name="l00678"></a>00678 
<a name="l00685"></a><a class="code" href="class_zend___db___table___abstract.html#ae920b1138a67d22c8ab7256112a03461">00685</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#ae920b1138a67d22c8ab7256112a03461">metadataCacheInClass</a>()
<a name="l00686"></a>00686     {
<a name="l00687"></a>00687         <span class="keywordflow">return</span> $this-&gt;_metadataCacheInClass;
<a name="l00688"></a>00688     }
<a name="l00689"></a>00689 
<a name="l00695"></a><a class="code" href="class_zend___db___table___abstract.html#a116ef6d9864f9a722650487eb0c16b02">00695</a>     <span class="keyword">protected</span> <span class="keyword">static</span> function <a class="code" href="class_zend___db___table___abstract.html#a116ef6d9864f9a722650487eb0c16b02">_setupMetadataCache</a>($metadataCache)
<a name="l00696"></a>00696     {
<a name="l00697"></a>00697         <span class="keywordflow">if</span> ($metadataCache === null) {
<a name="l00698"></a>00698             <span class="keywordflow">return</span> null;
<a name="l00699"></a>00699         }
<a name="l00700"></a>00700         <span class="keywordflow">if</span> (is_string($metadataCache)) {
<a name="l00701"></a>00701             require_once <span class="stringliteral">&#39;Zend/Registry.php&#39;</span>;
<a name="l00702"></a>00702             $metadataCache = <a class="code" href="class_zend___registry.html#a68c12da739beec9f01e66b9a8f0dd24d">Zend_Registry::get</a>($metadataCache);
<a name="l00703"></a>00703         }
<a name="l00704"></a>00704         <span class="keywordflow">if</span> (!$metadataCache instanceof <a class="code" href="class_zend___cache___core.html">Zend_Cache_Core</a>) {
<a name="l00705"></a>00705             require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l00706"></a>00706             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&#39;Argument must be of type Zend_Cache_Core, or a Registry key where a Zend_Cache_Core object is stored&#39;</span>);
<a name="l00707"></a>00707         }
<a name="l00708"></a>00708         <span class="keywordflow">return</span> $metadataCache;
<a name="l00709"></a>00709     }
<a name="l00710"></a>00710 
<a name="l00723"></a><a class="code" href="class_zend___db___table___abstract.html#a8fbe4a882ab354d49a9e6b8a5e5b4096">00723</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#a8fbe4a882ab354d49a9e6b8a5e5b4096">_setSequence</a>($sequence)
<a name="l00724"></a>00724     {
<a name="l00725"></a>00725         $this-&gt;_sequence = $sequence;
<a name="l00726"></a>00726 
<a name="l00727"></a>00727         <span class="keywordflow">return</span> $this;
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729 
<a name="l00737"></a><a class="code" href="class_zend___db___table___abstract.html#a893edf931eab08c67a70d2e93bbf8c11">00737</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#a893edf931eab08c67a70d2e93bbf8c11">_setup</a>()
<a name="l00738"></a>00738     {
<a name="l00739"></a>00739         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a4d441f70aa8e9aa51503d4844bbaa160">_setupDatabaseAdapter</a>();
<a name="l00740"></a>00740         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a49d5cdead6442cc5b230abdc5bc6acc5">_setupTableName</a>();
<a name="l00741"></a>00741     }
<a name="l00742"></a>00742 
<a name="l00748"></a><a class="code" href="class_zend___db___table___abstract.html#a4d441f70aa8e9aa51503d4844bbaa160">00748</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#a4d441f70aa8e9aa51503d4844bbaa160">_setupDatabaseAdapter</a>()
<a name="l00749"></a>00749     {
<a name="l00750"></a>00750         <span class="keywordflow">if</span> (! $this-&gt;_db) {
<a name="l00751"></a>00751             $this-&gt;_db = <a class="code" href="class_zend___db___table___abstract.html#ac3da964b15386bb592639a77e89f2dd6">self::getDefaultAdapter</a>();
<a name="l00752"></a>00752             <span class="keywordflow">if</span> (!$this-&gt;_db instanceof <a class="code" href="class_zend___db___adapter___abstract.html">Zend_Db_Adapter_Abstract</a>) {
<a name="l00753"></a>00753                 require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l00754"></a>00754                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&#39;No adapter found for &#39;</span> . get_class($this));
<a name="l00755"></a>00755             }
<a name="l00756"></a>00756         }
<a name="l00757"></a>00757     }
<a name="l00758"></a>00758 
<a name="l00770"></a><a class="code" href="class_zend___db___table___abstract.html#a49d5cdead6442cc5b230abdc5bc6acc5">00770</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#a49d5cdead6442cc5b230abdc5bc6acc5">_setupTableName</a>()
<a name="l00771"></a>00771     {
<a name="l00772"></a>00772         <span class="keywordflow">if</span> (! $this-&gt;_name) {
<a name="l00773"></a>00773             $this-&gt;_name = get_class($this);
<a name="l00774"></a>00774         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strpos($this-&gt;_name, <span class="charliteral">&#39;.&#39;</span>)) {
<a name="l00775"></a>00775             list($this-&gt;_schema, $this-&gt;_name) = explode(<span class="charliteral">&#39;.&#39;</span>, $this-&gt;_name);
<a name="l00776"></a>00776         }
<a name="l00777"></a>00777     }
<a name="l00778"></a>00778 
<a name="l00788"></a><a class="code" href="class_zend___db___table___abstract.html#ab755f319f7dcb8b7c8ab0932bd3e324e">00788</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#ab755f319f7dcb8b7c8ab0932bd3e324e">_setupMetadata</a>()
<a name="l00789"></a>00789     {
<a name="l00790"></a>00790         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ae920b1138a67d22c8ab7256112a03461">metadataCacheInClass</a>() &amp;&amp; (count($this-&gt;_metadata) &gt; 0)) {
<a name="l00791"></a>00791             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00792"></a>00792         }
<a name="l00793"></a>00793 
<a name="l00794"></a>00794         <span class="comment">// Assume that metadata will be loaded from cache</span>
<a name="l00795"></a>00795         $isMetadataFromCache = <span class="keyword">true</span>;
<a name="l00796"></a>00796 
<a name="l00797"></a>00797         <span class="comment">// If $this has no metadata cache but the class has a default metadata cache</span>
<a name="l00798"></a>00798         <span class="keywordflow">if</span> (null === $this-&gt;_metadataCache &amp;&amp; null !== self::$_defaultMetadataCache) {
<a name="l00799"></a>00799             <span class="comment">// Make $this use the default metadata cache of the class</span>
<a name="l00800"></a>00800             $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#affb8a7c0a83eab251de2948109877aa1">_setMetadataCache</a>(self::$_defaultMetadataCache);
<a name="l00801"></a>00801         }
<a name="l00802"></a>00802 
<a name="l00803"></a>00803         <span class="comment">// If $this has a metadata cache</span>
<a name="l00804"></a>00804         <span class="keywordflow">if</span> (null !== $this-&gt;_metadataCache) {
<a name="l00805"></a>00805             <span class="comment">// Define the cache identifier where the metadata are saved</span>
<a name="l00806"></a>00806 
<a name="l00807"></a>00807             <span class="comment">//get db configuration</span>
<a name="l00808"></a>00808             $dbConfig = $this-&gt;_db-&gt;getConfig();
<a name="l00809"></a>00809 
<a name="l00810"></a>00810             <span class="comment">// Define the cache identifier where the metadata are saved</span>
<a name="l00811"></a>00811             $cacheId = md5( <span class="comment">// port:host/dbname:schema.table (based on availabilty)</span>
<a name="l00812"></a>00812                 (isset($dbConfig[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;port&#39;</span>]) ? <span class="charliteral">&#39;:&#39;</span>.$dbConfig[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;port&#39;</span>] : null)
<a name="l00813"></a>00813                 . (isset($dbConfig[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;host&#39;</span>]) ? <span class="charliteral">&#39;:&#39;</span>.$dbConfig[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;host&#39;</span>] : null)
<a name="l00814"></a>00814                 . <span class="charliteral">&#39;/&#39;</span>.$dbConfig[<span class="stringliteral">&#39;dbname&#39;</span>].<span class="charliteral">&#39;:&#39;</span>.$this-&gt;_schema.<span class="charliteral">&#39;.&#39;</span>.$this-&gt;_name
<a name="l00815"></a>00815                 );
<a name="l00816"></a>00816         }
<a name="l00817"></a>00817 
<a name="l00818"></a>00818         <span class="comment">// If $this has no metadata cache or metadata cache misses</span>
<a name="l00819"></a>00819         <span class="keywordflow">if</span> (null === $this-&gt;_metadataCache || !($metadata = $this-&gt;_metadataCache-&gt;load($cacheId))) {
<a name="l00820"></a>00820             <span class="comment">// Metadata are not loaded from cache</span>
<a name="l00821"></a>00821             $isMetadataFromCache = <span class="keyword">false</span>;
<a name="l00822"></a>00822             <span class="comment">// Fetch metadata from the adapter&#39;s describeTable() method</span>
<a name="l00823"></a>00823             $metadata = $this-&gt;_db-&gt;describeTable($this-&gt;_name, $this-&gt;_schema);
<a name="l00824"></a>00824             <span class="comment">// If $this has a metadata cache, then cache the metadata</span>
<a name="l00825"></a>00825             <span class="keywordflow">if</span> (null !== $this-&gt;_metadataCache &amp;&amp; !$this-&gt;_metadataCache-&gt;save($metadata, $cacheId)) {
<a name="l00829"></a>00829                 require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l00830"></a>00830                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&#39;Failed saving metadata to metadataCache&#39;</span>);
<a name="l00831"></a>00831             }
<a name="l00832"></a>00832         }
<a name="l00833"></a>00833 
<a name="l00834"></a>00834         <span class="comment">// Assign the metadata to $this</span>
<a name="l00835"></a>00835         $this-&gt;_metadata = $metadata;
<a name="l00836"></a>00836 
<a name="l00837"></a>00837         <span class="comment">// Return whether the metadata were loaded from cache</span>
<a name="l00838"></a>00838         <span class="keywordflow">return</span> $isMetadataFromCache;
<a name="l00839"></a>00839     }
<a name="l00840"></a>00840 
<a name="l00846"></a><a class="code" href="class_zend___db___table___abstract.html#ab8d468234319703c8f94cfebfba0cac7">00846</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#ab8d468234319703c8f94cfebfba0cac7">_getCols</a>()
<a name="l00847"></a>00847     {
<a name="l00848"></a>00848         <span class="keywordflow">if</span> (null === $this-&gt;_cols) {
<a name="l00849"></a>00849             $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ab755f319f7dcb8b7c8ab0932bd3e324e">_setupMetadata</a>();
<a name="l00850"></a>00850             $this-&gt;_cols = array_keys($this-&gt;_metadata);
<a name="l00851"></a>00851         }
<a name="l00852"></a>00852         <span class="keywordflow">return</span> $this-&gt;_cols;
<a name="l00853"></a>00853     }
<a name="l00854"></a>00854 
<a name="l00863"></a><a class="code" href="class_zend___db___table___abstract.html#a6b59b52f863f140ab29e21d73e0cfbe6">00863</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#a6b59b52f863f140ab29e21d73e0cfbe6">_setupPrimaryKey</a>()
<a name="l00864"></a>00864     {
<a name="l00865"></a>00865         <span class="keywordflow">if</span> (!$this-&gt;_primary) {
<a name="l00866"></a>00866             $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ab755f319f7dcb8b7c8ab0932bd3e324e">_setupMetadata</a>();
<a name="l00867"></a>00867             $this-&gt;_primary = array();
<a name="l00868"></a>00868             <span class="keywordflow">foreach</span> ($this-&gt;_metadata as $col) {
<a name="l00869"></a>00869                 <span class="keywordflow">if</span> ($col[<span class="stringliteral">&#39;PRIMARY&#39;</span>]) {
<a name="l00870"></a>00870                     $this-&gt;_primary[ $col[<span class="stringliteral">&#39;PRIMARY_POSITION&#39;</span>] ] = $col[<span class="stringliteral">&#39;COLUMN_NAME&#39;</span>];
<a name="l00871"></a>00871                     <span class="keywordflow">if</span> ($col[<span class="stringliteral">&#39;IDENTITY&#39;</span>]) {
<a name="l00872"></a>00872                         $this-&gt;_identity = $col[<span class="stringliteral">&#39;PRIMARY_POSITION&#39;</span>];
<a name="l00873"></a>00873                     }
<a name="l00874"></a>00874                 }
<a name="l00875"></a>00875             }
<a name="l00876"></a>00876             <span class="comment">// if no primary key was specified and none was found in the metadata</span>
<a name="l00877"></a>00877             <span class="comment">// then throw an exception.</span>
<a name="l00878"></a>00878             <span class="keywordflow">if</span> (empty($this-&gt;_primary)) {
<a name="l00879"></a>00879                 require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l00880"></a>00880                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&#39;A table must have a primary key, but none was found&#39;</span>);
<a name="l00881"></a>00881             }
<a name="l00882"></a>00882         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!is_array($this-&gt;_primary)) {
<a name="l00883"></a>00883             $this-&gt;_primary = array(1 =&gt; $this-&gt;_primary);
<a name="l00884"></a>00884         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($this-&gt;_primary[0])) {
<a name="l00885"></a>00885             array_unshift($this-&gt;_primary, null);
<a name="l00886"></a>00886             unset($this-&gt;_primary[0]);
<a name="l00887"></a>00887         }
<a name="l00888"></a>00888 
<a name="l00889"></a>00889         $cols = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ab8d468234319703c8f94cfebfba0cac7">_getCols</a>();
<a name="l00890"></a>00890         <span class="keywordflow">if</span> (! array_intersect((array) $this-&gt;_primary, $cols) == (array) $this-&gt;_primary) {
<a name="l00891"></a>00891             require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l00892"></a>00892             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&quot;Primary key column(s) (&quot;</span>
<a name="l00893"></a>00893                 . implode(<span class="charliteral">&#39;,&#39;</span>, (array) $this-&gt;_primary)
<a name="l00894"></a>00894                 . <span class="stringliteral">&quot;) are not columns in this table (&quot;</span>
<a name="l00895"></a>00895                 . implode(<span class="charliteral">&#39;,&#39;</span>, $cols)
<a name="l00896"></a>00896                 . <span class="stringliteral">&quot;)&quot;</span>);
<a name="l00897"></a>00897         }
<a name="l00898"></a>00898 
<a name="l00899"></a>00899         $primary    = (array) $this-&gt;_primary;
<a name="l00900"></a>00900         $pkIdentity = $primary[(int) $this-&gt;_identity];
<a name="l00901"></a>00901 
<a name="l00906"></a>00906         <span class="keywordflow">if</span> ($this-&gt;_sequence === <span class="keyword">true</span> &amp;&amp; $this-&gt;_db instanceof <a class="code" href="class_zend___db___adapter___pdo___pgsql.html">Zend_Db_Adapter_Pdo_Pgsql</a>) {
<a name="l00907"></a>00907             $this-&gt;_sequence = $this-&gt;_db-&gt;quoteIdentifier(<span class="stringliteral">&quot;{$this-&gt;_name}_{$pkIdentity}_seq&quot;</span>);
<a name="l00908"></a>00908             <span class="keywordflow">if</span> ($this-&gt;_schema) {
<a name="l00909"></a>00909                 $this-&gt;_sequence = $this-&gt;_db-&gt;quoteIdentifier($this-&gt;_schema) . <span class="charliteral">&#39;.&#39;</span> . $this-&gt;_sequence;
<a name="l00910"></a>00910             }
<a name="l00911"></a>00911         }
<a name="l00912"></a>00912     }
<a name="l00913"></a>00913 
<a name="l00919"></a><a class="code" href="class_zend___db___table___abstract.html#ac457237f9a210cfee68ddc2cb313a612">00919</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#ac457237f9a210cfee68ddc2cb313a612">_getReferenceMapNormalized</a>()
<a name="l00920"></a>00920     {
<a name="l00921"></a>00921         $referenceMapNormalized = array();
<a name="l00922"></a>00922 
<a name="l00923"></a>00923         <span class="keywordflow">foreach</span> ($this-&gt;_referenceMap as $rule =&gt; $map) {
<a name="l00924"></a>00924 
<a name="l00925"></a>00925             $referenceMapNormalized[$rule] = array();
<a name="l00926"></a>00926 
<a name="l00927"></a>00927             <span class="keywordflow">foreach</span> ($map as $key =&gt; $value) {
<a name="l00928"></a>00928                 <span class="keywordflow">switch</span> ($key) {
<a name="l00929"></a>00929 
<a name="l00930"></a>00930                     <span class="comment">// normalize COLUMNS and REF_COLUMNS to arrays</span>
<a name="l00931"></a>00931                     <span class="keywordflow">case</span> self::COLUMNS:
<a name="l00932"></a>00932                     <span class="keywordflow">case</span> self::REF_COLUMNS:
<a name="l00933"></a>00933                         <span class="keywordflow">if</span> (!is_array($value)) {
<a name="l00934"></a>00934                             $referenceMapNormalized[$rule][$key] = array($value);
<a name="l00935"></a>00935                         } <span class="keywordflow">else</span> {
<a name="l00936"></a>00936                             $referenceMapNormalized[$rule][$key] = $value;
<a name="l00937"></a>00937                         }
<a name="l00938"></a>00938                         <span class="keywordflow">break</span>;
<a name="l00939"></a>00939 
<a name="l00940"></a>00940                     <span class="comment">// other values are copied as-is</span>
<a name="l00941"></a>00941                     <span class="keywordflow">default</span>:
<a name="l00942"></a>00942                         $referenceMapNormalized[$rule][$key] = $value;
<a name="l00943"></a>00943                         <span class="keywordflow">break</span>;
<a name="l00944"></a>00944                 }
<a name="l00945"></a>00945             }
<a name="l00946"></a>00946         }
<a name="l00947"></a>00947 
<a name="l00948"></a>00948         <span class="keywordflow">return</span> $referenceMapNormalized;
<a name="l00949"></a>00949     }
<a name="l00950"></a>00950 
<a name="l00958"></a><a class="code" href="class_zend___db___table___abstract.html#a4be4055f3361d4800e16bc2e2e38cda6">00958</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a4be4055f3361d4800e16bc2e2e38cda6">init</a>()
<a name="l00959"></a>00959     {
<a name="l00960"></a>00960     }
<a name="l00961"></a>00961 
<a name="l00971"></a><a class="code" href="class_zend___db___table___abstract.html#a89f973e5889e6547d42043c37af3df35">00971</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a89f973e5889e6547d42043c37af3df35">info</a>($key = null)
<a name="l00972"></a>00972     {
<a name="l00973"></a>00973         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a6b59b52f863f140ab29e21d73e0cfbe6">_setupPrimaryKey</a>();
<a name="l00974"></a>00974 
<a name="l00975"></a>00975         $info = array(
<a name="l00976"></a>00976             self::SCHEMA           =&gt; $this-&gt;_schema,
<a name="l00977"></a>00977             self::NAME             =&gt; $this-&gt;_name,
<a name="l00978"></a>00978             self::COLS             =&gt; $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ab8d468234319703c8f94cfebfba0cac7">_getCols</a>(),
<a name="l00979"></a>00979             self::PRIMARY          =&gt; (array) $this-&gt;_primary,
<a name="l00980"></a>00980             self::METADATA         =&gt; $this-&gt;_metadata,
<a name="l00981"></a>00981             self::ROW_CLASS        =&gt; $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a68212414ce0c242917be7470ce76c07a">getRowClass</a>(),
<a name="l00982"></a>00982             self::ROWSET_CLASS     =&gt; $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a83520617bab9327cdc63a8d3f007fab2">getRowsetClass</a>(),
<a name="l00983"></a>00983             self::REFERENCE_MAP    =&gt; $this-&gt;_referenceMap,
<a name="l00984"></a>00984             self::DEPENDENT_TABLES =&gt; $this-&gt;_dependentTables,
<a name="l00985"></a>00985             self::SEQUENCE         =&gt; $this-&gt;_sequence
<a name="l00986"></a>00986         );
<a name="l00987"></a>00987 
<a name="l00988"></a>00988         <span class="keywordflow">if</span> ($key === null) {
<a name="l00989"></a>00989             <span class="keywordflow">return</span> $info;
<a name="l00990"></a>00990         }
<a name="l00991"></a>00991 
<a name="l00992"></a>00992         <span class="keywordflow">if</span> (!array_key_exists($key, $info)) {
<a name="l00993"></a>00993             require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l00994"></a>00994             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&#39;There is no table information for the key &quot;&#39;</span> . $key . <span class="charliteral">&#39;&quot;&#39;</span>);
<a name="l00995"></a>00995         }
<a name="l00996"></a>00996 
<a name="l00997"></a>00997         <span class="keywordflow">return</span> $info[$key];
<a name="l00998"></a>00998     }
<a name="l00999"></a>00999 
<a name="l01006"></a><a class="code" href="class_zend___db___table___abstract.html#aeea0aed7f43ce16fe3e82501f25d0f16">01006</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#aeea0aed7f43ce16fe3e82501f25d0f16">select</a>($withFromPart = self::SELECT_WITHOUT_FROM_PART)
<a name="l01007"></a>01007     {
<a name="l01008"></a>01008         require_once <span class="stringliteral">&#39;Zend/Db/Table/Select.php&#39;</span>;
<a name="l01009"></a>01009         $select = <span class="keyword">new</span> <a class="code" href="class_zend___db___table___select.html">Zend_Db_Table_Select</a>($this);
<a name="l01010"></a>01010         <span class="keywordflow">if</span> ($withFromPart == self::SELECT_WITH_FROM_PART) {
<a name="l01011"></a>01011             $select-&gt;from($this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a89f973e5889e6547d42043c37af3df35">info</a>(self::NAME), Zend_Db_Table_Select::SQL_WILDCARD, $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a89f973e5889e6547d42043c37af3df35">info</a>(self::SCHEMA));
<a name="l01012"></a>01012         }
<a name="l01013"></a>01013         <span class="keywordflow">return</span> $select;
<a name="l01014"></a>01014     }
<a name="l01015"></a>01015 
<a name="l01022"></a><a class="code" href="class_zend___db___table___abstract.html#a9036c33ccb06d6070a021ec2f2d34ca9">01022</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a9036c33ccb06d6070a021ec2f2d34ca9">insert</a>(array $data)
<a name="l01023"></a>01023     {
<a name="l01024"></a>01024         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a6b59b52f863f140ab29e21d73e0cfbe6">_setupPrimaryKey</a>();
<a name="l01025"></a>01025 
<a name="l01031"></a>01031         $primary = (array) $this-&gt;_primary;
<a name="l01032"></a>01032         $pkIdentity = $primary[(int)$this-&gt;_identity];
<a name="l01033"></a>01033 
<a name="l01040"></a>01040         <span class="keywordflow">if</span> (is_string($this-&gt;_sequence) &amp;&amp; !isset($data[$pkIdentity])) {
<a name="l01041"></a>01041             $data[$pkIdentity] = $this-&gt;_db-&gt;nextSequenceId($this-&gt;_sequence);
<a name="l01042"></a>01042         }
<a name="l01043"></a>01043 
<a name="l01048"></a>01048         <span class="keywordflow">if</span> (array_key_exists($pkIdentity, $data) &amp;&amp; $data[$pkIdentity] === null) {
<a name="l01049"></a>01049             unset($data[$pkIdentity]);
<a name="l01050"></a>01050         }
<a name="l01051"></a>01051 
<a name="l01055"></a>01055         $tableSpec = ($this-&gt;_schema ? $this-&gt;_schema . <span class="charliteral">&#39;.&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . $this-&gt;_name;
<a name="l01056"></a>01056         $this-&gt;_db-&gt;insert($tableSpec, $data);
<a name="l01057"></a>01057 
<a name="l01063"></a>01063         <span class="keywordflow">if</span> ($this-&gt;_sequence === <span class="keyword">true</span> &amp;&amp; !isset($data[$pkIdentity])) {
<a name="l01064"></a>01064             $data[$pkIdentity] = $this-&gt;_db-&gt;lastInsertId();
<a name="l01065"></a>01065         }
<a name="l01066"></a>01066 
<a name="l01071"></a>01071         $pkData = array_intersect_key($data, array_flip($primary));
<a name="l01072"></a>01072         <span class="keywordflow">if</span> (count($primary) == 1) {
<a name="l01073"></a>01073             reset($pkData);
<a name="l01074"></a>01074             <span class="keywordflow">return</span> current($pkData);
<a name="l01075"></a>01075         }
<a name="l01076"></a>01076 
<a name="l01077"></a>01077         <span class="keywordflow">return</span> $pkData;
<a name="l01078"></a>01078     }
<a name="l01079"></a>01079 
<a name="l01087"></a><a class="code" href="class_zend___db___table___abstract.html#a743c4ff06c2d69c903183db510cc5150">01087</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a743c4ff06c2d69c903183db510cc5150">isIdentity</a>($column)
<a name="l01088"></a>01088     {
<a name="l01089"></a>01089         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a6b59b52f863f140ab29e21d73e0cfbe6">_setupPrimaryKey</a>();
<a name="l01090"></a>01090 
<a name="l01091"></a>01091         <span class="keywordflow">if</span> (!isset($this-&gt;_metadata[$column])) {
<a name="l01095"></a>01095             require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l01096"></a>01096 
<a name="l01097"></a>01097             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&#39;Column &quot;&#39;</span> . $column . <span class="stringliteral">&#39;&quot; not found in table.&#39;</span>);
<a name="l01098"></a>01098         }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100         <span class="keywordflow">return</span> (<span class="keywordtype">bool</span>) $this-&gt;_metadata[$column][<span class="stringliteral">&#39;IDENTITY&#39;</span>];
<a name="l01101"></a>01101     }
<a name="l01102"></a>01102 
<a name="l01110"></a><a class="code" href="class_zend___db___table___abstract.html#aefe7f6cad4644d57a6ca7447c6c03ab9">01110</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#aefe7f6cad4644d57a6ca7447c6c03ab9">update</a>(array $data, $where)
<a name="l01111"></a>01111     {
<a name="l01112"></a>01112         $tableSpec = ($this-&gt;_schema ? $this-&gt;_schema . <span class="charliteral">&#39;.&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . $this-&gt;_name;
<a name="l01113"></a>01113         <span class="keywordflow">return</span> $this-&gt;_db-&gt;update($tableSpec, $data, $where);
<a name="l01114"></a>01114     }
<a name="l01115"></a>01115 
<a name="l01124"></a><a class="code" href="class_zend___db___table___abstract.html#afaaadb216b367ae8c4f662172ca9f0da">01124</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#afaaadb216b367ae8c4f662172ca9f0da">_cascadeUpdate</a>($parentTableClassname, array $oldPrimaryKey, array $newPrimaryKey)
<a name="l01125"></a>01125     {
<a name="l01126"></a>01126         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ab755f319f7dcb8b7c8ab0932bd3e324e">_setupMetadata</a>();
<a name="l01127"></a>01127         $rowsAffected = 0;
<a name="l01128"></a>01128         <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ac457237f9a210cfee68ddc2cb313a612">_getReferenceMapNormalized</a>() as $map) {
<a name="l01129"></a>01129             <span class="keywordflow">if</span> ($map[self::REF_TABLE_CLASS] == $parentTableClassname &amp;&amp; isset($map[self::ON_UPDATE])) {
<a name="l01130"></a>01130                 <span class="keywordflow">switch</span> ($map[self::ON_UPDATE]) {
<a name="l01131"></a>01131                     <span class="keywordflow">case</span> self::CASCADE:
<a name="l01132"></a>01132                         $newRefs = array();
<a name="l01133"></a>01133                         $where = array();
<a name="l01134"></a>01134                         <span class="keywordflow">for</span> ($i = 0; $i &lt; count($map[self::COLUMNS]); ++$i) {
<a name="l01135"></a>01135                             $col = $this-&gt;_db-&gt;foldCase($map[self::COLUMNS][$i]);
<a name="l01136"></a>01136                             $refCol = $this-&gt;_db-&gt;foldCase($map[self::REF_COLUMNS][$i]);
<a name="l01137"></a>01137                             <span class="keywordflow">if</span> (array_key_exists($refCol, $newPrimaryKey)) {
<a name="l01138"></a>01138                                 $newRefs[$col] = $newPrimaryKey[$refCol];
<a name="l01139"></a>01139                             }
<a name="l01140"></a>01140                             $type = $this-&gt;_metadata[$col][<span class="stringliteral">&#39;DATA_TYPE&#39;</span>];
<a name="l01141"></a>01141                             $where[] = $this-&gt;_db-&gt;quoteInto(
<a name="l01142"></a>01142                                 $this-&gt;_db-&gt;quoteIdentifier($col, <span class="keyword">true</span>) . <span class="stringliteral">&#39; = ?&#39;</span>,
<a name="l01143"></a>01143                                 $oldPrimaryKey[$refCol], $type);
<a name="l01144"></a>01144                         }
<a name="l01145"></a>01145                         $rowsAffected += $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#aefe7f6cad4644d57a6ca7447c6c03ab9">update</a>($newRefs, $where);
<a name="l01146"></a>01146                         <span class="keywordflow">break</span>;
<a name="l01147"></a>01147                     <span class="keywordflow">default</span>:
<a name="l01148"></a>01148                         <span class="comment">// no action</span>
<a name="l01149"></a>01149                         <span class="keywordflow">break</span>;
<a name="l01150"></a>01150                 }
<a name="l01151"></a>01151             }
<a name="l01152"></a>01152         }
<a name="l01153"></a>01153         <span class="keywordflow">return</span> $rowsAffected;
<a name="l01154"></a>01154     }
<a name="l01155"></a>01155 
<a name="l01162"></a><a class="code" href="class_zend___db___table___abstract.html#ac6a6e225ab189c96e4b8fb4a58a05ef2">01162</a>     <span class="keyword">public</span> function <span class="keyword">delete</span>($where)
<a name="l01163"></a>01163     {
<a name="l01164"></a>01164         $tableSpec = ($this-&gt;_schema ? $this-&gt;_schema . <span class="charliteral">&#39;.&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . $this-&gt;_name;
<a name="l01165"></a>01165         <span class="keywordflow">return</span> $this-&gt;_db-&gt;delete($tableSpec, $where);
<a name="l01166"></a>01166     }
<a name="l01167"></a>01167 
<a name="l01175"></a><a class="code" href="class_zend___db___table___abstract.html#a23c20ca0fd77170b59c7310a8fc705cf">01175</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a23c20ca0fd77170b59c7310a8fc705cf">_cascadeDelete</a>($parentTableClassname, array $primaryKey)
<a name="l01176"></a>01176     {
<a name="l01177"></a>01177         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ab755f319f7dcb8b7c8ab0932bd3e324e">_setupMetadata</a>();
<a name="l01178"></a>01178         $rowsAffected = 0;
<a name="l01179"></a>01179         <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ac457237f9a210cfee68ddc2cb313a612">_getReferenceMapNormalized</a>() as $map) {
<a name="l01180"></a>01180             <span class="keywordflow">if</span> ($map[self::REF_TABLE_CLASS] == $parentTableClassname &amp;&amp; isset($map[self::ON_DELETE])) {
<a name="l01181"></a>01181                 <span class="keywordflow">switch</span> ($map[self::ON_DELETE]) {
<a name="l01182"></a>01182                     <span class="keywordflow">case</span> self::CASCADE:
<a name="l01183"></a>01183                         $where = array();
<a name="l01184"></a>01184                         <span class="keywordflow">for</span> ($i = 0; $i &lt; count($map[self::COLUMNS]); ++$i) {
<a name="l01185"></a>01185                             $col = $this-&gt;_db-&gt;foldCase($map[self::COLUMNS][$i]);
<a name="l01186"></a>01186                             $refCol = $this-&gt;_db-&gt;foldCase($map[self::REF_COLUMNS][$i]);
<a name="l01187"></a>01187                             $type = $this-&gt;_metadata[$col][<span class="stringliteral">&#39;DATA_TYPE&#39;</span>];
<a name="l01188"></a>01188                             $where[] = $this-&gt;_db-&gt;quoteInto(
<a name="l01189"></a>01189                                 $this-&gt;_db-&gt;quoteIdentifier($col, <span class="keyword">true</span>) . <span class="stringliteral">&#39; = ?&#39;</span>,
<a name="l01190"></a>01190                                 $primaryKey[$refCol], $type);
<a name="l01191"></a>01191                         }
<a name="l01192"></a>01192                         $rowsAffected += $this-&gt;<span class="keyword">delete</span>($where);
<a name="l01193"></a>01193                         <span class="keywordflow">break</span>;
<a name="l01194"></a>01194                     <span class="keywordflow">default</span>:
<a name="l01195"></a>01195                         <span class="comment">// no action</span>
<a name="l01196"></a>01196                         <span class="keywordflow">break</span>;
<a name="l01197"></a>01197                 }
<a name="l01198"></a>01198             }
<a name="l01199"></a>01199         }
<a name="l01200"></a>01200         <span class="keywordflow">return</span> $rowsAffected;
<a name="l01201"></a>01201     }
<a name="l01202"></a>01202 
<a name="l01221"></a><a class="code" href="class_zend___db___table___abstract.html#a39ec161e9a5372e002b889d276208899">01221</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a39ec161e9a5372e002b889d276208899">find</a>()
<a name="l01222"></a>01222     {
<a name="l01223"></a>01223         $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a6b59b52f863f140ab29e21d73e0cfbe6">_setupPrimaryKey</a>();
<a name="l01224"></a>01224         $args = func_get_args();
<a name="l01225"></a>01225         $keyNames = array_values((array) $this-&gt;_primary);
<a name="l01226"></a>01226 
<a name="l01227"></a>01227         <span class="keywordflow">if</span> (count($args) &lt; count($keyNames)) {
<a name="l01228"></a>01228             require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l01229"></a>01229             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&quot;Too few columns for the primary key&quot;</span>);
<a name="l01230"></a>01230         }
<a name="l01231"></a>01231 
<a name="l01232"></a>01232         <span class="keywordflow">if</span> (count($args) &gt; count($keyNames)) {
<a name="l01233"></a>01233             require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l01234"></a>01234             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&quot;Too many columns for the primary key&quot;</span>);
<a name="l01235"></a>01235         }
<a name="l01236"></a>01236 
<a name="l01237"></a>01237         $whereList = array();
<a name="l01238"></a>01238         $numberTerms = 0;
<a name="l01239"></a>01239         <span class="keywordflow">foreach</span> ($args as $keyPosition =&gt; $keyValues) {
<a name="l01240"></a>01240             $keyValuesCount = count($keyValues);
<a name="l01241"></a>01241             <span class="comment">// Coerce the values to an array.</span>
<a name="l01242"></a>01242             <span class="comment">// Don&#39;t simply typecast to array, because the values</span>
<a name="l01243"></a>01243             <span class="comment">// might be Zend_Db_Expr objects.</span>
<a name="l01244"></a>01244             <span class="keywordflow">if</span> (!is_array($keyValues)) {
<a name="l01245"></a>01245                 $keyValues = array($keyValues);
<a name="l01246"></a>01246             }
<a name="l01247"></a>01247             <span class="keywordflow">if</span> ($numberTerms == 0) {
<a name="l01248"></a>01248                 $numberTerms = $keyValuesCount;
<a name="l01249"></a>01249             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($keyValuesCount != $numberTerms) {
<a name="l01250"></a>01250                 require_once <span class="stringliteral">&#39;Zend/Db/Table/Exception.php&#39;</span>;
<a name="l01251"></a>01251                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_zend___db___table___exception.html">Zend_Db_Table_Exception</a>(<span class="stringliteral">&quot;Missing value(s) for the primary key&quot;</span>);
<a name="l01252"></a>01252             }
<a name="l01253"></a>01253             $keyValues = array_values($keyValues);
<a name="l01254"></a>01254             <span class="keywordflow">for</span> ($i = 0; $i &lt; $keyValuesCount; ++$i) {
<a name="l01255"></a>01255                 <span class="keywordflow">if</span> (!isset($whereList[$i])) {
<a name="l01256"></a>01256                     $whereList[$i] = array();
<a name="l01257"></a>01257                 }
<a name="l01258"></a>01258                 $whereList[$i][$keyPosition] = $keyValues[$i];
<a name="l01259"></a>01259             }
<a name="l01260"></a>01260         }
<a name="l01261"></a>01261 
<a name="l01262"></a>01262         $whereClause = null;
<a name="l01263"></a>01263         <span class="keywordflow">if</span> (count($whereList)) {
<a name="l01264"></a>01264             $whereOrTerms = array();
<a name="l01265"></a>01265             $tableName = $this-&gt;_db-&gt;quoteTableAs($this-&gt;_name, null, <span class="keyword">true</span>);
<a name="l01266"></a>01266             <span class="keywordflow">foreach</span> ($whereList as $keyValueSets) {
<a name="l01267"></a>01267                 $whereAndTerms = array();
<a name="l01268"></a>01268                 <span class="keywordflow">foreach</span> ($keyValueSets as $keyPosition =&gt; $keyValue) {
<a name="l01269"></a>01269                     $type = $this-&gt;_metadata[$keyNames[$keyPosition]][<span class="stringliteral">&#39;DATA_TYPE&#39;</span>];
<a name="l01270"></a>01270                     $columnName = $this-&gt;_db-&gt;quoteIdentifier($keyNames[$keyPosition], <span class="keyword">true</span>);
<a name="l01271"></a>01271                     $whereAndTerms[] = $this-&gt;_db-&gt;quoteInto(
<a name="l01272"></a>01272                         $tableName . <span class="charliteral">&#39;.&#39;</span> . $columnName . <span class="stringliteral">&#39; = ?&#39;</span>,
<a name="l01273"></a>01273                         $keyValue, $type);
<a name="l01274"></a>01274                 }
<a name="l01275"></a>01275                 $whereOrTerms[] = <span class="charliteral">&#39;(&#39;</span> . implode(<span class="stringliteral">&#39; AND &#39;</span>, $whereAndTerms) . <span class="charliteral">&#39;)&#39;</span>;
<a name="l01276"></a>01276             }
<a name="l01277"></a>01277             $whereClause = <span class="charliteral">&#39;(&#39;</span> . implode(<span class="stringliteral">&#39; OR &#39;</span>, $whereOrTerms) . <span class="charliteral">&#39;)&#39;</span>;
<a name="l01278"></a>01278         }
<a name="l01279"></a>01279 
<a name="l01280"></a>01280         <span class="comment">// issue ZF-5775 (empty where clause should return empty rowset)</span>
<a name="l01281"></a>01281         <span class="keywordflow">if</span> ($whereClause == null) {
<a name="l01282"></a>01282             $rowsetClass = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a83520617bab9327cdc63a8d3f007fab2">getRowsetClass</a>();
<a name="l01283"></a>01283             <span class="keywordflow">if</span> (!class_exists($rowsetClass)) {
<a name="l01284"></a>01284                 require_once <span class="stringliteral">&#39;Zend/Loader.php&#39;</span>;
<a name="l01285"></a>01285                 <a class="code" href="class_zend___loader.html#a3d4b9877e0dcc1904b8e41d86be11d93">Zend_Loader::loadClass</a>($rowsetClass);
<a name="l01286"></a>01286             }
<a name="l01287"></a>01287             <span class="keywordflow">return</span> <span class="keyword">new</span> $rowsetClass(array(<span class="stringliteral">&#39;table&#39;</span> =&gt; $this, <span class="stringliteral">&#39;rowClass&#39;</span> =&gt; $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a68212414ce0c242917be7470ce76c07a">getRowClass</a>(), <span class="stringliteral">&#39;stored&#39;</span> =&gt; <span class="keyword">true</span>));
<a name="l01288"></a>01288         }
<a name="l01289"></a>01289 
<a name="l01290"></a>01290         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ae05a154123cb1b37088d9d7c3787eb79">fetchAll</a>($whereClause);
<a name="l01291"></a>01291     }
<a name="l01292"></a>01292 
<a name="l01304"></a><a class="code" href="class_zend___db___table___abstract.html#ae05a154123cb1b37088d9d7c3787eb79">01304</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#ae05a154123cb1b37088d9d7c3787eb79">fetchAll</a>($where = null, $order = null, $count = null, $offset = null)
<a name="l01305"></a>01305     {
<a name="l01306"></a>01306         <span class="keywordflow">if</span> (!($where instanceof <a class="code" href="class_zend___db___table___select.html">Zend_Db_Table_Select</a>)) {
<a name="l01307"></a>01307             $select = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#aeea0aed7f43ce16fe3e82501f25d0f16">select</a>();
<a name="l01308"></a>01308 
<a name="l01309"></a>01309             <span class="keywordflow">if</span> ($where !== null) {
<a name="l01310"></a>01310                 $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a760eee21103b6581076efefd8d63a493">_where</a>($select, $where);
<a name="l01311"></a>01311             }
<a name="l01312"></a>01312 
<a name="l01313"></a>01313             <span class="keywordflow">if</span> ($order !== null) {
<a name="l01314"></a>01314                 $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a9cf8693e47a712d3383f47320c16f8d9">_order</a>($select, $order);
<a name="l01315"></a>01315             }
<a name="l01316"></a>01316 
<a name="l01317"></a>01317             <span class="keywordflow">if</span> ($count !== null || $offset !== null) {
<a name="l01318"></a>01318                 $select-&gt;limit($count, $offset);
<a name="l01319"></a>01319             }
<a name="l01320"></a>01320 
<a name="l01321"></a>01321         } <span class="keywordflow">else</span> {
<a name="l01322"></a>01322             $select = $where;
<a name="l01323"></a>01323         }
<a name="l01324"></a>01324 
<a name="l01325"></a>01325         $rows = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a241a8ef9a5af0b82ace2c6038f925778">_fetch</a>($select);
<a name="l01326"></a>01326 
<a name="l01327"></a>01327         $data  = array(
<a name="l01328"></a>01328             <span class="stringliteral">&#39;table&#39;</span>    =&gt; $this,
<a name="l01329"></a>01329             <span class="stringliteral">&#39;data&#39;</span>     =&gt; $rows,
<a name="l01330"></a>01330             <span class="stringliteral">&#39;readOnly&#39;</span> =&gt; $select-&gt;isReadOnly(),
<a name="l01331"></a>01331             <span class="stringliteral">&#39;rowClass&#39;</span> =&gt; $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a68212414ce0c242917be7470ce76c07a">getRowClass</a>(),
<a name="l01332"></a>01332             <span class="stringliteral">&#39;stored&#39;</span>   =&gt; true
<a name="l01333"></a>01333         );
<a name="l01334"></a>01334 
<a name="l01335"></a>01335         $rowsetClass = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a83520617bab9327cdc63a8d3f007fab2">getRowsetClass</a>();
<a name="l01336"></a>01336         <span class="keywordflow">if</span> (!class_exists($rowsetClass)) {
<a name="l01337"></a>01337             require_once <span class="stringliteral">&#39;Zend/Loader.php&#39;</span>;
<a name="l01338"></a>01338             <a class="code" href="class_zend___loader.html#a3d4b9877e0dcc1904b8e41d86be11d93">Zend_Loader::loadClass</a>($rowsetClass);
<a name="l01339"></a>01339         }
<a name="l01340"></a>01340         <span class="keywordflow">return</span> <span class="keyword">new</span> $rowsetClass($data);
<a name="l01341"></a>01341     }
<a name="l01342"></a>01342 
<a name="l01352"></a><a class="code" href="class_zend___db___table___abstract.html#ada04b78cf80e520211e38567195e3f60">01352</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#ada04b78cf80e520211e38567195e3f60">fetchRow</a>($where = null, $order = null)
<a name="l01353"></a>01353     {
<a name="l01354"></a>01354         <span class="keywordflow">if</span> (!($where instanceof <a class="code" href="class_zend___db___table___select.html">Zend_Db_Table_Select</a>)) {
<a name="l01355"></a>01355             $select = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#aeea0aed7f43ce16fe3e82501f25d0f16">select</a>();
<a name="l01356"></a>01356 
<a name="l01357"></a>01357             <span class="keywordflow">if</span> ($where !== null) {
<a name="l01358"></a>01358                 $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a760eee21103b6581076efefd8d63a493">_where</a>($select, $where);
<a name="l01359"></a>01359             }
<a name="l01360"></a>01360 
<a name="l01361"></a>01361             <span class="keywordflow">if</span> ($order !== null) {
<a name="l01362"></a>01362                 $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a9cf8693e47a712d3383f47320c16f8d9">_order</a>($select, $order);
<a name="l01363"></a>01363             }
<a name="l01364"></a>01364 
<a name="l01365"></a>01365             $select-&gt;limit(1);
<a name="l01366"></a>01366 
<a name="l01367"></a>01367         } <span class="keywordflow">else</span> {
<a name="l01368"></a>01368             $select = $where-&gt;limit(1);
<a name="l01369"></a>01369         }
<a name="l01370"></a>01370 
<a name="l01371"></a>01371         $rows = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a241a8ef9a5af0b82ace2c6038f925778">_fetch</a>($select);
<a name="l01372"></a>01372 
<a name="l01373"></a>01373         <span class="keywordflow">if</span> (count($rows) == 0) {
<a name="l01374"></a>01374             <span class="keywordflow">return</span> null;
<a name="l01375"></a>01375         }
<a name="l01376"></a>01376 
<a name="l01377"></a>01377         $data = array(
<a name="l01378"></a>01378             <span class="stringliteral">&#39;table&#39;</span>   =&gt; $this,
<a name="l01379"></a>01379             <span class="stringliteral">&#39;data&#39;</span>     =&gt; $rows[0],
<a name="l01380"></a>01380             <span class="stringliteral">&#39;readOnly&#39;</span> =&gt; $select-&gt;isReadOnly(),
<a name="l01381"></a>01381             <span class="stringliteral">&#39;stored&#39;</span>  =&gt; true
<a name="l01382"></a>01382         );
<a name="l01383"></a>01383 
<a name="l01384"></a>01384         $rowClass = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a68212414ce0c242917be7470ce76c07a">getRowClass</a>();
<a name="l01385"></a>01385         <span class="keywordflow">if</span> (!class_exists($rowClass)) {
<a name="l01386"></a>01386             require_once <span class="stringliteral">&#39;Zend/Loader.php&#39;</span>;
<a name="l01387"></a>01387             <a class="code" href="class_zend___loader.html#a3d4b9877e0dcc1904b8e41d86be11d93">Zend_Loader::loadClass</a>($rowClass);
<a name="l01388"></a>01388         }
<a name="l01389"></a>01389         <span class="keywordflow">return</span> <span class="keyword">new</span> $rowClass($data);
<a name="l01390"></a>01390     }
<a name="l01391"></a>01391 
<a name="l01398"></a><a class="code" href="class_zend___db___table___abstract.html#af787cbed01b6d2a5768dc122bb24bf8b">01398</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#af787cbed01b6d2a5768dc122bb24bf8b">fetchNew</a>()
<a name="l01399"></a>01399     {
<a name="l01400"></a>01400         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a2a4e0ea7b786e52bb6202273d8289e05">createRow</a>();
<a name="l01401"></a>01401     }
<a name="l01402"></a>01402 
<a name="l01410"></a><a class="code" href="class_zend___db___table___abstract.html#a2a4e0ea7b786e52bb6202273d8289e05">01410</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___db___table___abstract.html#a2a4e0ea7b786e52bb6202273d8289e05">createRow</a>(array $data = array(), $defaultSource = null)
<a name="l01411"></a>01411     {
<a name="l01412"></a>01412         $cols     = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#ab8d468234319703c8f94cfebfba0cac7">_getCols</a>();
<a name="l01413"></a>01413         $defaults = array_combine($cols, array_fill(0, count($cols), null));
<a name="l01414"></a>01414 
<a name="l01415"></a>01415         <span class="comment">// nothing provided at call-time, take the class value</span>
<a name="l01416"></a>01416         <span class="keywordflow">if</span> ($defaultSource == null) {
<a name="l01417"></a>01417             $defaultSource = $this-&gt;_defaultSource;
<a name="l01418"></a>01418         }
<a name="l01419"></a>01419 
<a name="l01420"></a>01420         <span class="keywordflow">if</span> (!in_array($defaultSource, array(self::DEFAULT_CLASS, self::DEFAULT_DB, self::DEFAULT_NONE))) {
<a name="l01421"></a>01421             $defaultSource = self::DEFAULT_NONE;
<a name="l01422"></a>01422         }
<a name="l01423"></a>01423 
<a name="l01424"></a>01424         <span class="keywordflow">if</span> ($defaultSource == self::DEFAULT_DB) {
<a name="l01425"></a>01425             <span class="keywordflow">foreach</span> ($this-&gt;_metadata as $metadataName =&gt; $metadata) {
<a name="l01426"></a>01426                 <span class="keywordflow">if</span> (($metadata[<span class="stringliteral">&#39;DEFAULT&#39;</span>] != null) &amp;&amp;
<a name="l01427"></a>01427                     ($metadata[<span class="stringliteral">&#39;NULLABLE&#39;</span>] !== <span class="keyword">true</span> || ($metadata[<span class="stringliteral">&#39;NULLABLE&#39;</span>] === <span class="keyword">true</span> &amp;&amp; isset($this-&gt;_defaultValues[$metadataName]) &amp;&amp; $this-&gt;_defaultValues[$metadataName] === <span class="keyword">true</span>)) &amp;&amp;
<a name="l01428"></a>01428                     (!(isset($this-&gt;_defaultValues[$metadataName]) &amp;&amp; $this-&gt;_defaultValues[$metadataName] === <span class="keyword">false</span>))) {
<a name="l01429"></a>01429                     $defaults[$metadataName] = $metadata[<span class="stringliteral">&#39;DEFAULT&#39;</span>];
<a name="l01430"></a>01430                 }
<a name="l01431"></a>01431             }
<a name="l01432"></a>01432         } elseif ($defaultSource == self::DEFAULT_CLASS &amp;&amp; $this-&gt;_defaultValues) {
<a name="l01433"></a>01433             <span class="keywordflow">foreach</span> ($this-&gt;_defaultValues as $defaultName =&gt; $defaultValue) {
<a name="l01434"></a>01434                 <span class="keywordflow">if</span> (array_key_exists($defaultName, $defaults)) {
<a name="l01435"></a>01435                     $defaults[$defaultName] = $defaultValue;
<a name="l01436"></a>01436                 }
<a name="l01437"></a>01437             }
<a name="l01438"></a>01438         }
<a name="l01439"></a>01439 
<a name="l01440"></a>01440         $config = array(
<a name="l01441"></a>01441             <span class="stringliteral">&#39;table&#39;</span>    =&gt; $this,
<a name="l01442"></a>01442             <span class="stringliteral">&#39;data&#39;</span>     =&gt; $defaults,
<a name="l01443"></a>01443             <span class="stringliteral">&#39;readOnly&#39;</span> =&gt; <span class="keyword">false</span>,
<a name="l01444"></a>01444             <span class="stringliteral">&#39;stored&#39;</span>   =&gt; <span class="keyword">false</span>
<a name="l01445"></a>01445         );
<a name="l01446"></a>01446 
<a name="l01447"></a>01447         $rowClass = $this-&gt;<a class="code" href="class_zend___db___table___abstract.html#a68212414ce0c242917be7470ce76c07a">getRowClass</a>();
<a name="l01448"></a>01448         <span class="keywordflow">if</span> (!class_exists($rowClass)) {
<a name="l01449"></a>01449             require_once <span class="stringliteral">&#39;Zend/Loader.php&#39;</span>;
<a name="l01450"></a>01450             <a class="code" href="class_zend___loader.html#a3d4b9877e0dcc1904b8e41d86be11d93">Zend_Loader::loadClass</a>($rowClass);
<a name="l01451"></a>01451         }
<a name="l01452"></a>01452         $row = <span class="keyword">new</span> $rowClass($config);
<a name="l01453"></a>01453         $row-&gt;setFromArray($data);
<a name="l01454"></a>01454         <span class="keywordflow">return</span> $row;
<a name="l01455"></a>01455     }
<a name="l01456"></a>01456 
<a name="l01463"></a><a class="code" href="class_zend___db___table___abstract.html#a760eee21103b6581076efefd8d63a493">01463</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#a760eee21103b6581076efefd8d63a493">_where</a>(<a class="code" href="class_zend___db___table___select.html">Zend_Db_Table_Select</a> $select, $where)
<a name="l01464"></a>01464     {
<a name="l01465"></a>01465         $where = (array) $where;
<a name="l01466"></a>01466 
<a name="l01467"></a>01467         <span class="keywordflow">foreach</span> ($where as $key =&gt; $val) {
<a name="l01468"></a>01468             <span class="comment">// is $key an int?</span>
<a name="l01469"></a>01469             <span class="keywordflow">if</span> (is_int($key)) {
<a name="l01470"></a>01470                 <span class="comment">// $val is the full condition</span>
<a name="l01471"></a>01471                 $select-&gt;<a class="code" href="class_zend___db___select.html#aa9b48821d6c77dd6e0332226cc2cb59b">where</a>($val);
<a name="l01472"></a>01472             } <span class="keywordflow">else</span> {
<a name="l01473"></a>01473                 <span class="comment">// $key is the condition with placeholder,</span>
<a name="l01474"></a>01474                 <span class="comment">// and $val is quoted into the condition</span>
<a name="l01475"></a>01475                 $select-&gt;<a class="code" href="class_zend___db___select.html#aa9b48821d6c77dd6e0332226cc2cb59b">where</a>($key, $val);
<a name="l01476"></a>01476             }
<a name="l01477"></a>01477         }
<a name="l01478"></a>01478 
<a name="l01479"></a>01479         <span class="keywordflow">return</span> $select;
<a name="l01480"></a>01480     }
<a name="l01481"></a>01481 
<a name="l01488"></a><a class="code" href="class_zend___db___table___abstract.html#a9cf8693e47a712d3383f47320c16f8d9">01488</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#a9cf8693e47a712d3383f47320c16f8d9">_order</a>(<a class="code" href="class_zend___db___table___select.html">Zend_Db_Table_Select</a> $select, $order)
<a name="l01489"></a>01489     {
<a name="l01490"></a>01490         <span class="keywordflow">if</span> (!is_array($order)) {
<a name="l01491"></a>01491             $order = array($order);
<a name="l01492"></a>01492         }
<a name="l01493"></a>01493 
<a name="l01494"></a>01494         <span class="keywordflow">foreach</span> ($order as $val) {
<a name="l01495"></a>01495             $select-&gt;<a class="code" href="class_zend___db___select.html#a53365855abf67f812e9929237eb67074">order</a>($val);
<a name="l01496"></a>01496         }
<a name="l01497"></a>01497 
<a name="l01498"></a>01498         <span class="keywordflow">return</span> $select;
<a name="l01499"></a>01499     }
<a name="l01500"></a>01500 
<a name="l01507"></a><a class="code" href="class_zend___db___table___abstract.html#a241a8ef9a5af0b82ace2c6038f925778">01507</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___db___table___abstract.html#a241a8ef9a5af0b82ace2c6038f925778">_fetch</a>(<a class="code" href="class_zend___db___table___select.html">Zend_Db_Table_Select</a> $select)
<a name="l01508"></a>01508     {
<a name="l01509"></a>01509         $stmt = $this-&gt;_db-&gt;query($select);
<a name="l01510"></a>01510         $data = $stmt-&gt;fetchAll(Zend_Db::FETCH_ASSOC);
<a name="l01511"></a>01511         <span class="keywordflow">return</span> $data;
<a name="l01512"></a>01512     }
<a name="l01513"></a>01513 
<a name="l01514"></a>01514 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Apr 19 2012 17:01:17 for openbiz by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
