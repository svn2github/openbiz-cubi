<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>openbiz: E:/E/GEAMP/www/openbiz/openbiz/others/Smarty/libs/Smarty.class.src.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>E:/E/GEAMP/www/openbiz/openbiz/others/Smarty/libs/Smarty.class.src.php</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00033"></a>00033 <span class="comment">/* $Id: Smarty.class.php,v 1.516 2005/07/18 08:43:53 messju Exp $ */</span>
<a name="l00034"></a>00034 
<a name="l00038"></a>00038 <span class="keywordflow">if</span>(!defined(<span class="stringliteral">&#39;DIR_SEP&#39;</span>)) {
<a name="l00039"></a>00039     define(<span class="stringliteral">&#39;DIR_SEP&#39;</span>, DIRECTORY_SEPARATOR);
<a name="l00040"></a>00040 }
<a name="l00041"></a>00041 
<a name="l00048"></a>00048 <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;SMARTY_DIR&#39;</span>)) {
<a name="l00049"></a>00049     define(<span class="stringliteral">&#39;SMARTY_DIR&#39;</span>, dirname(__FILE__) . DIRECTORY_SEPARATOR);
<a name="l00050"></a>00050 }
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;SMARTY_CORE_DIR&#39;</span>)) {
<a name="l00053"></a>00053     define(<span class="stringliteral">&#39;SMARTY_CORE_DIR&#39;</span>, SMARTY_DIR . <span class="stringliteral">&#39;internals&#39;</span> . DIRECTORY_SEPARATOR);
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 define(<span class="stringliteral">&#39;SMARTY_PHP_PASSTHRU&#39;</span>,   0);
<a name="l00057"></a>00057 define(<span class="stringliteral">&#39;SMARTY_PHP_QUOTE&#39;</span>,      1);
<a name="l00058"></a>00058 define(<span class="stringliteral">&#39;SMARTY_PHP_REMOVE&#39;</span>,     2);
<a name="l00059"></a>00059 define(<span class="stringliteral">&#39;SMARTY_PHP_ALLOW&#39;</span>,      3);
<a name="l00060"></a>00060 
<a name="l00064"></a><a class="code" href="class_smarty.html">00064</a> <span class="keyword">class </span><a class="code" href="class_smarty.html">Smarty</a>
<a name="l00065"></a>00065 {
<a name="l00075"></a>00075     var $template_dir    =  <span class="stringliteral">&#39;templates&#39;</span>;
<a name="l00076"></a>00076 
<a name="l00082"></a>00082     var $compile_dir     =  <span class="stringliteral">&#39;templates_c&#39;</span>;
<a name="l00083"></a>00083 
<a name="l00089"></a>00089     var $config_dir      =  <span class="stringliteral">&#39;configs&#39;</span>;
<a name="l00090"></a>00090 
<a name="l00096"></a>00096     var $plugins_dir     =  array(<span class="stringliteral">&#39;plugins&#39;</span>);
<a name="l00097"></a>00097 
<a name="l00105"></a>00105     var $debugging       =  <span class="keyword">false</span>;
<a name="l00106"></a>00106 
<a name="l00112"></a>00112     var $error_reporting  =  null;
<a name="l00113"></a>00113 
<a name="l00120"></a>00120     var $debug_tpl       =  <span class="stringliteral">&#39;&#39;</span>;
<a name="l00121"></a>00121 
<a name="l00131"></a>00131     var $debugging_ctrl  =  <span class="stringliteral">&#39;NONE&#39;</span>;
<a name="l00132"></a>00132 
<a name="l00141"></a>00141     var $compile_check   =  <span class="keyword">true</span>;
<a name="l00142"></a>00142 
<a name="l00149"></a>00149     var $force_compile   =  <span class="keyword">false</span>;
<a name="l00150"></a>00150 
<a name="l00160"></a>00160     var $caching         =  0;
<a name="l00161"></a>00161 
<a name="l00167"></a>00167     var $cache_dir       =  <span class="stringliteral">&#39;cache&#39;</span>;
<a name="l00168"></a>00168 
<a name="l00178"></a>00178     var $cache_lifetime  =  3600;
<a name="l00179"></a>00179 
<a name="l00188"></a>00188     var $cache_modified_check = <span class="keyword">false</span>;
<a name="l00189"></a>00189 
<a name="l00202"></a>00202     var $php_handling    =  SMARTY_PHP_PASSTHRU;
<a name="l00203"></a>00203 
<a name="l00212"></a>00212     var $security       =   <span class="keyword">false</span>;
<a name="l00213"></a>00213 
<a name="l00221"></a>00221     var $secure_dir     =   array();
<a name="l00222"></a>00222 
<a name="l00229"></a>00229     var $security_settings  = array(
<a name="l00230"></a>00230                                     <span class="stringliteral">&#39;PHP_HANDLING&#39;</span>    =&gt; <span class="keyword">false</span>,
<a name="l00231"></a>00231                                     <span class="stringliteral">&#39;IF_FUNCS&#39;</span>        =&gt; array(<span class="stringliteral">&#39;array&#39;</span>, <span class="stringliteral">&#39;list&#39;</span>,
<a name="l00232"></a>00232                                                                <span class="stringliteral">&#39;isset&#39;</span>, <span class="stringliteral">&#39;empty&#39;</span>,
<a name="l00233"></a>00233                                                                <span class="stringliteral">&#39;count&#39;</span>, <span class="stringliteral">&#39;sizeof&#39;</span>,
<a name="l00234"></a>00234                                                                <span class="stringliteral">&#39;in_array&#39;</span>, <span class="stringliteral">&#39;is_array&#39;</span>,
<a name="l00235"></a>00235                                                                <span class="stringliteral">&#39;true&#39;</span>, <span class="stringliteral">&#39;false&#39;</span>, <span class="stringliteral">&#39;null&#39;</span>),
<a name="l00236"></a>00236                                     <span class="stringliteral">&#39;INCLUDE_ANY&#39;</span>     =&gt; <span class="keyword">false</span>,
<a name="l00237"></a>00237                                     <span class="stringliteral">&#39;PHP_TAGS&#39;</span>        =&gt; <span class="keyword">false</span>,
<a name="l00238"></a>00238                                     <span class="stringliteral">&#39;MODIFIER_FUNCS&#39;</span>  =&gt; array(<span class="stringliteral">&#39;count&#39;</span>),
<a name="l00239"></a>00239                                     <span class="stringliteral">&#39;ALLOW_CONSTANTS&#39;</span>  =&gt; <span class="keyword">false</span>
<a name="l00240"></a>00240                                    );
<a name="l00241"></a>00241 
<a name="l00248"></a>00248     var $trusted_dir        = array();
<a name="l00249"></a>00249 
<a name="l00255"></a>00255     var $left_delimiter  =  <span class="charliteral">&#39;{&#39;</span>;
<a name="l00256"></a>00256 
<a name="l00262"></a>00262     var $right_delimiter =  <span class="charliteral">&#39;}&#39;</span>;
<a name="l00263"></a>00263 
<a name="l00271"></a>00271     var $request_vars_order    = <span class="stringliteral">&#39;EGPCS&#39;</span>;
<a name="l00272"></a>00272 
<a name="l00281"></a>00281     var $request_use_auto_globals      = <span class="keyword">true</span>;
<a name="l00282"></a>00282 
<a name="l00291"></a>00291     var $compile_id            = null;
<a name="l00292"></a>00292 
<a name="l00301"></a>00301     var $use_sub_dirs          = <span class="keyword">false</span>;
<a name="l00302"></a>00302 
<a name="l00310"></a>00310     var $default_modifiers        = array();
<a name="l00311"></a>00311 
<a name="l00324"></a>00324     var $default_resource_type    = <span class="stringliteral">&#39;file&#39;</span>;
<a name="l00325"></a>00325 
<a name="l00331"></a>00331     var $cache_handler_func   = null;
<a name="l00332"></a>00332 
<a name="l00338"></a>00338     var $autoload_filters = array();
<a name="l00339"></a>00339 
<a name="l00347"></a><a class="code" href="class_smarty.html#a728421c1493ea20b619459924184b06d">00347</a>     var <a class="code" href="class_smarty.html#a728421c1493ea20b619459924184b06d">$config_overwrite</a> = <span class="keyword">true</span>;
<a name="l00348"></a>00348 
<a name="l00354"></a><a class="code" href="class_smarty.html#ab3e274a6c3fd439b83380c17a71255bb">00354</a>     var <a class="code" href="class_smarty.html#ab3e274a6c3fd439b83380c17a71255bb">$config_booleanize</a> = <span class="keyword">true</span>;
<a name="l00355"></a>00355 
<a name="l00362"></a><a class="code" href="class_smarty.html#add257cafa2cc7f2c68381f9bcc6f4d7b">00362</a>     var <a class="code" href="class_smarty.html#add257cafa2cc7f2c68381f9bcc6f4d7b">$config_read_hidden</a> = <span class="keyword">false</span>;
<a name="l00363"></a>00363 
<a name="l00368"></a><a class="code" href="class_smarty.html#a4df07d516adb04c09b5f77b556d3b5bc">00368</a>     var <a class="code" href="class_smarty.html#a4df07d516adb04c09b5f77b556d3b5bc">$config_fix_newlines</a> = <span class="keyword">true</span>;
<a name="l00377"></a>00377     var $default_template_handler_func = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00378"></a>00378 
<a name="l00385"></a>00385     var $compiler_file        =    <span class="stringliteral">&#39;Smarty_Compiler.class.php&#39;</span>;
<a name="l00386"></a>00386 
<a name="l00392"></a>00392     var $compiler_class        =   <span class="stringliteral">&#39;Smarty_Compiler&#39;</span>;
<a name="l00393"></a>00393 
<a name="l00399"></a>00399     var $config_class          =   <span class="stringliteral">&#39;Config_File&#39;</span>;
<a name="l00400"></a>00400 
<a name="l00411"></a>00411     var $_tpl_vars             = array();
<a name="l00412"></a>00412 
<a name="l00418"></a>00418     var $_smarty_vars          = null;
<a name="l00419"></a>00419 
<a name="l00425"></a>00425     var $_sections             = array();
<a name="l00426"></a>00426 
<a name="l00432"></a>00432     var $_foreach              = array();
<a name="l00433"></a>00433 
<a name="l00439"></a>00439     var $_tag_stack            = array();
<a name="l00440"></a>00440 
<a name="l00446"></a>00446     var $_conf_obj             = null;
<a name="l00447"></a>00447 
<a name="l00453"></a>00453     var $_config               = array(array(<span class="stringliteral">&#39;vars&#39;</span>  =&gt; array(), <span class="stringliteral">&#39;files&#39;</span> =&gt; array()));
<a name="l00454"></a>00454 
<a name="l00460"></a>00460     var $_smarty_md5           = <span class="stringliteral">&#39;f8d698aea36fcbead2b9d5359ffca76f&#39;</span>;
<a name="l00461"></a>00461 
<a name="l00467"></a>00467     var $_version              = <span class="stringliteral">&#39;2.6.10&#39;</span>;
<a name="l00468"></a>00468 
<a name="l00474"></a>00474     var $_inclusion_depth      = 0;
<a name="l00475"></a>00475 
<a name="l00481"></a>00481     var $_compile_id           = null;
<a name="l00482"></a>00482 
<a name="l00488"></a>00488     var $_smarty_debug_id      = <span class="stringliteral">&#39;SMARTY_DEBUG&#39;</span>;
<a name="l00489"></a>00489 
<a name="l00495"></a>00495     var $_smarty_debug_info    = array();
<a name="l00496"></a>00496 
<a name="l00502"></a>00502     var $_cache_info           = array();
<a name="l00503"></a>00503 
<a name="l00509"></a>00509     var $_file_perms           = 0644;
<a name="l00510"></a>00510 
<a name="l00516"></a>00516     var $_dir_perms               = 0771;
<a name="l00517"></a>00517 
<a name="l00523"></a>00523     var $_reg_objects           = array();
<a name="l00524"></a>00524 
<a name="l00530"></a>00530     var $_plugins              = array(
<a name="l00531"></a>00531                                        <span class="stringliteral">&#39;modifier&#39;</span>      =&gt; array(),
<a name="l00532"></a>00532                                        <span class="stringliteral">&#39;function&#39;</span>      =&gt; array(),
<a name="l00533"></a>00533                                        <span class="stringliteral">&#39;block&#39;</span>         =&gt; array(),
<a name="l00534"></a>00534                                        <span class="stringliteral">&#39;compiler&#39;</span>      =&gt; array(),
<a name="l00535"></a>00535                                        <span class="stringliteral">&#39;prefilter&#39;</span>     =&gt; array(),
<a name="l00536"></a>00536                                        <span class="stringliteral">&#39;postfilter&#39;</span>    =&gt; array(),
<a name="l00537"></a>00537                                        <span class="stringliteral">&#39;outputfilter&#39;</span>  =&gt; array(),
<a name="l00538"></a>00538                                        <span class="stringliteral">&#39;resource&#39;</span>      =&gt; array(),
<a name="l00539"></a>00539                                        <span class="stringliteral">&#39;insert&#39;</span>        =&gt; array());
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 
<a name="l00547"></a>00547     var $_cache_serials = array();
<a name="l00548"></a>00548 
<a name="l00554"></a>00554     var $_cache_include = null;
<a name="l00555"></a>00555 
<a name="l00562"></a>00562     var $_cache_including = <span class="keyword">false</span>;
<a name="l00563"></a>00563 
<a name="l00568"></a><a class="code" href="class_smarty.html#a95e66b59b996781de0a0b95c83f1a5a7">00568</a>     function <a class="code" href="class_smarty.html#a95e66b59b996781de0a0b95c83f1a5a7">Smarty</a>()
<a name="l00569"></a>00569     {
<a name="l00570"></a>00570       $this-&gt;<a class="code" href="class_smarty.html#a12150893d5c5bab121e248f450e727fa">assign</a>(<span class="stringliteral">&#39;SCRIPT_NAME&#39;</span>, isset($_SERVER[<span class="stringliteral">&#39;SCRIPT_NAME&#39;</span>]) ? $_SERVER[<span class="stringliteral">&#39;SCRIPT_NAME&#39;</span>]
<a name="l00571"></a>00571                     : @$GLOBALS[<span class="stringliteral">&#39;HTTP_SERVER_VARS&#39;</span>][<span class="stringliteral">&#39;SCRIPT_NAME&#39;</span>]);
<a name="l00572"></a>00572     }
<a name="l00573"></a>00573 
<a name="l00580"></a><a class="code" href="class_smarty.html#a12150893d5c5bab121e248f450e727fa">00580</a>     function <a class="code" href="class_smarty.html#a12150893d5c5bab121e248f450e727fa">assign</a>($tpl_var, $value = null)
<a name="l00581"></a>00581     {
<a name="l00582"></a>00582         <span class="keywordflow">if</span> (is_array($tpl_var)){
<a name="l00583"></a>00583             <span class="keywordflow">foreach</span> ($tpl_var as $key =&gt; $val) {
<a name="l00584"></a>00584                 <span class="keywordflow">if</span> ($key != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00585"></a>00585                     $this-&gt;_tpl_vars[$key] = $val;
<a name="l00586"></a>00586                 }
<a name="l00587"></a>00587             }
<a name="l00588"></a>00588         } <span class="keywordflow">else</span> {
<a name="l00589"></a>00589             <span class="keywordflow">if</span> ($tpl_var != <span class="stringliteral">&#39;&#39;</span>)
<a name="l00590"></a>00590                 $this-&gt;_tpl_vars[$tpl_var] = $value;
<a name="l00591"></a>00591         }
<a name="l00592"></a>00592     }
<a name="l00593"></a>00593 
<a name="l00600"></a><a class="code" href="class_smarty.html#aebc96e36370712d0c9e5896db76bd487">00600</a>     function <a class="code" href="class_smarty.html#aebc96e36370712d0c9e5896db76bd487">assign_by_ref</a>($tpl_var, &amp;$value)
<a name="l00601"></a>00601     {
<a name="l00602"></a>00602         <span class="keywordflow">if</span> ($tpl_var != <span class="stringliteral">&#39;&#39;</span>)
<a name="l00603"></a>00603             $this-&gt;_tpl_vars[$tpl_var] = &amp;$value;
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605 
<a name="l00612"></a><a class="code" href="class_smarty.html#a9870a97b08f66d2c1b19f3e54770cb29">00612</a>     function <a class="code" href="class_smarty.html#a9870a97b08f66d2c1b19f3e54770cb29">append</a>($tpl_var, $value=null, $merge=<span class="keyword">false</span>)
<a name="l00613"></a>00613     {
<a name="l00614"></a>00614         <span class="keywordflow">if</span> (is_array($tpl_var)) {
<a name="l00615"></a>00615             <span class="comment">// $tpl_var is an array, ignore $value</span>
<a name="l00616"></a>00616             <span class="keywordflow">foreach</span> ($tpl_var as $_key =&gt; $_val) {
<a name="l00617"></a>00617                 <span class="keywordflow">if</span> ($_key != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00618"></a>00618                     <span class="keywordflow">if</span>(!@is_array($this-&gt;_tpl_vars[$_key])) {
<a name="l00619"></a>00619                         settype($this-&gt;_tpl_vars[$_key],<span class="stringliteral">&#39;array&#39;</span>);
<a name="l00620"></a>00620                     }
<a name="l00621"></a>00621                     <span class="keywordflow">if</span>($merge &amp;&amp; is_array($_val)) {
<a name="l00622"></a>00622                         <span class="keywordflow">foreach</span>($_val as $_mkey =&gt; $_mval) {
<a name="l00623"></a>00623                             $this-&gt;_tpl_vars[$_key][$_mkey] = $_mval;
<a name="l00624"></a>00624                         }
<a name="l00625"></a>00625                     } <span class="keywordflow">else</span> {
<a name="l00626"></a>00626                         $this-&gt;_tpl_vars[$_key][] = $_val;
<a name="l00627"></a>00627                     }
<a name="l00628"></a>00628                 }
<a name="l00629"></a>00629             }
<a name="l00630"></a>00630         } <span class="keywordflow">else</span> {
<a name="l00631"></a>00631             <span class="keywordflow">if</span> ($tpl_var != <span class="stringliteral">&#39;&#39;</span> &amp;&amp; isset($value)) {
<a name="l00632"></a>00632                 <span class="keywordflow">if</span>(!@is_array($this-&gt;_tpl_vars[$tpl_var])) {
<a name="l00633"></a>00633                     settype($this-&gt;_tpl_vars[$tpl_var],<span class="stringliteral">&#39;array&#39;</span>);
<a name="l00634"></a>00634                 }
<a name="l00635"></a>00635                 <span class="keywordflow">if</span>($merge &amp;&amp; is_array($value)) {
<a name="l00636"></a>00636                     <span class="keywordflow">foreach</span>($value as $_mkey =&gt; $_mval) {
<a name="l00637"></a>00637                         $this-&gt;_tpl_vars[$tpl_var][$_mkey] = $_mval;
<a name="l00638"></a>00638                     }
<a name="l00639"></a>00639                 } <span class="keywordflow">else</span> {
<a name="l00640"></a>00640                     $this-&gt;_tpl_vars[$tpl_var][] = $value;
<a name="l00641"></a>00641                 }
<a name="l00642"></a>00642             }
<a name="l00643"></a>00643         }
<a name="l00644"></a>00644     }
<a name="l00645"></a>00645 
<a name="l00652"></a><a class="code" href="class_smarty.html#a1a744cb1e3d6473ddcd531412c54f07e">00652</a>     function <a class="code" href="class_smarty.html#a1a744cb1e3d6473ddcd531412c54f07e">append_by_ref</a>($tpl_var, &amp;$value, $merge=<span class="keyword">false</span>)
<a name="l00653"></a>00653     {
<a name="l00654"></a>00654         <span class="keywordflow">if</span> ($tpl_var != <span class="stringliteral">&#39;&#39;</span> &amp;&amp; isset($value)) {
<a name="l00655"></a>00655             <span class="keywordflow">if</span>(!@is_array($this-&gt;_tpl_vars[$tpl_var])) {
<a name="l00656"></a>00656              settype($this-&gt;_tpl_vars[$tpl_var],<span class="stringliteral">&#39;array&#39;</span>);
<a name="l00657"></a>00657             }
<a name="l00658"></a>00658             <span class="keywordflow">if</span> ($merge &amp;&amp; is_array($value)) {
<a name="l00659"></a>00659                 <span class="keywordflow">foreach</span>($value as $_key =&gt; $_val) {
<a name="l00660"></a>00660                     $this-&gt;_tpl_vars[$tpl_var][$_key] = &amp;$value[$_key];
<a name="l00661"></a>00661                 }
<a name="l00662"></a>00662             } <span class="keywordflow">else</span> {
<a name="l00663"></a>00663                 $this-&gt;_tpl_vars[$tpl_var][] = &amp;$value;
<a name="l00664"></a>00664             }
<a name="l00665"></a>00665         }
<a name="l00666"></a>00666     }
<a name="l00667"></a>00667 
<a name="l00668"></a>00668 
<a name="l00674"></a><a class="code" href="class_smarty.html#ad0188dcb261ac235ac70c141f2e6657e">00674</a>     function <a class="code" href="class_smarty.html#ad0188dcb261ac235ac70c141f2e6657e">clear_assign</a>($tpl_var)
<a name="l00675"></a>00675     {
<a name="l00676"></a>00676         <span class="keywordflow">if</span> (is_array($tpl_var))
<a name="l00677"></a>00677             <span class="keywordflow">foreach</span> ($tpl_var as $curr_var)
<a name="l00678"></a>00678                 unset($this-&gt;_tpl_vars[$curr_var]);
<a name="l00679"></a>00679         <span class="keywordflow">else</span>
<a name="l00680"></a>00680             unset($this-&gt;_tpl_vars[$tpl_var]);
<a name="l00681"></a>00681     }
<a name="l00682"></a>00682 
<a name="l00683"></a>00683 
<a name="l00690"></a><a class="code" href="class_smarty.html#aa933e1e9fb0b13f22101de4acbaf699c">00690</a>     function <a class="code" href="class_smarty.html#aa933e1e9fb0b13f22101de4acbaf699c">register_function</a>($function, $function_impl, $cacheable=<span class="keyword">true</span>, $cache_attrs=null)
<a name="l00691"></a>00691     {
<a name="l00692"></a>00692         $this-&gt;_plugins[<span class="stringliteral">&#39;function&#39;</span>][$function] =
<a name="l00693"></a>00693             array($function_impl, null, null, <span class="keyword">false</span>, $cacheable, $cache_attrs);
<a name="l00694"></a>00694 
<a name="l00695"></a>00695     }
<a name="l00696"></a>00696 
<a name="l00702"></a><a class="code" href="class_smarty.html#ae73d72302d6bcf8a0b284654b2ecef15">00702</a>     function <a class="code" href="class_smarty.html#ae73d72302d6bcf8a0b284654b2ecef15">unregister_function</a>($function)
<a name="l00703"></a>00703     {
<a name="l00704"></a>00704         unset($this-&gt;_plugins[<span class="stringliteral">&#39;function&#39;</span>][$function]);
<a name="l00705"></a>00705     }
<a name="l00706"></a>00706 
<a name="l00716"></a><a class="code" href="class_smarty.html#ad3e5b167a6483dbd669a736ee0000b9a">00716</a>     function <a class="code" href="class_smarty.html#ad3e5b167a6483dbd669a736ee0000b9a">register_object</a>($object, &amp;$object_impl, $allowed = array(), $smarty_args = <span class="keyword">true</span>, $block_methods = array())
<a name="l00717"></a>00717     {
<a name="l00718"></a>00718         settype($allowed, <span class="stringliteral">&#39;array&#39;</span>);
<a name="l00719"></a>00719         settype($smarty_args, <span class="stringliteral">&#39;boolean&#39;</span>);
<a name="l00720"></a>00720         $this-&gt;_reg_objects[$object] =
<a name="l00721"></a>00721             array(&amp;$object_impl, $allowed, $smarty_args, $block_methods);
<a name="l00722"></a>00722     }
<a name="l00723"></a>00723 
<a name="l00729"></a><a class="code" href="class_smarty.html#a49288d1943e174bcb8e924a4b449d050">00729</a>     function <a class="code" href="class_smarty.html#a49288d1943e174bcb8e924a4b449d050">unregister_object</a>($object)
<a name="l00730"></a>00730     {
<a name="l00731"></a>00731         unset($this-&gt;_reg_objects[$object]);
<a name="l00732"></a>00732     }
<a name="l00733"></a>00733 
<a name="l00734"></a>00734 
<a name="l00741"></a><a class="code" href="class_smarty.html#a2a6564c20eaeecdddd192885f9d5a794">00741</a>     function <a class="code" href="class_smarty.html#a2a6564c20eaeecdddd192885f9d5a794">register_block</a>($block, $block_impl, $cacheable=<span class="keyword">true</span>, $cache_attrs=null)
<a name="l00742"></a>00742     {
<a name="l00743"></a>00743         $this-&gt;_plugins[<span class="stringliteral">&#39;block&#39;</span>][$block] =
<a name="l00744"></a>00744             array($block_impl, null, null, <span class="keyword">false</span>, $cacheable, $cache_attrs);
<a name="l00745"></a>00745     }
<a name="l00746"></a>00746 
<a name="l00752"></a><a class="code" href="class_smarty.html#aa27d55eff4bc63b71da604fb1af362c9">00752</a>     function <a class="code" href="class_smarty.html#aa27d55eff4bc63b71da604fb1af362c9">unregister_block</a>($block)
<a name="l00753"></a>00753     {
<a name="l00754"></a>00754         unset($this-&gt;_plugins[<span class="stringliteral">&#39;block&#39;</span>][$block]);
<a name="l00755"></a>00755     }
<a name="l00756"></a>00756 
<a name="l00763"></a><a class="code" href="class_smarty.html#a4b141e0b9a699098e8986aca16e871ca">00763</a>     function <a class="code" href="class_smarty.html#a4b141e0b9a699098e8986aca16e871ca">register_compiler_function</a>($function, $function_impl, $cacheable=<span class="keyword">true</span>)
<a name="l00764"></a>00764     {
<a name="l00765"></a>00765         $this-&gt;_plugins[<span class="stringliteral">&#39;compiler&#39;</span>][$function] =
<a name="l00766"></a>00766             array($function_impl, null, null, <span class="keyword">false</span>, $cacheable);
<a name="l00767"></a>00767     }
<a name="l00768"></a>00768 
<a name="l00774"></a><a class="code" href="class_smarty.html#a85920043d6bf2ee895a1dc3fa2c464ca">00774</a>     function <a class="code" href="class_smarty.html#a85920043d6bf2ee895a1dc3fa2c464ca">unregister_compiler_function</a>($function)
<a name="l00775"></a>00775     {
<a name="l00776"></a>00776         unset($this-&gt;_plugins[<span class="stringliteral">&#39;compiler&#39;</span>][$function]);
<a name="l00777"></a>00777     }
<a name="l00778"></a>00778 
<a name="l00785"></a><a class="code" href="class_smarty.html#ac1483efc4d74e159c9ddb29b33fbfcc0">00785</a>     function <a class="code" href="class_smarty.html#ac1483efc4d74e159c9ddb29b33fbfcc0">register_modifier</a>($modifier, $modifier_impl)
<a name="l00786"></a>00786     {
<a name="l00787"></a>00787         $this-&gt;_plugins[<span class="stringliteral">&#39;modifier&#39;</span>][$modifier] =
<a name="l00788"></a>00788             array($modifier_impl, null, null, <span class="keyword">false</span>);
<a name="l00789"></a>00789     }
<a name="l00790"></a>00790 
<a name="l00796"></a><a class="code" href="class_smarty.html#aa0efdcad7fc5a36846e5e8bd8a455dd9">00796</a>     function <a class="code" href="class_smarty.html#aa0efdcad7fc5a36846e5e8bd8a455dd9">unregister_modifier</a>($modifier)
<a name="l00797"></a>00797     {
<a name="l00798"></a>00798         unset($this-&gt;_plugins[<span class="stringliteral">&#39;modifier&#39;</span>][$modifier]);
<a name="l00799"></a>00799     }
<a name="l00800"></a>00800 
<a name="l00807"></a><a class="code" href="class_smarty.html#a27683a72840c9401cde24eec57d493df">00807</a>     function <a class="code" href="class_smarty.html#a27683a72840c9401cde24eec57d493df">register_resource</a>($type, $functions)
<a name="l00808"></a>00808     {
<a name="l00809"></a>00809         <span class="keywordflow">if</span> (count($functions)==4) {
<a name="l00810"></a>00810             $this-&gt;_plugins[<span class="stringliteral">&#39;resource&#39;</span>][$type] =
<a name="l00811"></a>00811                 array($functions, <span class="keyword">false</span>);
<a name="l00812"></a>00812 
<a name="l00813"></a>00813         } elseif (count($functions)==5) {
<a name="l00814"></a>00814             $this-&gt;_plugins[<span class="stringliteral">&#39;resource&#39;</span>][$type] =
<a name="l00815"></a>00815                 array(array(array(&amp;$functions[0], $functions[1])
<a name="l00816"></a>00816                             ,array(&amp;$functions[0], $functions[2])
<a name="l00817"></a>00817                             ,array(&amp;$functions[0], $functions[3])
<a name="l00818"></a>00818                             ,array(&amp;$functions[0], $functions[4]))
<a name="l00819"></a>00819                       ,<span class="keyword">false</span>);
<a name="l00820"></a>00820 
<a name="l00821"></a>00821         } <span class="keywordflow">else</span> {
<a name="l00822"></a>00822             $this-&gt;<a class="code" href="class_smarty.html#aa4f8246510406271300bee84f9e1bce3">trigger_error</a>(<span class="stringliteral">&quot;malformed function-list for &#39;$type&#39; in register_resource&quot;</span>);
<a name="l00823"></a>00823 
<a name="l00824"></a>00824         }
<a name="l00825"></a>00825     }
<a name="l00826"></a>00826 
<a name="l00832"></a><a class="code" href="class_smarty.html#a509d4408ce20f6def85118984b81a32e">00832</a>     function <a class="code" href="class_smarty.html#a509d4408ce20f6def85118984b81a32e">unregister_resource</a>($type)
<a name="l00833"></a>00833     {
<a name="l00834"></a>00834         unset($this-&gt;_plugins[<span class="stringliteral">&#39;resource&#39;</span>][$type]);
<a name="l00835"></a>00835     }
<a name="l00836"></a>00836 
<a name="l00843"></a><a class="code" href="class_smarty.html#afdd4dead058273890d629d207f236239">00843</a>     function <a class="code" href="class_smarty.html#afdd4dead058273890d629d207f236239">register_prefilter</a>($function)
<a name="l00844"></a>00844     {
<a name="l00845"></a>00845     $_name = (is_array($function)) ? $function[1] : $function;
<a name="l00846"></a>00846         $this-&gt;_plugins[<span class="stringliteral">&#39;prefilter&#39;</span>][$_name]
<a name="l00847"></a>00847             = array($function, null, null, <span class="keyword">false</span>);
<a name="l00848"></a>00848     }
<a name="l00849"></a>00849 
<a name="l00855"></a><a class="code" href="class_smarty.html#a8208fd226842f48de08ce37305295d64">00855</a>     function <a class="code" href="class_smarty.html#a8208fd226842f48de08ce37305295d64">unregister_prefilter</a>($function)
<a name="l00856"></a>00856     {
<a name="l00857"></a>00857         unset($this-&gt;_plugins[<span class="stringliteral">&#39;prefilter&#39;</span>][$function]);
<a name="l00858"></a>00858     }
<a name="l00859"></a>00859 
<a name="l00866"></a><a class="code" href="class_smarty.html#a1eb31d2b852e5862a3d04284614d145b">00866</a>     function <a class="code" href="class_smarty.html#a1eb31d2b852e5862a3d04284614d145b">register_postfilter</a>($function)
<a name="l00867"></a>00867     {
<a name="l00868"></a>00868     $_name = (is_array($function)) ? $function[1] : $function;
<a name="l00869"></a>00869         $this-&gt;_plugins[<span class="stringliteral">&#39;postfilter&#39;</span>][$_name]
<a name="l00870"></a>00870             = array($function, null, null, <span class="keyword">false</span>);
<a name="l00871"></a>00871     }
<a name="l00872"></a>00872 
<a name="l00878"></a><a class="code" href="class_smarty.html#a36d917f9b975efc48682198c705eb244">00878</a>     function <a class="code" href="class_smarty.html#a36d917f9b975efc48682198c705eb244">unregister_postfilter</a>($function)
<a name="l00879"></a>00879     {
<a name="l00880"></a>00880         unset($this-&gt;_plugins[<span class="stringliteral">&#39;postfilter&#39;</span>][$function]);
<a name="l00881"></a>00881     }
<a name="l00882"></a>00882 
<a name="l00889"></a><a class="code" href="class_smarty.html#a54426aae9228293c47e05f4ceaacd516">00889</a>     function <a class="code" href="class_smarty.html#a54426aae9228293c47e05f4ceaacd516">register_outputfilter</a>($function)
<a name="l00890"></a>00890     {
<a name="l00891"></a>00891     $_name = (is_array($function)) ? $function[1] : $function;
<a name="l00892"></a>00892         $this-&gt;_plugins[<span class="stringliteral">&#39;outputfilter&#39;</span>][$_name]
<a name="l00893"></a>00893             = array($function, null, null, <span class="keyword">false</span>);
<a name="l00894"></a>00894     }
<a name="l00895"></a>00895 
<a name="l00901"></a><a class="code" href="class_smarty.html#a8d7427d8dc5f3d71aeb3385b9aad3700">00901</a>     function <a class="code" href="class_smarty.html#a8d7427d8dc5f3d71aeb3385b9aad3700">unregister_outputfilter</a>($function)
<a name="l00902"></a>00902     {
<a name="l00903"></a>00903         unset($this-&gt;_plugins[<span class="stringliteral">&#39;outputfilter&#39;</span>][$function]);
<a name="l00904"></a>00904     }
<a name="l00905"></a>00905 
<a name="l00912"></a><a class="code" href="class_smarty.html#ad642cca94486c492c56071fb32a3421c">00912</a>     function <a class="code" href="class_smarty.html#ad642cca94486c492c56071fb32a3421c">load_filter</a>($type, $name)
<a name="l00913"></a>00913     {
<a name="l00914"></a>00914         <span class="keywordflow">switch</span> ($type) {
<a name="l00915"></a>00915             <span class="keywordflow">case</span> <span class="stringliteral">&#39;output&#39;</span>:
<a name="l00916"></a>00916                 $_params = array(<span class="stringliteral">&#39;plugins&#39;</span> =&gt; array(array($type . <span class="stringliteral">&#39;filter&#39;</span>, $name, null, null, <span class="keyword">false</span>)));
<a name="l00917"></a>00917                 require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.load_plugins.php&#39;</span>);
<a name="l00918"></a>00918                 smarty_core_load_plugins($_params, $this);
<a name="l00919"></a>00919                 <span class="keywordflow">break</span>;
<a name="l00920"></a>00920 
<a name="l00921"></a>00921             <span class="keywordflow">case</span> <span class="stringliteral">&#39;pre&#39;</span>:
<a name="l00922"></a>00922             <span class="keywordflow">case</span> <span class="stringliteral">&#39;post&#39;</span>:
<a name="l00923"></a>00923                 <span class="keywordflow">if</span> (!isset($this-&gt;_plugins[$type . <span class="stringliteral">&#39;filter&#39;</span>][$name]))
<a name="l00924"></a>00924                     $this-&gt;_plugins[$type . <span class="stringliteral">&#39;filter&#39;</span>][$name] = <span class="keyword">false</span>;
<a name="l00925"></a>00925                 <span class="keywordflow">break</span>;
<a name="l00926"></a>00926         }
<a name="l00927"></a>00927     }
<a name="l00928"></a>00928 
<a name="l00938"></a><a class="code" href="class_smarty.html#a6b5412f074996dea92d89b32a13880d8">00938</a>     function <a class="code" href="class_smarty.html#a6b5412f074996dea92d89b32a13880d8">clear_cache</a>($tpl_file = null, $cache_id = null, $compile_id = null, $exp_time = null)
<a name="l00939"></a>00939     {
<a name="l00940"></a>00940 
<a name="l00941"></a>00941         <span class="keywordflow">if</span> (!isset($compile_id))
<a name="l00942"></a>00942             $compile_id = $this-&gt;compile_id;
<a name="l00943"></a>00943 
<a name="l00944"></a>00944         <span class="keywordflow">if</span> (!isset($tpl_file))
<a name="l00945"></a>00945             $compile_id = null;
<a name="l00946"></a>00946 
<a name="l00947"></a>00947         $_auto_id = $this-&gt;<a class="code" href="class_smarty.html#ae59d86c80bb3e74dbe8831f7a0a0687c">_get_auto_id</a>($cache_id, $compile_id);
<a name="l00948"></a>00948 
<a name="l00949"></a>00949         <span class="keywordflow">if</span> (!empty($this-&gt;cache_handler_func)) {
<a name="l00950"></a>00950             <span class="keywordflow">return</span> call_user_func_array($this-&gt;cache_handler_func,
<a name="l00951"></a>00951                                   array(<span class="stringliteral">&#39;clear&#39;</span>, &amp;$this, &amp;$dummy, $tpl_file, $cache_id, $compile_id, $exp_time));
<a name="l00952"></a>00952         } <span class="keywordflow">else</span> {
<a name="l00953"></a>00953             $_params = array(<span class="stringliteral">&#39;auto_base&#39;</span> =&gt; $this-&gt;cache_dir,
<a name="l00954"></a>00954                             <span class="stringliteral">&#39;auto_source&#39;</span> =&gt; $tpl_file,
<a name="l00955"></a>00955                             <span class="stringliteral">&#39;auto_id&#39;</span> =&gt; $_auto_id,
<a name="l00956"></a>00956                             <span class="stringliteral">&#39;exp_time&#39;</span> =&gt; $exp_time);
<a name="l00957"></a>00957             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.rm_auto.php&#39;</span>);
<a name="l00958"></a>00958             <span class="keywordflow">return</span> smarty_core_rm_auto($_params, $this);
<a name="l00959"></a>00959         }
<a name="l00960"></a>00960 
<a name="l00961"></a>00961     }
<a name="l00962"></a>00962 
<a name="l00963"></a>00963 
<a name="l00970"></a><a class="code" href="class_smarty.html#aaf1eab6e680746ae852abfc3814382fb">00970</a>     function <a class="code" href="class_smarty.html#aaf1eab6e680746ae852abfc3814382fb">clear_all_cache</a>($exp_time = null)
<a name="l00971"></a>00971     {
<a name="l00972"></a>00972         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_smarty.html#a6b5412f074996dea92d89b32a13880d8">clear_cache</a>(null, null, null, $exp_time);
<a name="l00973"></a>00973     }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975 
<a name="l00984"></a><a class="code" href="class_smarty.html#a70d12433755791c1383f394b6a41271d">00984</a>     function <a class="code" href="class_smarty.html#a70d12433755791c1383f394b6a41271d">is_cached</a>($tpl_file, $cache_id = null, $compile_id = null)
<a name="l00985"></a>00985     {
<a name="l00986"></a>00986         <span class="keywordflow">if</span> (!$this-&gt;caching)
<a name="l00987"></a>00987             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00988"></a>00988 
<a name="l00989"></a>00989         <span class="keywordflow">if</span> (!isset($compile_id))
<a name="l00990"></a>00990             $compile_id = $this-&gt;compile_id;
<a name="l00991"></a>00991 
<a name="l00992"></a>00992         $_params = array(
<a name="l00993"></a>00993             <span class="stringliteral">&#39;tpl_file&#39;</span> =&gt; $tpl_file,
<a name="l00994"></a>00994             <span class="stringliteral">&#39;cache_id&#39;</span> =&gt; $cache_id,
<a name="l00995"></a>00995             <span class="stringliteral">&#39;compile_id&#39;</span> =&gt; $compile_id
<a name="l00996"></a>00996         );
<a name="l00997"></a>00997         require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.read_cache_file.php&#39;</span>);
<a name="l00998"></a>00998         <span class="keywordflow">return</span> smarty_core_read_cache_file($_params, $this);
<a name="l00999"></a>00999     }
<a name="l01000"></a>01000 
<a name="l01001"></a>01001 
<a name="l01006"></a><a class="code" href="class_smarty.html#a47a576000a48c74fea66a209d7f0ac21">01006</a>     function <a class="code" href="class_smarty.html#a47a576000a48c74fea66a209d7f0ac21">clear_all_assign</a>()
<a name="l01007"></a>01007     {
<a name="l01008"></a>01008         $this-&gt;_tpl_vars = array();
<a name="l01009"></a>01009     }
<a name="l01010"></a>01010 
<a name="l01021"></a><a class="code" href="class_smarty.html#a71153cdee03c4dcb864488b59442b162">01021</a>     function <a class="code" href="class_smarty.html#a71153cdee03c4dcb864488b59442b162">clear_compiled_tpl</a>($tpl_file = null, $compile_id = null, $exp_time = null)
<a name="l01022"></a>01022     {
<a name="l01023"></a>01023         <span class="keywordflow">if</span> (!isset($compile_id)) {
<a name="l01024"></a>01024             $compile_id = $this-&gt;compile_id;
<a name="l01025"></a>01025         }
<a name="l01026"></a>01026         $_params = array(<span class="stringliteral">&#39;auto_base&#39;</span> =&gt; $this-&gt;compile_dir,
<a name="l01027"></a>01027                         <span class="stringliteral">&#39;auto_source&#39;</span> =&gt; $tpl_file,
<a name="l01028"></a>01028                         <span class="stringliteral">&#39;auto_id&#39;</span> =&gt; $compile_id,
<a name="l01029"></a>01029                         <span class="stringliteral">&#39;exp_time&#39;</span> =&gt; $exp_time,
<a name="l01030"></a>01030                         <span class="stringliteral">&#39;extensions&#39;</span> =&gt; array(<span class="stringliteral">&#39;.inc&#39;</span>, <span class="stringliteral">&#39;.php&#39;</span>));
<a name="l01031"></a>01031         require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.rm_auto.php&#39;</span>);
<a name="l01032"></a>01032         <span class="keywordflow">return</span> smarty_core_rm_auto($_params, $this);
<a name="l01033"></a>01033     }
<a name="l01034"></a>01034 
<a name="l01041"></a><a class="code" href="class_smarty.html#abfade212562dbeff89ccf453c02f5a1b">01041</a>     function <a class="code" href="class_smarty.html#abfade212562dbeff89ccf453c02f5a1b">template_exists</a>($tpl_file)
<a name="l01042"></a>01042     {
<a name="l01043"></a>01043         $_params = array(<span class="stringliteral">&#39;resource_name&#39;</span> =&gt; $tpl_file, <span class="stringliteral">&#39;quiet&#39;</span>=&gt;<span class="keyword">true</span>, <span class="stringliteral">&#39;get_source&#39;</span>=&gt;<span class="keyword">false</span>);
<a name="l01044"></a>01044         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_smarty.html#a0c3ac497dbe0e595d4f2a85f1168a219">_fetch_resource_info</a>($_params);
<a name="l01045"></a>01045     }
<a name="l01046"></a>01046 
<a name="l01054"></a><a class="code" href="class_smarty.html#a0c15a4f13f37eaca8a6e8ed91ad77b23">01054</a>     function &amp;<a class="code" href="class_smarty.html#a0c15a4f13f37eaca8a6e8ed91ad77b23">get_template_vars</a>($name=null)
<a name="l01055"></a>01055     {
<a name="l01056"></a>01056         <span class="keywordflow">if</span>(!isset($name)) {
<a name="l01057"></a>01057             <span class="keywordflow">return</span> $this-&gt;_tpl_vars;
<a name="l01058"></a>01058         }
<a name="l01059"></a>01059         <span class="keywordflow">if</span>(isset($this-&gt;_tpl_vars[$name])) {
<a name="l01060"></a>01060             <span class="keywordflow">return</span> $this-&gt;_tpl_vars[$name];
<a name="l01061"></a>01061         }
<a name="l01062"></a>01062     }
<a name="l01063"></a>01063 
<a name="l01071"></a><a class="code" href="class_smarty.html#a2382294d36d8e557c475d66350844bfb">01071</a>     function &amp;<a class="code" href="class_smarty.html#a2382294d36d8e557c475d66350844bfb">get_config_vars</a>($name=null)
<a name="l01072"></a>01072     {
<a name="l01073"></a>01073         <span class="keywordflow">if</span>(!isset($name) &amp;&amp; is_array($this-&gt;_config[0])) {
<a name="l01074"></a>01074             <span class="keywordflow">return</span> $this-&gt;_config[0][<span class="stringliteral">&#39;vars&#39;</span>];
<a name="l01075"></a>01075         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($this-&gt;_config[0][<span class="stringliteral">&#39;vars&#39;</span>][$name])) {
<a name="l01076"></a>01076             <span class="keywordflow">return</span> $this-&gt;_config[0][<span class="stringliteral">&#39;vars&#39;</span>][$name];
<a name="l01077"></a>01077         }
<a name="l01078"></a>01078     }
<a name="l01079"></a>01079 
<a name="l01086"></a><a class="code" href="class_smarty.html#aa4f8246510406271300bee84f9e1bce3">01086</a>     function <a class="code" href="class_smarty.html#aa4f8246510406271300bee84f9e1bce3">trigger_error</a>($error_msg, $error_type = E_USER_WARNING)
<a name="l01087"></a>01087     {
<a name="l01088"></a>01088         <a class="code" href="class_smarty.html#aa4f8246510406271300bee84f9e1bce3">trigger_error</a>(<span class="stringliteral">&quot;Smarty error: $error_msg&quot;</span>, $error_type);
<a name="l01089"></a>01089     }
<a name="l01090"></a>01090 
<a name="l01091"></a>01091 
<a name="l01099"></a><a class="code" href="class_smarty.html#a7318c22504478672906d321cba2bd713">01099</a>     function <a class="code" href="class_smarty.html#a7318c22504478672906d321cba2bd713">display</a>($resource_name, $cache_id = null, $compile_id = null)
<a name="l01100"></a>01100     {
<a name="l01101"></a>01101         $this-&gt;<a class="code" href="class_smarty.html#acd45e8177ae9f297026ee9a0732e976c">fetch</a>($resource_name, $cache_id, $compile_id, <span class="keyword">true</span>);
<a name="l01102"></a>01102     }
<a name="l01103"></a>01103 
<a name="l01112"></a><a class="code" href="class_smarty.html#acd45e8177ae9f297026ee9a0732e976c">01112</a>     function <a class="code" href="class_smarty.html#acd45e8177ae9f297026ee9a0732e976c">fetch</a>($resource_name, $cache_id = null, $compile_id = null, $display = <span class="keyword">false</span>)
<a name="l01113"></a>01113     {
<a name="l01114"></a>01114         <span class="keyword">static</span> $_cache_info = array();
<a name="l01115"></a>01115         
<a name="l01116"></a>01116         $_smarty_old_error_level = $this-&gt;debugging ? error_reporting() : error_reporting(isset($this-&gt;error_reporting)
<a name="l01117"></a>01117                ? $this-&gt;error_reporting : error_reporting() &amp; ~E_NOTICE);
<a name="l01118"></a>01118 
<a name="l01119"></a>01119         <span class="keywordflow">if</span> (!$this-&gt;debugging &amp;&amp; $this-&gt;debugging_ctrl == <span class="stringliteral">&#39;URL&#39;</span>) {
<a name="l01120"></a>01120             $_query_string = $this-&gt;request_use_auto_globals ? $_SERVER[<span class="stringliteral">&#39;QUERY_STRING&#39;</span>] : $GLOBALS[<span class="stringliteral">&#39;HTTP_SERVER_VARS&#39;</span>][<span class="stringliteral">&#39;QUERY_STRING&#39;</span>];
<a name="l01121"></a>01121             <span class="keywordflow">if</span> (@strstr($_query_string, $this-&gt;_smarty_debug_id)) {
<a name="l01122"></a>01122                 <span class="keywordflow">if</span> (@strstr($_query_string, $this-&gt;_smarty_debug_id . <span class="stringliteral">&#39;=on&#39;</span>)) {
<a name="l01123"></a>01123                     <span class="comment">// enable debugging for this browser session</span>
<a name="l01124"></a>01124                     @setcookie(<span class="stringliteral">&#39;SMARTY_DEBUG&#39;</span>, <span class="keyword">true</span>);
<a name="l01125"></a>01125                     $this-&gt;debugging = <span class="keyword">true</span>;
<a name="l01126"></a>01126                 } elseif (@strstr($_query_string, $this-&gt;_smarty_debug_id . <span class="stringliteral">&#39;=off&#39;</span>)) {
<a name="l01127"></a>01127                     <span class="comment">// disable debugging for this browser session</span>
<a name="l01128"></a>01128                     @setcookie(<span class="stringliteral">&#39;SMARTY_DEBUG&#39;</span>, <span class="keyword">false</span>);
<a name="l01129"></a>01129                     $this-&gt;debugging = <span class="keyword">false</span>;
<a name="l01130"></a>01130                 } <span class="keywordflow">else</span> {
<a name="l01131"></a>01131                     <span class="comment">// enable debugging for this page</span>
<a name="l01132"></a>01132                     $this-&gt;debugging = <span class="keyword">true</span>;
<a name="l01133"></a>01133                 }
<a name="l01134"></a>01134             } <span class="keywordflow">else</span> {
<a name="l01135"></a>01135                 $this-&gt;debugging = (bool)($this-&gt;request_use_auto_globals ? @$_COOKIE[<span class="stringliteral">&#39;SMARTY_DEBUG&#39;</span>] : @$GLOBALS[<span class="stringliteral">&#39;HTTP_COOKIE_VARS&#39;</span>][<span class="stringliteral">&#39;SMARTY_DEBUG&#39;</span>]);
<a name="l01136"></a>01136             }
<a name="l01137"></a>01137         }
<a name="l01138"></a>01138 
<a name="l01139"></a>01139         <span class="keywordflow">if</span> ($this-&gt;debugging) {
<a name="l01140"></a>01140             <span class="comment">// capture time for debugging info</span>
<a name="l01141"></a>01141             $_params = array();
<a name="l01142"></a>01142             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.get_microtime.php&#39;</span>);
<a name="l01143"></a>01143             $_debug_start_time = smarty_core_get_microtime($_params, $this);
<a name="l01144"></a>01144             $this-&gt;_smarty_debug_info[] = array(<span class="stringliteral">&#39;type&#39;</span>      =&gt; <span class="stringliteral">&#39;template&#39;</span>,
<a name="l01145"></a>01145                                                 <span class="stringliteral">&#39;filename&#39;</span>  =&gt; $resource_name,
<a name="l01146"></a>01146                                                 <span class="stringliteral">&#39;depth&#39;</span>     =&gt; 0);
<a name="l01147"></a>01147             $_included_tpls_idx = count($this-&gt;_smarty_debug_info) - 1;
<a name="l01148"></a>01148         }
<a name="l01149"></a>01149 
<a name="l01150"></a>01150         <span class="keywordflow">if</span> (!isset($compile_id)) {
<a name="l01151"></a>01151             $compile_id = $this-&gt;compile_id;
<a name="l01152"></a>01152         }
<a name="l01153"></a>01153 
<a name="l01154"></a>01154         $this-&gt;_compile_id = $compile_id;
<a name="l01155"></a>01155         $this-&gt;_inclusion_depth = 0;
<a name="l01156"></a>01156 
<a name="l01157"></a>01157         <span class="keywordflow">if</span> ($this-&gt;caching) {
<a name="l01158"></a>01158             <span class="comment">// save old cache_info, initialize cache_info</span>
<a name="l01159"></a>01159             array_push($_cache_info, $this-&gt;_cache_info);
<a name="l01160"></a>01160             $this-&gt;_cache_info = array();
<a name="l01161"></a>01161             $_params = array(
<a name="l01162"></a>01162                 <span class="stringliteral">&#39;tpl_file&#39;</span> =&gt; $resource_name,
<a name="l01163"></a>01163                 <span class="stringliteral">&#39;cache_id&#39;</span> =&gt; $cache_id,
<a name="l01164"></a>01164                 <span class="stringliteral">&#39;compile_id&#39;</span> =&gt; $compile_id,
<a name="l01165"></a>01165                 <span class="stringliteral">&#39;results&#39;</span> =&gt; null
<a name="l01166"></a>01166             );
<a name="l01167"></a>01167             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.read_cache_file.php&#39;</span>);
<a name="l01168"></a>01168             <span class="keywordflow">if</span> (smarty_core_read_cache_file($_params, $this)) {
<a name="l01169"></a>01169                 $_smarty_results = $_params[<span class="stringliteral">&#39;results&#39;</span>];
<a name="l01170"></a>01170                 <span class="keywordflow">if</span> (!empty($this-&gt;_cache_info[<span class="stringliteral">&#39;insert_tags&#39;</span>])) {
<a name="l01171"></a>01171                     $_params = array(<span class="stringliteral">&#39;plugins&#39;</span> =&gt; $this-&gt;_cache_info[<span class="stringliteral">&#39;insert_tags&#39;</span>]);
<a name="l01172"></a>01172                     require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.load_plugins.php&#39;</span>);
<a name="l01173"></a>01173                     smarty_core_load_plugins($_params, $this);
<a name="l01174"></a>01174                     $_params = array(<span class="stringliteral">&#39;results&#39;</span> =&gt; $_smarty_results);
<a name="l01175"></a>01175                     require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.process_cached_inserts.php&#39;</span>);
<a name="l01176"></a>01176                     $_smarty_results = smarty_core_process_cached_inserts($_params, $this);
<a name="l01177"></a>01177                 }
<a name="l01178"></a>01178                 <span class="keywordflow">if</span> (!empty($this-&gt;_cache_info[<span class="stringliteral">&#39;cache_serials&#39;</span>])) {
<a name="l01179"></a>01179                     $_params = array(<span class="stringliteral">&#39;results&#39;</span> =&gt; $_smarty_results);
<a name="l01180"></a>01180                     require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.process_compiled_include.php&#39;</span>);
<a name="l01181"></a>01181                     $_smarty_results = smarty_core_process_compiled_include($_params, $this);
<a name="l01182"></a>01182                 }
<a name="l01183"></a>01183 
<a name="l01184"></a>01184 
<a name="l01185"></a>01185                 <span class="keywordflow">if</span> ($display) {
<a name="l01186"></a>01186                     <span class="keywordflow">if</span> ($this-&gt;debugging)
<a name="l01187"></a>01187                     {
<a name="l01188"></a>01188                         <span class="comment">// capture time for debugging info</span>
<a name="l01189"></a>01189                         $_params = array();
<a name="l01190"></a>01190                         require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.get_microtime.php&#39;</span>);
<a name="l01191"></a>01191                         $this-&gt;_smarty_debug_info[$_included_tpls_idx][<span class="stringliteral">&#39;exec_time&#39;</span>] = smarty_core_get_microtime($_params, $this) - $_debug_start_time;
<a name="l01192"></a>01192                         require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.display_debug_console.php&#39;</span>);
<a name="l01193"></a>01193                         $_smarty_results .= smarty_core_display_debug_console($_params, $this);
<a name="l01194"></a>01194                     }
<a name="l01195"></a>01195                     <span class="keywordflow">if</span> ($this-&gt;cache_modified_check) {
<a name="l01196"></a>01196                         $_server_vars = ($this-&gt;request_use_auto_globals) ? $_SERVER : $GLOBALS[<span class="stringliteral">&#39;HTTP_SERVER_VARS&#39;</span>];
<a name="l01197"></a>01197                         $_last_modified_date = @substr($_server_vars[<span class="stringliteral">&#39;HTTP_IF_MODIFIED_SINCE&#39;</span>], 0, strpos($_server_vars[<span class="stringliteral">&#39;HTTP_IF_MODIFIED_SINCE&#39;</span>], <span class="stringliteral">&#39;GMT&#39;</span>) + 3);
<a name="l01198"></a>01198                         $_gmt_mtime = gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>, $this-&gt;_cache_info[<span class="stringliteral">&#39;timestamp&#39;</span>]).<span class="stringliteral">&#39; GMT&#39;</span>;
<a name="l01199"></a>01199                         <span class="keywordflow">if</span> (@count($this-&gt;_cache_info[<span class="stringliteral">&#39;insert_tags&#39;</span>]) == 0
<a name="l01200"></a>01200                             &amp;&amp; !$this-&gt;_cache_serials
<a name="l01201"></a>01201                             &amp;&amp; $_gmt_mtime == $_last_modified_date) {
<a name="l01202"></a>01202                             <span class="keywordflow">if</span> (php_sapi_name()==<span class="stringliteral">&#39;cgi&#39;</span>)
<a name="l01203"></a>01203                                 header(<span class="stringliteral">&#39;Status: 304 Not Modified&#39;</span>);
<a name="l01204"></a>01204                             <span class="keywordflow">else</span>
<a name="l01205"></a>01205                                 header(<span class="stringliteral">&#39;HTTP/1.1 304 Not Modified&#39;</span>);
<a name="l01206"></a>01206 
<a name="l01207"></a>01207                         } <span class="keywordflow">else</span> {
<a name="l01208"></a>01208                             header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.$_gmt_mtime);
<a name="l01209"></a>01209                             echo $_smarty_results;
<a name="l01210"></a>01210                         }
<a name="l01211"></a>01211                     } <span class="keywordflow">else</span> {
<a name="l01212"></a>01212                             echo $_smarty_results;
<a name="l01213"></a>01213                     }
<a name="l01214"></a>01214                     error_reporting($_smarty_old_error_level);
<a name="l01215"></a>01215                     <span class="comment">// restore initial cache_info</span>
<a name="l01216"></a>01216                     $this-&gt;_cache_info = array_pop($_cache_info);
<a name="l01217"></a>01217                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01218"></a>01218                 } <span class="keywordflow">else</span> {
<a name="l01219"></a>01219                     error_reporting($_smarty_old_error_level);
<a name="l01220"></a>01220                     <span class="comment">// restore initial cache_info</span>
<a name="l01221"></a>01221                     $this-&gt;_cache_info = array_pop($_cache_info);
<a name="l01222"></a>01222                     <span class="keywordflow">return</span> $_smarty_results;
<a name="l01223"></a>01223                 }
<a name="l01224"></a>01224             } <span class="keywordflow">else</span> {
<a name="l01225"></a>01225                 $this-&gt;_cache_info[<span class="stringliteral">&#39;template&#39;</span>][$resource_name] = <span class="keyword">true</span>;
<a name="l01226"></a>01226                 <span class="keywordflow">if</span> ($this-&gt;cache_modified_check &amp;&amp; $display) {
<a name="l01227"></a>01227                     header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>, time()).<span class="stringliteral">&#39; GMT&#39;</span>);
<a name="l01228"></a>01228                 }
<a name="l01229"></a>01229             }
<a name="l01230"></a>01230         }
<a name="l01231"></a>01231 
<a name="l01232"></a>01232         <span class="comment">// load filters that are marked as autoload</span>
<a name="l01233"></a>01233         <span class="keywordflow">if</span> (count($this-&gt;autoload_filters)) {
<a name="l01234"></a>01234             <span class="keywordflow">foreach</span> ($this-&gt;autoload_filters as $_filter_type =&gt; $_filters) {
<a name="l01235"></a>01235                 <span class="keywordflow">foreach</span> ($_filters as $_filter) {
<a name="l01236"></a>01236                     $this-&gt;<a class="code" href="class_smarty.html#ad642cca94486c492c56071fb32a3421c">load_filter</a>($_filter_type, $_filter);
<a name="l01237"></a>01237                 }
<a name="l01238"></a>01238             }
<a name="l01239"></a>01239         }
<a name="l01240"></a>01240 
<a name="l01241"></a>01241         $_smarty_compile_path = $this-&gt;<a class="code" href="class_smarty.html#a8a89232edb42318063b90fee5f608ec0">_get_compile_path</a>($resource_name);
<a name="l01242"></a>01242 
<a name="l01243"></a>01243         <span class="comment">// if we just need to display the results, don&#39;t perform output</span>
<a name="l01244"></a>01244         <span class="comment">// buffering - for speed</span>
<a name="l01245"></a>01245         $_cache_including = $this-&gt;_cache_including;
<a name="l01246"></a>01246         $this-&gt;_cache_including = <span class="keyword">false</span>;
<a name="l01247"></a>01247         <span class="keywordflow">if</span> ($display &amp;&amp; !$this-&gt;caching &amp;&amp; count($this-&gt;_plugins[<span class="stringliteral">&#39;outputfilter&#39;</span>]) == 0) {
<a name="l01248"></a>01248             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_smarty.html#a315bf9a64ca2baea77f8868804d847be">_is_compiled</a>($resource_name, $_smarty_compile_path)
<a name="l01249"></a>01249                     || $this-&gt;<a class="code" href="class_smarty.html#af0c22913faf4ec5e6d8674c643c69cc5">_compile_resource</a>($resource_name, $_smarty_compile_path))
<a name="l01250"></a>01250             {
<a name="l01251"></a>01251                 include($_smarty_compile_path);
<a name="l01252"></a>01252             }
<a name="l01253"></a>01253         } <span class="keywordflow">else</span> {
<a name="l01254"></a>01254             ob_start();
<a name="l01255"></a>01255             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_smarty.html#a315bf9a64ca2baea77f8868804d847be">_is_compiled</a>($resource_name, $_smarty_compile_path)
<a name="l01256"></a>01256                     || $this-&gt;<a class="code" href="class_smarty.html#af0c22913faf4ec5e6d8674c643c69cc5">_compile_resource</a>($resource_name, $_smarty_compile_path))
<a name="l01257"></a>01257             {
<a name="l01258"></a>01258                 include($_smarty_compile_path);
<a name="l01259"></a>01259             }
<a name="l01260"></a>01260             $_smarty_results = ob_get_contents();
<a name="l01261"></a>01261             ob_end_clean();
<a name="l01262"></a>01262 
<a name="l01263"></a>01263             <span class="keywordflow">foreach</span> ((array)$this-&gt;_plugins[<span class="stringliteral">&#39;outputfilter&#39;</span>] as $_output_filter) {
<a name="l01264"></a>01264                 $_smarty_results = call_user_func_array($_output_filter[0], array($_smarty_results, &amp;$this));
<a name="l01265"></a>01265             }
<a name="l01266"></a>01266         }
<a name="l01267"></a>01267 
<a name="l01268"></a>01268         <span class="keywordflow">if</span> ($this-&gt;caching) {
<a name="l01269"></a>01269             $_params = array(<span class="stringliteral">&#39;tpl_file&#39;</span> =&gt; $resource_name,
<a name="l01270"></a>01270                         <span class="stringliteral">&#39;cache_id&#39;</span> =&gt; $cache_id,
<a name="l01271"></a>01271                         <span class="stringliteral">&#39;compile_id&#39;</span> =&gt; $compile_id,
<a name="l01272"></a>01272                         <span class="stringliteral">&#39;results&#39;</span> =&gt; $_smarty_results);
<a name="l01273"></a>01273             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.write_cache_file.php&#39;</span>);
<a name="l01274"></a>01274             smarty_core_write_cache_file($_params, $this);
<a name="l01275"></a>01275             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.process_cached_inserts.php&#39;</span>);
<a name="l01276"></a>01276             $_smarty_results = smarty_core_process_cached_inserts($_params, $this);
<a name="l01277"></a>01277 
<a name="l01278"></a>01278             <span class="keywordflow">if</span> ($this-&gt;_cache_serials) {
<a name="l01279"></a>01279                 <span class="comment">// strip nocache-tags from output</span>
<a name="l01280"></a>01280                 $_smarty_results = preg_replace(<span class="stringliteral">&#39;!(\{/?nocache\:[0-9a-f]{32}#\d+\})!s&#39;</span>
<a name="l01281"></a>01281                                                 ,<span class="stringliteral">&#39;&#39;</span>
<a name="l01282"></a>01282                                                 ,$_smarty_results);
<a name="l01283"></a>01283             }
<a name="l01284"></a>01284             <span class="comment">// restore initial cache_info</span>
<a name="l01285"></a>01285             $this-&gt;_cache_info = array_pop($_cache_info);
<a name="l01286"></a>01286         }
<a name="l01287"></a>01287         $this-&gt;_cache_including = $_cache_including;
<a name="l01288"></a>01288 
<a name="l01289"></a>01289         <span class="keywordflow">if</span> ($display) {
<a name="l01290"></a>01290             <span class="keywordflow">if</span> (isset($_smarty_results)) { echo $_smarty_results; }
<a name="l01291"></a>01291             <span class="keywordflow">if</span> ($this-&gt;debugging) {
<a name="l01292"></a>01292                 <span class="comment">// capture time for debugging info</span>
<a name="l01293"></a>01293                 $_params = array();
<a name="l01294"></a>01294                 require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.get_microtime.php&#39;</span>);
<a name="l01295"></a>01295                 $this-&gt;_smarty_debug_info[$_included_tpls_idx][<span class="stringliteral">&#39;exec_time&#39;</span>] = (smarty_core_get_microtime($_params, $this) - $_debug_start_time);
<a name="l01296"></a>01296                 require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.display_debug_console.php&#39;</span>);
<a name="l01297"></a>01297                 echo smarty_core_display_debug_console($_params, $this);
<a name="l01298"></a>01298             }
<a name="l01299"></a>01299             error_reporting($_smarty_old_error_level);
<a name="l01300"></a>01300             <span class="keywordflow">return</span>;
<a name="l01301"></a>01301         } <span class="keywordflow">else</span> {
<a name="l01302"></a>01302             error_reporting($_smarty_old_error_level);
<a name="l01303"></a>01303             <span class="keywordflow">if</span> (isset($_smarty_results)) { <span class="keywordflow">return</span> $_smarty_results; }
<a name="l01304"></a>01304         }
<a name="l01305"></a>01305     }
<a name="l01306"></a>01306 
<a name="l01314"></a><a class="code" href="class_smarty.html#ad7beb1fcf478744bfcb4892884559c79">01314</a>     function <a class="code" href="class_smarty.html#ad7beb1fcf478744bfcb4892884559c79">config_load</a>($file, $section = null, $scope = <span class="stringliteral">&#39;global&#39;</span>)
<a name="l01315"></a>01315     {
<a name="l01316"></a>01316         require_once($this-&gt;<a class="code" href="class_smarty.html#aca3dac6a8fa20f5038e34af0c7f1c78b">_get_plugin_filepath</a>(<span class="stringliteral">&#39;function&#39;</span>, <span class="stringliteral">&#39;config_load&#39;</span>));
<a name="l01317"></a>01317         smarty_function_config_load(array(<span class="stringliteral">&#39;file&#39;</span> =&gt; $file, <span class="stringliteral">&#39;section&#39;</span> =&gt; $section, <span class="stringliteral">&#39;scope&#39;</span> =&gt; $scope), $this);
<a name="l01318"></a>01318     }
<a name="l01319"></a>01319 
<a name="l01326"></a><a class="code" href="class_smarty.html#ae922fb129fc263df7c3f4b83880b199d">01326</a>     function &amp;<a class="code" href="class_smarty.html#ae922fb129fc263df7c3f4b83880b199d">get_registered_object</a>($name) {
<a name="l01327"></a>01327         <span class="keywordflow">if</span> (!isset($this-&gt;_reg_objects[$name]))
<a name="l01328"></a>01328         $this-&gt;<a class="code" href="class_smarty.html#a069f86732ff92f739c488416e0958307">_trigger_fatal_error</a>(<span class="stringliteral">&quot;&#39;$name&#39; is not a registered object&quot;</span>);
<a name="l01329"></a>01329 
<a name="l01330"></a>01330         <span class="keywordflow">if</span> (!is_object($this-&gt;_reg_objects[$name][0]))
<a name="l01331"></a>01331         $this-&gt;<a class="code" href="class_smarty.html#a069f86732ff92f739c488416e0958307">_trigger_fatal_error</a>(<span class="stringliteral">&quot;registered &#39;$name&#39; is not an object&quot;</span>);
<a name="l01332"></a>01332 
<a name="l01333"></a>01333         <span class="keywordflow">return</span> $this-&gt;_reg_objects[$name][0];
<a name="l01334"></a>01334     }
<a name="l01335"></a>01335 
<a name="l01341"></a><a class="code" href="class_smarty.html#a889e401c09b8d2612e43a50cb2a7dc04">01341</a>     function <a class="code" href="class_smarty.html#a889e401c09b8d2612e43a50cb2a7dc04">clear_config</a>($var = null)
<a name="l01342"></a>01342     {
<a name="l01343"></a>01343         <span class="keywordflow">if</span>(!isset($var)) {
<a name="l01344"></a>01344             <span class="comment">// clear all values</span>
<a name="l01345"></a>01345             $this-&gt;_config = array(array(<span class="stringliteral">&#39;vars&#39;</span>  =&gt; array(),
<a name="l01346"></a>01346                                          <span class="stringliteral">&#39;files&#39;</span> =&gt; array()));
<a name="l01347"></a>01347         } <span class="keywordflow">else</span> {
<a name="l01348"></a>01348             unset($this-&gt;_config[0][<span class="stringliteral">&#39;vars&#39;</span>][$var]);
<a name="l01349"></a>01349         }
<a name="l01350"></a>01350     }
<a name="l01351"></a>01351 
<a name="l01359"></a><a class="code" href="class_smarty.html#aca3dac6a8fa20f5038e34af0c7f1c78b">01359</a>     function <a class="code" href="class_smarty.html#aca3dac6a8fa20f5038e34af0c7f1c78b">_get_plugin_filepath</a>($type, $name)
<a name="l01360"></a>01360     {
<a name="l01361"></a>01361         $_params = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; $type, <span class="stringliteral">&#39;name&#39;</span> =&gt; $name);
<a name="l01362"></a>01362         require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.assemble_plugin_filepath.php&#39;</span>);
<a name="l01363"></a>01363         <span class="keywordflow">return</span> smarty_core_assemble_plugin_filepath($_params, $this);
<a name="l01364"></a>01364     }
<a name="l01365"></a>01365 
<a name="l01373"></a><a class="code" href="class_smarty.html#a315bf9a64ca2baea77f8868804d847be">01373</a>     function <a class="code" href="class_smarty.html#a315bf9a64ca2baea77f8868804d847be">_is_compiled</a>($resource_name, $compile_path)
<a name="l01374"></a>01374     {
<a name="l01375"></a>01375         <span class="keywordflow">if</span> (!$this-&gt;force_compile &amp;&amp; file_exists($compile_path)) {
<a name="l01376"></a>01376             <span class="keywordflow">if</span> (!$this-&gt;compile_check) {
<a name="l01377"></a>01377                 <span class="comment">// no need to check compiled file</span>
<a name="l01378"></a>01378                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01379"></a>01379             } <span class="keywordflow">else</span> {
<a name="l01380"></a>01380                 <span class="comment">// get file source and timestamp</span>
<a name="l01381"></a>01381                 $_params = array(<span class="stringliteral">&#39;resource_name&#39;</span> =&gt; $resource_name, <span class="stringliteral">&#39;get_source&#39;</span>=&gt;<span class="keyword">false</span>);
<a name="l01382"></a>01382                 <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="class_smarty.html#a0c3ac497dbe0e595d4f2a85f1168a219">_fetch_resource_info</a>($_params)) {
<a name="l01383"></a>01383                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01384"></a>01384                 }
<a name="l01385"></a>01385                 <span class="keywordflow">if</span> ($_params[<span class="stringliteral">&#39;resource_timestamp&#39;</span>] &lt;= filemtime($compile_path)) {
<a name="l01386"></a>01386                     <span class="comment">// template not expired, no recompile</span>
<a name="l01387"></a>01387                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01388"></a>01388                 } <span class="keywordflow">else</span> {
<a name="l01389"></a>01389                     <span class="comment">// compile template</span>
<a name="l01390"></a>01390                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01391"></a>01391                 }
<a name="l01392"></a>01392             }
<a name="l01393"></a>01393         } <span class="keywordflow">else</span> {
<a name="l01394"></a>01394             <span class="comment">// compiled template does not exist, or forced compile</span>
<a name="l01395"></a>01395             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01396"></a>01396         }
<a name="l01397"></a>01397     }
<a name="l01398"></a>01398 
<a name="l01406"></a><a class="code" href="class_smarty.html#af0c22913faf4ec5e6d8674c643c69cc5">01406</a>     function <a class="code" href="class_smarty.html#af0c22913faf4ec5e6d8674c643c69cc5">_compile_resource</a>($resource_name, $compile_path)
<a name="l01407"></a>01407     {
<a name="l01408"></a>01408 
<a name="l01409"></a>01409         $_params = array(<span class="stringliteral">&#39;resource_name&#39;</span> =&gt; $resource_name);
<a name="l01410"></a>01410         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="class_smarty.html#a0c3ac497dbe0e595d4f2a85f1168a219">_fetch_resource_info</a>($_params)) {
<a name="l01411"></a>01411             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01412"></a>01412         }
<a name="l01413"></a>01413 
<a name="l01414"></a>01414         $_source_content = $_params[<span class="stringliteral">&#39;source_content&#39;</span>];
<a name="l01415"></a>01415         $_cache_include    = substr($compile_path, 0, -4).<span class="stringliteral">&#39;.inc&#39;</span>;
<a name="l01416"></a>01416 
<a name="l01417"></a>01417         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_smarty.html#a9df9b14069c359f1f45416acc6d7d81f">_compile_source</a>($resource_name, $_source_content, $_compiled_content, $_cache_include)) {
<a name="l01418"></a>01418             <span class="comment">// if a _cache_serial was set, we also have to write an include-file:</span>
<a name="l01419"></a>01419             <span class="keywordflow">if</span> ($this-&gt;_cache_include_info) {
<a name="l01420"></a>01420                 require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.write_compiled_include.php&#39;</span>);
<a name="l01421"></a>01421                 smarty_core_write_compiled_include(array_merge($this-&gt;_cache_include_info, array(<span class="stringliteral">&#39;compiled_content&#39;</span>=&gt;$_compiled_content, <span class="stringliteral">&#39;resource_name&#39;</span>=&gt;$resource_name)),  $this);
<a name="l01422"></a>01422             }
<a name="l01423"></a>01423 
<a name="l01424"></a>01424             $_params = array(<span class="stringliteral">&#39;compile_path&#39;</span>=&gt;$compile_path, <span class="stringliteral">&#39;compiled_content&#39;</span> =&gt; $_compiled_content);
<a name="l01425"></a>01425             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.write_compiled_resource.php&#39;</span>);
<a name="l01426"></a>01426             smarty_core_write_compiled_resource($_params, $this);
<a name="l01427"></a>01427 
<a name="l01428"></a>01428             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01429"></a>01429         } <span class="keywordflow">else</span> {
<a name="l01430"></a>01430             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01431"></a>01431         }
<a name="l01432"></a>01432 
<a name="l01433"></a>01433     }
<a name="l01434"></a>01434 
<a name="l01443"></a><a class="code" href="class_smarty.html#a9df9b14069c359f1f45416acc6d7d81f">01443</a>     function <a class="code" href="class_smarty.html#a9df9b14069c359f1f45416acc6d7d81f">_compile_source</a>($resource_name, &amp;$source_content, &amp;$compiled_content, $cache_include_path=null)
<a name="l01444"></a>01444     {
<a name="l01445"></a>01445         <span class="keywordflow">if</span> (file_exists(SMARTY_DIR . $this-&gt;compiler_file)) {
<a name="l01446"></a>01446             require_once(SMARTY_DIR . $this-&gt;compiler_file);
<a name="l01447"></a>01447         } <span class="keywordflow">else</span> {
<a name="l01448"></a>01448             <span class="comment">// use include_path</span>
<a name="l01449"></a>01449             require_once($this-&gt;compiler_file);
<a name="l01450"></a>01450         }
<a name="l01451"></a>01451 
<a name="l01452"></a>01452 
<a name="l01453"></a>01453         $smarty_compiler = <span class="keyword">new</span> $this-&gt;compiler_class;
<a name="l01454"></a>01454 
<a name="l01455"></a>01455         $smarty_compiler-&gt;template_dir      = $this-&gt;template_dir;
<a name="l01456"></a>01456         $smarty_compiler-&gt;compile_dir       = $this-&gt;compile_dir;
<a name="l01457"></a>01457         $smarty_compiler-&gt;plugins_dir       = $this-&gt;plugins_dir;
<a name="l01458"></a>01458         $smarty_compiler-&gt;config_dir        = $this-&gt;config_dir;
<a name="l01459"></a>01459         $smarty_compiler-&gt;force_compile     = $this-&gt;force_compile;
<a name="l01460"></a>01460         $smarty_compiler-&gt;caching           = $this-&gt;caching;
<a name="l01461"></a>01461         $smarty_compiler-&gt;php_handling      = $this-&gt;php_handling;
<a name="l01462"></a>01462         $smarty_compiler-&gt;left_delimiter    = $this-&gt;left_delimiter;
<a name="l01463"></a>01463         $smarty_compiler-&gt;right_delimiter   = $this-&gt;right_delimiter;
<a name="l01464"></a>01464         $smarty_compiler-&gt;_version          = $this-&gt;_version;
<a name="l01465"></a>01465         $smarty_compiler-&gt;security          = $this-&gt;security;
<a name="l01466"></a>01466         $smarty_compiler-&gt;secure_dir        = $this-&gt;secure_dir;
<a name="l01467"></a>01467         $smarty_compiler-&gt;security_settings = $this-&gt;security_settings;
<a name="l01468"></a>01468         $smarty_compiler-&gt;trusted_dir       = $this-&gt;trusted_dir;
<a name="l01469"></a>01469         $smarty_compiler-&gt;use_sub_dirs      = $this-&gt;use_sub_dirs;
<a name="l01470"></a>01470         $smarty_compiler-&gt;_reg_objects      = &amp;$this-&gt;_reg_objects;
<a name="l01471"></a>01471         $smarty_compiler-&gt;_plugins          = &amp;$this-&gt;_plugins;
<a name="l01472"></a>01472         $smarty_compiler-&gt;_tpl_vars         = &amp;$this-&gt;_tpl_vars;
<a name="l01473"></a>01473         $smarty_compiler-&gt;default_modifiers = $this-&gt;default_modifiers;
<a name="l01474"></a>01474         $smarty_compiler-&gt;compile_id        = $this-&gt;_compile_id;
<a name="l01475"></a>01475         $smarty_compiler-&gt;_config            = $this-&gt;_config;
<a name="l01476"></a>01476         $smarty_compiler-&gt;request_use_auto_globals  = $this-&gt;request_use_auto_globals;
<a name="l01477"></a>01477 
<a name="l01478"></a>01478         <span class="keywordflow">if</span> (isset($cache_include_path) &amp;&amp; isset($this-&gt;_cache_serials[$cache_include_path])) {
<a name="l01479"></a>01479             $smarty_compiler-&gt;_cache_serial = $this-&gt;_cache_serials[$cache_include_path];
<a name="l01480"></a>01480         }
<a name="l01481"></a>01481         $smarty_compiler-&gt;_cache_include = $cache_include_path;
<a name="l01482"></a>01482 
<a name="l01483"></a>01483 
<a name="l01484"></a>01484         $_results = $smarty_compiler-&gt;_compile_file($resource_name, $source_content, $compiled_content);
<a name="l01485"></a>01485 
<a name="l01486"></a>01486         <span class="keywordflow">if</span> ($smarty_compiler-&gt;_cache_serial) {
<a name="l01487"></a>01487             $this-&gt;_cache_include_info = array(
<a name="l01488"></a>01488                 <span class="stringliteral">&#39;cache_serial&#39;</span>=&gt;$smarty_compiler-&gt;_cache_serial
<a name="l01489"></a>01489                 ,<span class="stringliteral">&#39;plugins_code&#39;</span>=&gt;$smarty_compiler-&gt;_plugins_code
<a name="l01490"></a>01490                 ,<span class="stringliteral">&#39;include_file_path&#39;</span> =&gt; $cache_include_path);
<a name="l01491"></a>01491 
<a name="l01492"></a>01492         } <span class="keywordflow">else</span> {
<a name="l01493"></a>01493             $this-&gt;_cache_include_info = null;
<a name="l01494"></a>01494 
<a name="l01495"></a>01495         }
<a name="l01496"></a>01496 
<a name="l01497"></a>01497         <span class="keywordflow">return</span> $_results;
<a name="l01498"></a>01498     }
<a name="l01499"></a>01499 
<a name="l01506"></a><a class="code" href="class_smarty.html#a8a89232edb42318063b90fee5f608ec0">01506</a>     function <a class="code" href="class_smarty.html#a8a89232edb42318063b90fee5f608ec0">_get_compile_path</a>($resource_name)
<a name="l01507"></a>01507     {
<a name="l01508"></a>01508         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_smarty.html#a3e145fee368d93f35313bcb7018c1a76">_get_auto_filename</a>($this-&gt;compile_dir, $resource_name,
<a name="l01509"></a>01509                                          $this-&gt;_compile_id) . <span class="stringliteral">&#39;.php&#39;</span>;
<a name="l01510"></a>01510     }
<a name="l01511"></a>01511 
<a name="l01526"></a><a class="code" href="class_smarty.html#a0c3ac497dbe0e595d4f2a85f1168a219">01526</a>     function <a class="code" href="class_smarty.html#a0c3ac497dbe0e595d4f2a85f1168a219">_fetch_resource_info</a>(&amp;$params)
<a name="l01527"></a>01527     {
<a name="l01528"></a>01528         <span class="keywordflow">if</span>(!isset($params[<span class="stringliteral">&#39;get_source&#39;</span>])) { $params[<span class="stringliteral">&#39;get_source&#39;</span>] = <span class="keyword">true</span>; }
<a name="l01529"></a>01529         <span class="keywordflow">if</span>(!isset($params[<span class="stringliteral">&#39;quiet&#39;</span>])) { $params[<span class="stringliteral">&#39;quiet&#39;</span>] = <span class="keyword">false</span>; }
<a name="l01530"></a>01530 
<a name="l01531"></a>01531         $_return = <span class="keyword">false</span>;
<a name="l01532"></a>01532         $_params = array(<span class="stringliteral">&#39;resource_name&#39;</span> =&gt; $params[<span class="stringliteral">&#39;resource_name&#39;</span>]) ;
<a name="l01533"></a>01533         <span class="keywordflow">if</span> (isset($params[<span class="stringliteral">&#39;resource_base_path&#39;</span>]))
<a name="l01534"></a>01534             $_params[<span class="stringliteral">&#39;resource_base_path&#39;</span>] = $params[<span class="stringliteral">&#39;resource_base_path&#39;</span>];
<a name="l01535"></a>01535         <span class="keywordflow">else</span>
<a name="l01536"></a>01536             $_params[<span class="stringliteral">&#39;resource_base_path&#39;</span>] = $this-&gt;template_dir;
<a name="l01537"></a>01537 
<a name="l01538"></a>01538         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_smarty.html#a3fd3782e935db8cbac33da3d735df988">_parse_resource_name</a>($_params)) {
<a name="l01539"></a>01539             $_resource_type = $_params[<span class="stringliteral">&#39;resource_type&#39;</span>];
<a name="l01540"></a>01540             $_resource_name = $_params[<span class="stringliteral">&#39;resource_name&#39;</span>];
<a name="l01541"></a>01541             <span class="keywordflow">switch</span> ($_resource_type) {
<a name="l01542"></a>01542                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;file&#39;</span>:
<a name="l01543"></a>01543                     <span class="keywordflow">if</span> ($params[<span class="stringliteral">&#39;get_source&#39;</span>]) {
<a name="l01544"></a>01544                         $params[<span class="stringliteral">&#39;source_content&#39;</span>] = $this-&gt;<a class="code" href="class_smarty.html#a5aca16bc6189ba04a7f0a807ca08ff71">_read_file</a>($_resource_name);
<a name="l01545"></a>01545                     }
<a name="l01546"></a>01546                     $params[<span class="stringliteral">&#39;resource_timestamp&#39;</span>] = filemtime($_resource_name);
<a name="l01547"></a>01547                     $_return = is_file($_resource_name);
<a name="l01548"></a>01548                     <span class="keywordflow">break</span>;
<a name="l01549"></a>01549 
<a name="l01550"></a>01550                 <span class="keywordflow">default</span>:
<a name="l01551"></a>01551                     <span class="comment">// call resource functions to fetch the template source and timestamp</span>
<a name="l01552"></a>01552                     <span class="keywordflow">if</span> ($params[<span class="stringliteral">&#39;get_source&#39;</span>]) {
<a name="l01553"></a>01553                         $_source_return = isset($this-&gt;_plugins[<span class="stringliteral">&#39;resource&#39;</span>][$_resource_type]) &amp;&amp;
<a name="l01554"></a>01554                             call_user_func_array($this-&gt;_plugins[<span class="stringliteral">&#39;resource&#39;</span>][$_resource_type][0][0],
<a name="l01555"></a>01555                                                  array($_resource_name, &amp;$params[<span class="stringliteral">&#39;source_content&#39;</span>], &amp;$this));
<a name="l01556"></a>01556                     } <span class="keywordflow">else</span> {
<a name="l01557"></a>01557                         $_source_return = <span class="keyword">true</span>;
<a name="l01558"></a>01558                     }
<a name="l01559"></a>01559 
<a name="l01560"></a>01560                     $_timestamp_return = isset($this-&gt;_plugins[<span class="stringliteral">&#39;resource&#39;</span>][$_resource_type]) &amp;&amp;
<a name="l01561"></a>01561                         call_user_func_array($this-&gt;_plugins[<span class="stringliteral">&#39;resource&#39;</span>][$_resource_type][0][1],
<a name="l01562"></a>01562                                              array($_resource_name, &amp;$params[<span class="stringliteral">&#39;resource_timestamp&#39;</span>], &amp;$this));
<a name="l01563"></a>01563 
<a name="l01564"></a>01564                     $_return = $_source_return &amp;&amp; $_timestamp_return;
<a name="l01565"></a>01565                     <span class="keywordflow">break</span>;
<a name="l01566"></a>01566             }
<a name="l01567"></a>01567         }
<a name="l01568"></a>01568 
<a name="l01569"></a>01569         <span class="keywordflow">if</span> (!$_return) {
<a name="l01570"></a>01570             <span class="comment">// see if we can get a template with the default template handler</span>
<a name="l01571"></a>01571             <span class="keywordflow">if</span> (!empty($this-&gt;default_template_handler_func)) {
<a name="l01572"></a>01572                 <span class="keywordflow">if</span> (!is_callable($this-&gt;default_template_handler_func)) {
<a name="l01573"></a>01573                     $this-&gt;<a class="code" href="class_smarty.html#aa4f8246510406271300bee84f9e1bce3">trigger_error</a>(<span class="stringliteral">&quot;default template handler function \&quot;$this-&gt;default_template_handler_func\&quot; doesn&#39;t exist.&quot;</span>);
<a name="l01574"></a>01574                 } <span class="keywordflow">else</span> {
<a name="l01575"></a>01575                     $_return = call_user_func_array(
<a name="l01576"></a>01576                         $this-&gt;default_template_handler_func,
<a name="l01577"></a>01577                         array($_params[<span class="stringliteral">&#39;resource_type&#39;</span>], $_params[<span class="stringliteral">&#39;resource_name&#39;</span>], &amp;$params[<span class="stringliteral">&#39;source_content&#39;</span>], &amp;$params[<span class="stringliteral">&#39;resource_timestamp&#39;</span>], &amp;$this));
<a name="l01578"></a>01578                 }
<a name="l01579"></a>01579             }
<a name="l01580"></a>01580         }
<a name="l01581"></a>01581 
<a name="l01582"></a>01582         <span class="keywordflow">if</span> (!$_return) {
<a name="l01583"></a>01583             <span class="keywordflow">if</span> (!$params[<span class="stringliteral">&#39;quiet&#39;</span>]) {
<a name="l01584"></a>01584                 $this-&gt;<a class="code" href="class_smarty.html#aa4f8246510406271300bee84f9e1bce3">trigger_error</a>(<span class="stringliteral">&#39;unable to read resource: &quot;&#39;</span> . $params[<span class="stringliteral">&#39;resource_name&#39;</span>] . <span class="charliteral">&#39;&quot;&#39;</span>);
<a name="l01585"></a>01585             }
<a name="l01586"></a>01586         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($_return &amp;&amp; $this-&gt;security) {
<a name="l01587"></a>01587             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.is_secure.php&#39;</span>);
<a name="l01588"></a>01588             <span class="keywordflow">if</span> (!smarty_core_is_secure($_params, $this)) {
<a name="l01589"></a>01589                 <span class="keywordflow">if</span> (!$params[<span class="stringliteral">&#39;quiet&#39;</span>])
<a name="l01590"></a>01590                     $this-&gt;<a class="code" href="class_smarty.html#aa4f8246510406271300bee84f9e1bce3">trigger_error</a>(<span class="stringliteral">&#39;(secure mode) accessing &quot;&#39;</span> . $params[<span class="stringliteral">&#39;resource_name&#39;</span>] . <span class="stringliteral">&#39;&quot; is not allowed&#39;</span>);
<a name="l01591"></a>01591                 $params[<span class="stringliteral">&#39;source_content&#39;</span>] = null;
<a name="l01592"></a>01592                 $params[<span class="stringliteral">&#39;resource_timestamp&#39;</span>] = null;
<a name="l01593"></a>01593                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01594"></a>01594             }
<a name="l01595"></a>01595         }
<a name="l01596"></a>01596         <span class="keywordflow">return</span> $_return;
<a name="l01597"></a>01597     }
<a name="l01598"></a>01598 
<a name="l01599"></a>01599 
<a name="l01610"></a><a class="code" href="class_smarty.html#a3fd3782e935db8cbac33da3d735df988">01610</a>     function <a class="code" href="class_smarty.html#a3fd3782e935db8cbac33da3d735df988">_parse_resource_name</a>(&amp;$params)
<a name="l01611"></a>01611     {
<a name="l01612"></a>01612 
<a name="l01613"></a>01613         <span class="comment">// split tpl_path by the first colon</span>
<a name="l01614"></a>01614         $_resource_name_parts = explode(<span class="charliteral">&#39;:&#39;</span>, $params[<span class="stringliteral">&#39;resource_name&#39;</span>], 2);
<a name="l01615"></a>01615 
<a name="l01616"></a>01616         <span class="keywordflow">if</span> (count($_resource_name_parts) == 1) {
<a name="l01617"></a>01617             <span class="comment">// no resource type given</span>
<a name="l01618"></a>01618             $params[<span class="stringliteral">&#39;resource_type&#39;</span>] = $this-&gt;default_resource_type;
<a name="l01619"></a>01619             $params[<span class="stringliteral">&#39;resource_name&#39;</span>] = $_resource_name_parts[0];
<a name="l01620"></a>01620         } <span class="keywordflow">else</span> {
<a name="l01621"></a>01621             <span class="keywordflow">if</span>(strlen($_resource_name_parts[0]) == 1) {
<a name="l01622"></a>01622                 <span class="comment">// 1 char is not resource type, but part of filepath</span>
<a name="l01623"></a>01623                 $params[<span class="stringliteral">&#39;resource_type&#39;</span>] = $this-&gt;default_resource_type;
<a name="l01624"></a>01624                 $params[<span class="stringliteral">&#39;resource_name&#39;</span>] = $params[<span class="stringliteral">&#39;resource_name&#39;</span>];
<a name="l01625"></a>01625             } <span class="keywordflow">else</span> {
<a name="l01626"></a>01626                 $params[<span class="stringliteral">&#39;resource_type&#39;</span>] = $_resource_name_parts[0];
<a name="l01627"></a>01627                 $params[<span class="stringliteral">&#39;resource_name&#39;</span>] = $_resource_name_parts[1];
<a name="l01628"></a>01628             }
<a name="l01629"></a>01629         }
<a name="l01630"></a>01630 
<a name="l01631"></a>01631         <span class="keywordflow">if</span> ($params[<span class="stringliteral">&#39;resource_type&#39;</span>] == <span class="stringliteral">&#39;file&#39;</span>) {
<a name="l01632"></a>01632             <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&#39;/^([\/\\\\]|[a-zA-Z]:[\/\\\\])/&#39;</span>, $params[<span class="stringliteral">&#39;resource_name&#39;</span>])) {
<a name="l01633"></a>01633                 <span class="comment">// relative pathname to $params[&#39;resource_base_path&#39;]</span>
<a name="l01634"></a>01634                 <span class="comment">// use the first directory where the file is found</span>
<a name="l01635"></a>01635                 <span class="keywordflow">foreach</span> ((array)$params[<span class="stringliteral">&#39;resource_base_path&#39;</span>] as $_curr_path) {
<a name="l01636"></a>01636                     $_fullpath = $_curr_path . DIRECTORY_SEPARATOR . $params[<span class="stringliteral">&#39;resource_name&#39;</span>];
<a name="l01637"></a>01637                     <span class="keywordflow">if</span> (file_exists($_fullpath) &amp;&amp; is_file($_fullpath)) {
<a name="l01638"></a>01638                         $params[<span class="stringliteral">&#39;resource_name&#39;</span>] = $_fullpath;
<a name="l01639"></a>01639                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01640"></a>01640                     }
<a name="l01641"></a>01641                     <span class="comment">// didn&#39;t find the file, try include_path</span>
<a name="l01642"></a>01642                     $_params = array(<span class="stringliteral">&#39;file_path&#39;</span> =&gt; $_fullpath);
<a name="l01643"></a>01643                     require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.get_include_path.php&#39;</span>);
<a name="l01644"></a>01644                     <span class="keywordflow">if</span>(smarty_core_get_include_path($_params, $this)) {
<a name="l01645"></a>01645                         $params[<span class="stringliteral">&#39;resource_name&#39;</span>] = $_params[<span class="stringliteral">&#39;new_file_path&#39;</span>];
<a name="l01646"></a>01646                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01647"></a>01647                     }
<a name="l01648"></a>01648                 }
<a name="l01649"></a>01649                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01650"></a>01650             } <span class="keywordflow">else</span> {
<a name="l01651"></a>01651                 <span class="comment">/* absolute path */</span>
<a name="l01652"></a>01652                 <span class="keywordflow">return</span> file_exists($params[<span class="stringliteral">&#39;resource_name&#39;</span>]);
<a name="l01653"></a>01653             }
<a name="l01654"></a>01654         } elseif (empty($this-&gt;_plugins[<span class="stringliteral">&#39;resource&#39;</span>][$params[<span class="stringliteral">&#39;resource_type&#39;</span>]])) {
<a name="l01655"></a>01655             $_params = array(<span class="stringliteral">&#39;type&#39;</span> =&gt; $params[<span class="stringliteral">&#39;resource_type&#39;</span>]);
<a name="l01656"></a>01656             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.load_resource_plugin.php&#39;</span>);
<a name="l01657"></a>01657             smarty_core_load_resource_plugin($_params, $this);
<a name="l01658"></a>01658         }
<a name="l01659"></a>01659 
<a name="l01660"></a>01660         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01661"></a>01661     }
<a name="l01662"></a>01662 
<a name="l01663"></a>01663 
<a name="l01671"></a><a class="code" href="class_smarty.html#aadef62274bb4693faadaa1bfbfddae6f">01671</a>     function <a class="code" href="class_smarty.html#aadef62274bb4693faadaa1bfbfddae6f">_run_mod_handler</a>()
<a name="l01672"></a>01672     {
<a name="l01673"></a>01673         $_args = func_get_args();
<a name="l01674"></a>01674         list($_modifier_name, $_map_array) = array_splice($_args, 0, 2);
<a name="l01675"></a>01675         list($_func_name, $_tpl_file, $_tpl_line) =
<a name="l01676"></a>01676             $this-&gt;_plugins[<span class="stringliteral">&#39;modifier&#39;</span>][$_modifier_name];
<a name="l01677"></a>01677 
<a name="l01678"></a>01678         $_var = $_args[0];
<a name="l01679"></a>01679         <span class="keywordflow">foreach</span> ($_var as $_key =&gt; $_val) {
<a name="l01680"></a>01680             $_args[0] = $_val;
<a name="l01681"></a>01681             $_var[$_key] = call_user_func_array($_func_name, $_args);
<a name="l01682"></a>01682         }
<a name="l01683"></a>01683         <span class="keywordflow">return</span> $_var;
<a name="l01684"></a>01684     }
<a name="l01685"></a>01685 
<a name="l01692"></a><a class="code" href="class_smarty.html#a48d43e818f2469134f3202f1a4256917">01692</a>     function <a class="code" href="class_smarty.html#a48d43e818f2469134f3202f1a4256917">_dequote</a>($string)
<a name="l01693"></a>01693     {
<a name="l01694"></a>01694         <span class="keywordflow">if</span> (($string{0} == <span class="stringliteral">&quot;&#39;&quot;</span> || $string{0} == <span class="charliteral">&#39;&quot;&#39;</span>) &amp;&amp;
<a name="l01695"></a>01695             $string{strlen($string)-1} == $string{0})
<a name="l01696"></a>01696             <span class="keywordflow">return</span> substr($string, 1, -1);
<a name="l01697"></a>01697         <span class="keywordflow">else</span>
<a name="l01698"></a>01698             <span class="keywordflow">return</span> $string;
<a name="l01699"></a>01699     }
<a name="l01700"></a>01700 
<a name="l01701"></a>01701 
<a name="l01708"></a>01708     <span class="comment">/*</span>
<a name="l01709"></a>01709 <span class="comment">    function _read_file($filename)</span>
<a name="l01710"></a>01710 <span class="comment">    {</span>
<a name="l01711"></a>01711 <span class="comment">        if ( file_exists($filename) &amp;&amp; ($fd = @fopen($filename, &#39;rb&#39;)) ) {</span>
<a name="l01712"></a>01712 <span class="comment">            $contents = ($size = filesize($filename)) ? fread($fd, $size) : &#39;&#39;;</span>
<a name="l01713"></a>01713 <span class="comment">            fclose($fd);</span>
<a name="l01714"></a>01714 <span class="comment">            return $contents;</span>
<a name="l01715"></a>01715 <span class="comment">        } else {</span>
<a name="l01716"></a>01716 <span class="comment">            return false;</span>
<a name="l01717"></a>01717 <span class="comment">        }</span>
<a name="l01718"></a>01718 <span class="comment">    }*/</span>
<a name="l01719"></a>01719     
<a name="l01720"></a><a class="code" href="class_smarty.html#a5aca16bc6189ba04a7f0a807ca08ff71">01720</a>     function <a class="code" href="class_smarty.html#a5aca16bc6189ba04a7f0a807ca08ff71">_read_file</a>($filename)
<a name="l01721"></a>01721     {
<a name="l01722"></a>01722         $res = <span class="keyword">false</span>;
<a name="l01723"></a>01723         <span class="keywordflow">if</span> (file_exists($filename)) {
<a name="l01724"></a>01724             <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;ioncube_read_file&#39;</span>)) {
<a name="l01725"></a>01725                 $res = ioncube_read_file($filename);
<a name="l01726"></a>01726                 <span class="keywordflow">if</span> (is_int($res)) $res = <span class="keyword">false</span>;
<a name="l01727"></a>01727             }
<a name="l01728"></a>01728             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ($fd = @fopen($filename, <span class="stringliteral">&#39;rb&#39;</span>)) ) {
<a name="l01729"></a>01729                 $res = ($size = filesize($filename)) ? fread($fd, $size) : <span class="stringliteral">&#39;&#39;</span>;
<a name="l01730"></a>01730                 fclose($fd);
<a name="l01731"></a>01731             }
<a name="l01732"></a>01732         }
<a name="l01733"></a>01733 
<a name="l01734"></a>01734         <span class="keywordflow">return</span> $res;
<a name="l01735"></a>01735     }    
<a name="l01736"></a>01736 
<a name="l01747"></a><a class="code" href="class_smarty.html#a3e145fee368d93f35313bcb7018c1a76">01747</a>     function <a class="code" href="class_smarty.html#a3e145fee368d93f35313bcb7018c1a76">_get_auto_filename</a>($auto_base, $auto_source = null, $auto_id = null)
<a name="l01748"></a>01748     {
<a name="l01749"></a>01749         $_compile_dir_sep =  $this-&gt;use_sub_dirs ? DIRECTORY_SEPARATOR : <span class="charliteral">&#39;^&#39;</span>;
<a name="l01750"></a>01750         $_return = $auto_base . DIRECTORY_SEPARATOR;
<a name="l01751"></a>01751 
<a name="l01752"></a>01752         <span class="keywordflow">if</span>(isset($auto_id)) {
<a name="l01753"></a>01753             <span class="comment">// make auto_id safe for directory names</span>
<a name="l01754"></a>01754             $auto_id = str_replace(<span class="stringliteral">&#39;%7C&#39;</span>,$_compile_dir_sep,(urlencode($auto_id)));
<a name="l01755"></a>01755             <span class="comment">// split into separate directories</span>
<a name="l01756"></a>01756             $_return .= $auto_id . $_compile_dir_sep;
<a name="l01757"></a>01757         }
<a name="l01758"></a>01758 
<a name="l01759"></a>01759         <span class="keywordflow">if</span>(isset($auto_source)) {
<a name="l01760"></a>01760             <span class="comment">// make source name safe for filename</span>
<a name="l01761"></a>01761             $_filename = urlencode(basename($auto_source));
<a name="l01762"></a>01762             $_crc32 = sprintf(<span class="stringliteral">&#39;%08X&#39;</span>, crc32($auto_source));
<a name="l01763"></a>01763             <span class="comment">// prepend %% to avoid name conflicts with</span>
<a name="l01764"></a>01764             <span class="comment">// with $params[&#39;auto_id&#39;] names</span>
<a name="l01765"></a>01765             $_crc32 = substr($_crc32, 0, 2) . $_compile_dir_sep .
<a name="l01766"></a>01766                       substr($_crc32, 0, 3) . $_compile_dir_sep . $_crc32;
<a name="l01767"></a>01767             $_return .= <span class="stringliteral">&#39;%%&#39;</span> . $_crc32 . <span class="stringliteral">&#39;%%&#39;</span> . $_filename;
<a name="l01768"></a>01768         }
<a name="l01769"></a>01769 
<a name="l01770"></a>01770         <span class="keywordflow">return</span> $_return;
<a name="l01771"></a>01771     }
<a name="l01772"></a>01772 
<a name="l01779"></a><a class="code" href="class_smarty.html#ab5aba685ce31a74ce598d75f623361dd">01779</a>     function <a class="code" href="class_smarty.html#ab5aba685ce31a74ce598d75f623361dd">_unlink</a>($resource, $exp_time = null)
<a name="l01780"></a>01780     {
<a name="l01781"></a>01781         <span class="keywordflow">if</span>(isset($exp_time)) {
<a name="l01782"></a>01782             <span class="keywordflow">if</span>(time() - @filemtime($resource) &gt;= $exp_time) {
<a name="l01783"></a>01783                 <span class="keywordflow">return</span> @unlink($resource);
<a name="l01784"></a>01784             }
<a name="l01785"></a>01785         } <span class="keywordflow">else</span> {
<a name="l01786"></a>01786             <span class="keywordflow">return</span> @unlink($resource);
<a name="l01787"></a>01787         }
<a name="l01788"></a>01788     }
<a name="l01789"></a>01789 
<a name="l01797"></a><a class="code" href="class_smarty.html#ae59d86c80bb3e74dbe8831f7a0a0687c">01797</a>     function <a class="code" href="class_smarty.html#ae59d86c80bb3e74dbe8831f7a0a0687c">_get_auto_id</a>($cache_id=null, $compile_id=null) {
<a name="l01798"></a>01798     <span class="keywordflow">if</span> (isset($cache_id))
<a name="l01799"></a>01799         <span class="keywordflow">return</span> (isset($compile_id)) ? $cache_id . <span class="charliteral">&#39;|&#39;</span> . $compile_id  : $cache_id;
<a name="l01800"></a>01800     elseif(isset($compile_id))
<a name="l01801"></a>01801         <span class="keywordflow">return</span> $compile_id;
<a name="l01802"></a>01802     <span class="keywordflow">else</span>
<a name="l01803"></a>01803         <span class="keywordflow">return</span> null;
<a name="l01804"></a>01804     }
<a name="l01805"></a>01805 
<a name="l01816"></a><a class="code" href="class_smarty.html#a069f86732ff92f739c488416e0958307">01816</a>     function <a class="code" href="class_smarty.html#a069f86732ff92f739c488416e0958307">_trigger_fatal_error</a>($error_msg, $tpl_file = null, $tpl_line = null,
<a name="l01817"></a>01817             $file = null, $line = null, $error_type = E_USER_ERROR)
<a name="l01818"></a>01818     {
<a name="l01819"></a>01819         <span class="keywordflow">if</span>(isset($file) &amp;&amp; isset($line)) {
<a name="l01820"></a>01820             $info = <span class="stringliteral">&#39; (&#39;</span>.basename($file).<span class="stringliteral">&quot;, line $line)&quot;</span>;
<a name="l01821"></a>01821         } <span class="keywordflow">else</span> {
<a name="l01822"></a>01822             $info = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01823"></a>01823         }
<a name="l01824"></a>01824         <span class="keywordflow">if</span> (isset($tpl_line) &amp;&amp; isset($tpl_file)) {
<a name="l01825"></a>01825             $this-&gt;<a class="code" href="class_smarty.html#aa4f8246510406271300bee84f9e1bce3">trigger_error</a>(<span class="stringliteral">&#39;[in &#39;</span> . $tpl_file . <span class="stringliteral">&#39; line &#39;</span> . $tpl_line . <span class="stringliteral">&quot;]: $error_msg$info&quot;</span>, $error_type);
<a name="l01826"></a>01826         } <span class="keywordflow">else</span> {
<a name="l01827"></a>01827             $this-&gt;<a class="code" href="class_smarty.html#aa4f8246510406271300bee84f9e1bce3">trigger_error</a>($error_msg . $info, $error_type);
<a name="l01828"></a>01828         }
<a name="l01829"></a>01829     }
<a name="l01830"></a>01830 
<a name="l01831"></a>01831 
<a name="l01836"></a><a class="code" href="class_smarty.html#a7ee77f3dd4e8b79f3f070b20e890af00">01836</a>     function <a class="code" href="class_smarty.html#a7ee77f3dd4e8b79f3f070b20e890af00">_process_compiled_include_callback</a>($match) {
<a name="l01837"></a>01837         $_func = <span class="stringliteral">&#39;_smarty_tplfunc_&#39;</span>.$match[2].<span class="charliteral">&#39;_&#39;</span>.$match[3];
<a name="l01838"></a>01838         ob_start();
<a name="l01839"></a>01839         $_func($this);
<a name="l01840"></a>01840         $_ret = ob_get_contents();
<a name="l01841"></a>01841         ob_end_clean();
<a name="l01842"></a>01842         <span class="keywordflow">return</span> $_ret;
<a name="l01843"></a>01843     }
<a name="l01844"></a>01844 
<a name="l01845"></a>01845 
<a name="l01853"></a>01853     <span class="comment">// $_smarty_include_tpl_file, $_smarty_include_vars</span>
<a name="l01854"></a>01854 
<a name="l01855"></a><a class="code" href="class_smarty.html#a2636e88dc9c8c3876aa63720c7d6ac25">01855</a>     function <a class="code" href="class_smarty.html#a2636e88dc9c8c3876aa63720c7d6ac25">_smarty_include</a>($params)
<a name="l01856"></a>01856     {
<a name="l01857"></a>01857         <span class="keywordflow">if</span> ($this-&gt;debugging) {
<a name="l01858"></a>01858             $_params = array();
<a name="l01859"></a>01859             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.get_microtime.php&#39;</span>);
<a name="l01860"></a>01860             $debug_start_time = smarty_core_get_microtime($_params, $this);
<a name="l01861"></a>01861             $this-&gt;_smarty_debug_info[] = array(<span class="stringliteral">&#39;type&#39;</span>      =&gt; <span class="stringliteral">&#39;template&#39;</span>,
<a name="l01862"></a>01862                                                   <span class="stringliteral">&#39;filename&#39;</span>  =&gt; $params[<span class="stringliteral">&#39;smarty_include_tpl_file&#39;</span>],
<a name="l01863"></a>01863                                                   <span class="stringliteral">&#39;depth&#39;</span>     =&gt; ++$this-&gt;_inclusion_depth);
<a name="l01864"></a>01864             $included_tpls_idx = count($this-&gt;_smarty_debug_info) - 1;
<a name="l01865"></a>01865         }
<a name="l01866"></a>01866 
<a name="l01867"></a>01867         $this-&gt;_tpl_vars = array_merge($this-&gt;_tpl_vars, $params[<span class="stringliteral">&#39;smarty_include_vars&#39;</span>]);
<a name="l01868"></a>01868 
<a name="l01869"></a>01869         <span class="comment">// config vars are treated as local, so push a copy of the</span>
<a name="l01870"></a>01870         <span class="comment">// current ones onto the front of the stack</span>
<a name="l01871"></a>01871         array_unshift($this-&gt;_config, $this-&gt;_config[0]);
<a name="l01872"></a>01872 
<a name="l01873"></a>01873         $_smarty_compile_path = $this-&gt;<a class="code" href="class_smarty.html#a8a89232edb42318063b90fee5f608ec0">_get_compile_path</a>($params[<span class="stringliteral">&#39;smarty_include_tpl_file&#39;</span>]);
<a name="l01874"></a>01874 
<a name="l01875"></a>01875 
<a name="l01876"></a>01876         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_smarty.html#a315bf9a64ca2baea77f8868804d847be">_is_compiled</a>($params[<span class="stringliteral">&#39;smarty_include_tpl_file&#39;</span>], $_smarty_compile_path)
<a name="l01877"></a>01877             || $this-&gt;<a class="code" href="class_smarty.html#af0c22913faf4ec5e6d8674c643c69cc5">_compile_resource</a>($params[<span class="stringliteral">&#39;smarty_include_tpl_file&#39;</span>], $_smarty_compile_path))
<a name="l01878"></a>01878         {
<a name="l01879"></a>01879             include($_smarty_compile_path);
<a name="l01880"></a>01880         }
<a name="l01881"></a>01881 
<a name="l01882"></a>01882         <span class="comment">// pop the local vars off the front of the stack</span>
<a name="l01883"></a>01883         array_shift($this-&gt;_config);
<a name="l01884"></a>01884 
<a name="l01885"></a>01885         $this-&gt;_inclusion_depth--;
<a name="l01886"></a>01886 
<a name="l01887"></a>01887         <span class="keywordflow">if</span> ($this-&gt;debugging) {
<a name="l01888"></a>01888             <span class="comment">// capture time for debugging info</span>
<a name="l01889"></a>01889             $_params = array();
<a name="l01890"></a>01890             require_once(SMARTY_CORE_DIR . <span class="stringliteral">&#39;core.get_microtime.php&#39;</span>);
<a name="l01891"></a>01891             $this-&gt;_smarty_debug_info[$included_tpls_idx][<span class="stringliteral">&#39;exec_time&#39;</span>] = smarty_core_get_microtime($_params, $this) - $debug_start_time;
<a name="l01892"></a>01892         }
<a name="l01893"></a>01893 
<a name="l01894"></a>01894         <span class="keywordflow">if</span> ($this-&gt;caching) {
<a name="l01895"></a>01895             $this-&gt;_cache_info[<span class="stringliteral">&#39;template&#39;</span>][$params[<span class="stringliteral">&#39;smarty_include_tpl_file&#39;</span>]] = <span class="keyword">true</span>;
<a name="l01896"></a>01896         }
<a name="l01897"></a>01897     }
<a name="l01898"></a>01898 
<a name="l01899"></a>01899 
<a name="l01905"></a><a class="code" href="class_smarty.html#accf8fe1e81964b9abae199964a229c5b">01905</a>     function &amp;<a class="code" href="class_smarty.html#accf8fe1e81964b9abae199964a229c5b">_smarty_cache_attrs</a>($cache_serial, $count) {
<a name="l01906"></a>01906         $_cache_attrs =&amp; $this-&gt;_cache_info[<span class="stringliteral">&#39;cache_attrs&#39;</span>][$cache_serial][$count];
<a name="l01907"></a>01907 
<a name="l01908"></a>01908         <span class="keywordflow">if</span> ($this-&gt;_cache_including) {
<a name="l01909"></a>01909             <span class="comment">/* return next set of cache_attrs */</span>
<a name="l01910"></a>01910             $_return = current($_cache_attrs);
<a name="l01911"></a>01911             next($_cache_attrs);
<a name="l01912"></a>01912             <span class="keywordflow">return</span> $_return;
<a name="l01913"></a>01913 
<a name="l01914"></a>01914         } <span class="keywordflow">else</span> {
<a name="l01915"></a>01915             <span class="comment">/* add a reference to a new set of cache_attrs */</span>
<a name="l01916"></a>01916             $_cache_attrs[] = array();
<a name="l01917"></a>01917             <span class="keywordflow">return</span> $_cache_attrs[count($_cache_attrs)-1];
<a name="l01918"></a>01918 
<a name="l01919"></a>01919         }
<a name="l01920"></a>01920 
<a name="l01921"></a>01921     }
<a name="l01922"></a>01922 
<a name="l01923"></a>01923 
<a name="l01928"></a><a class="code" href="class_smarty.html#a9e571fe5ba948fca1a9b31ac69e24546">01928</a>     function <a class="code" href="class_smarty.html#a9e571fe5ba948fca1a9b31ac69e24546">_include</a>($filename, $once=<span class="keyword">false</span>, $params=null)
<a name="l01929"></a>01929     {
<a name="l01930"></a>01930         <span class="keywordflow">if</span> ($once) {
<a name="l01931"></a>01931             <span class="keywordflow">return</span> include_once($filename);
<a name="l01932"></a>01932         } <span class="keywordflow">else</span> {
<a name="l01933"></a>01933             <span class="keywordflow">return</span> include($filename);
<a name="l01934"></a>01934         }
<a name="l01935"></a>01935     }
<a name="l01936"></a>01936 
<a name="l01937"></a>01937 
<a name="l01942"></a><a class="code" href="class_smarty.html#a9b47d457e9e3d4d47a696d77dfa43e7f">01942</a>     function <a class="code" href="class_smarty.html#a9b47d457e9e3d4d47a696d77dfa43e7f">_eval</a>($code, $params=null)
<a name="l01943"></a>01943     {
<a name="l01944"></a>01944         <span class="keywordflow">return</span> eval($code);
<a name="l01945"></a>01945     }
<a name="l01948"></a>01948 }
<a name="l01949"></a>01949 
<a name="l01950"></a>01950 <span class="comment">/* vim: set expandtab: */</span>
<a name="l01951"></a>01951 
<a name="l01952"></a>01952 ?&gt;
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Apr 19 2012 17:01:16 for openbiz by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
