<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>openbiz: E:/E/GEAMP/www/openbiz/openbiz/others/Zend/Queue.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>E:/E/GEAMP/www/openbiz/openbiz/others/Zend/Queue.php</h1>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00030"></a><a class="code" href="class_zend___queue.html">00030</a> <span class="keyword">class </span><a class="code" href="class_zend___queue.html">Zend_Queue</a> <span class="keyword">implements</span> Countable
<a name="l00031"></a>00031 {
<a name="l00035"></a><a class="code" href="class_zend___queue.html#ae001ea02b5d8fb1d82b0f9a0e891774e">00035</a>     <span class="keyword">const</span> <a class="code" href="class_zend___queue.html#ae001ea02b5d8fb1d82b0f9a0e891774e">TIMEOUT</a> = <span class="stringliteral">&#39;timeout&#39;</span>;
<a name="l00036"></a>00036 
<a name="l00040"></a><a class="code" href="class_zend___queue.html#a5c1d21a821ffa40b6a58b7a34d8a3874">00040</a>     <span class="keyword">const</span> <a class="code" href="class_zend___queue.html#a5c1d21a821ffa40b6a58b7a34d8a3874">VISIBILITY_TIMEOUT</a> = 30;
<a name="l00041"></a>00041 
<a name="l00045"></a><a class="code" href="class_zend___queue.html#a244352f035b82b20b0efa506167fd862">00045</a>     <span class="keyword">const</span> <a class="code" href="class_zend___queue.html#a244352f035b82b20b0efa506167fd862">NAME</a> = <span class="stringliteral">&#39;name&#39;</span>;
<a name="l00046"></a>00046 
<a name="l00050"></a>00050     <span class="keyword">protected</span> $_adapter = null;
<a name="l00051"></a>00051 
<a name="l00057"></a>00057     <span class="keyword">protected</span> $_options = array();
<a name="l00058"></a>00058 
<a name="l00064"></a>00064     <span class="keyword">protected</span> $_messageClass = <span class="stringliteral">&#39;Zend_Queue_Message&#39;</span>;
<a name="l00065"></a>00065 
<a name="l00071"></a>00071     <span class="keyword">protected</span> $_messageSetClass = <span class="stringliteral">&#39;Zend_Queue_Message_Iterator&#39;</span>;
<a name="l00072"></a>00072 
<a name="l00076"></a>00076     <span class="keyword">protected</span> $_logger = null;
<a name="l00077"></a>00077 
<a name="l00092"></a><a class="code" href="class_zend___queue.html#a6506f1965801d61c2427907712f1d77c">00092</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a6506f1965801d61c2427907712f1d77c">__construct</a>($spec, $options = array())
<a name="l00093"></a>00093     {
<a name="l00094"></a>00094         $adapter = null;
<a name="l00095"></a>00095         <span class="keywordflow">if</span> ($spec instanceof Zend_Queue_Adapter_AdapterInterface) {
<a name="l00096"></a>00096             $adapter = $spec;
<a name="l00097"></a>00097         } elseif (is_string($spec)) {
<a name="l00098"></a>00098             $adapter = $spec;
<a name="l00099"></a>00099         } elseif ($spec instanceof <a class="code" href="class_zend___config.html">Zend_Config</a>) {
<a name="l00100"></a>00100             $options = $spec-&gt;toArray();
<a name="l00101"></a>00101         } elseif (is_array($spec)) {
<a name="l00102"></a>00102             $options = $spec;
<a name="l00103"></a>00103         }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105         <span class="comment">// last minute error checking</span>
<a name="l00106"></a>00106         <span class="keywordflow">if</span> ((null === $adapter)
<a name="l00107"></a>00107             &amp;&amp; (!is_array($options) &amp;&amp; (!$options instanceof Zend_Config))
<a name="l00108"></a>00108         ) {
<a name="l00109"></a>00109             require_once <span class="stringliteral">&#39;Zend/Queue/Exception.php&#39;</span>;
<a name="l00110"></a>00110             <span class="keywordflow">throw</span> <span class="keyword">new</span> Zend_Queue_Exception(<span class="stringliteral">&#39;No valid params passed to constructor&#39;</span>);
<a name="l00111"></a>00111         }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113         <span class="comment">// Now continue as we would if we were a normal constructor</span>
<a name="l00114"></a>00114         <span class="keywordflow">if</span> ($options instanceof Zend_Config) {
<a name="l00115"></a>00115             $options = $options-&gt;toArray();
<a name="l00116"></a>00116         } elseif (!is_array($options)) {
<a name="l00117"></a>00117             $options = array();
<a name="l00118"></a>00118         }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120         <span class="comment">// Make sure we have some defaults to work with</span>
<a name="l00121"></a>00121         <span class="keywordflow">if</span> (!isset($options[self::TIMEOUT])) {
<a name="l00122"></a>00122             $options[<a class="code" href="class_zend___queue.html#ae001ea02b5d8fb1d82b0f9a0e891774e">self::TIMEOUT</a>] = <a class="code" href="class_zend___queue.html#a5c1d21a821ffa40b6a58b7a34d8a3874">self::VISIBILITY_TIMEOUT</a>;
<a name="l00123"></a>00123         }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125         <span class="comment">// Make sure all defaults are appropriately set.</span>
<a name="l00126"></a>00126         <span class="keywordflow">if</span> (!array_key_exists(<span class="stringliteral">&#39;timeout&#39;</span>, $options)) {
<a name="l00127"></a>00127             $options[<a class="code" href="class_zend___queue.html#ae001ea02b5d8fb1d82b0f9a0e891774e">self::TIMEOUT</a>] = <a class="code" href="class_zend___queue.html#a5c1d21a821ffa40b6a58b7a34d8a3874">self::VISIBILITY_TIMEOUT</a>;
<a name="l00128"></a>00128         }
<a name="l00129"></a>00129         <span class="keywordflow">if</span> (array_key_exists(<span class="stringliteral">&#39;messageClass&#39;</span>, $options)) {
<a name="l00130"></a>00130             $this-&gt;<a class="code" href="class_zend___queue.html#a610300dc7243ace1e1a96cf817886ed8">setMessageClass</a>($options[<span class="stringliteral">&#39;messageClass&#39;</span>]);
<a name="l00131"></a>00131         }
<a name="l00132"></a>00132         <span class="keywordflow">if</span> (array_key_exists(<span class="stringliteral">&#39;messageSetClass&#39;</span>, $options)) {
<a name="l00133"></a>00133             $this-&gt;<a class="code" href="class_zend___queue.html#a98979ed0f4849d3b186fd10cb7fe817c">setMessageSetClass</a>($options[<span class="stringliteral">&#39;messageSetClass&#39;</span>]);
<a name="l00134"></a>00134         }
<a name="l00135"></a>00135 
<a name="l00136"></a>00136         $this-&gt;<a class="code" href="class_zend___queue.html#a673b5e9db470a52ea28b56a44e23e2d0">setOptions</a>($options);
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         <span class="comment">// if we were passed an adapter we either build the $adapter or use it</span>
<a name="l00139"></a>00139         <span class="keywordflow">if</span> (null !== $adapter) {
<a name="l00140"></a>00140             $this-&gt;<a class="code" href="class_zend___queue.html#a1beb9464cf6edcc63f5507d55e173001">setAdapter</a>($adapter);
<a name="l00141"></a>00141         }
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143 
<a name="l00150"></a><a class="code" href="class_zend___queue.html#a673b5e9db470a52ea28b56a44e23e2d0">00150</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a673b5e9db470a52ea28b56a44e23e2d0">setOptions</a>(array $options)
<a name="l00151"></a>00151     {
<a name="l00152"></a>00152         $this-&gt;_options = array_merge($this-&gt;_options, $options);
<a name="l00153"></a>00153         <span class="keywordflow">return</span> $this;
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155 
<a name="l00163"></a><a class="code" href="class_zend___queue.html#a7184fec9134a57cae6ef66b3588513d1">00163</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a7184fec9134a57cae6ef66b3588513d1">setOption</a>($name, $value)
<a name="l00164"></a>00164     {
<a name="l00165"></a>00165         $this-&gt;_options[(string) $name] = $value;
<a name="l00166"></a>00166         <span class="keywordflow">return</span> $this;
<a name="l00167"></a>00167     }
<a name="l00168"></a>00168 
<a name="l00174"></a><a class="code" href="class_zend___queue.html#a1a49b8dded6e91a52e2fd07195d334da">00174</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a1a49b8dded6e91a52e2fd07195d334da">getOptions</a>()
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176         <span class="keywordflow">return</span> $this-&gt;_options;
<a name="l00177"></a>00177     }
<a name="l00178"></a>00178 
<a name="l00185"></a><a class="code" href="class_zend___queue.html#a93cc4c82c649f5685d81ed5c3327e913">00185</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a93cc4c82c649f5685d81ed5c3327e913">hasOption</a>($name)
<a name="l00186"></a>00186     {
<a name="l00187"></a>00187         <span class="keywordflow">return</span> array_key_exists($name, $this-&gt;_options);
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189 
<a name="l00196"></a><a class="code" href="class_zend___queue.html#a86acce3c002ca1af709fd1b04f2f82fa">00196</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a86acce3c002ca1af709fd1b04f2f82fa">getOption</a>($name)
<a name="l00197"></a>00197     {
<a name="l00198"></a>00198         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_zend___queue.html#a93cc4c82c649f5685d81ed5c3327e913">hasOption</a>($name)) {
<a name="l00199"></a>00199             <span class="keywordflow">return</span> $this-&gt;_options[$name];
<a name="l00200"></a>00200         }
<a name="l00201"></a>00201         <span class="keywordflow">return</span> null;
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203 
<a name="l00210"></a><a class="code" href="class_zend___queue.html#a1beb9464cf6edcc63f5507d55e173001">00210</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a1beb9464cf6edcc63f5507d55e173001">setAdapter</a>($adapter)
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212         <span class="keywordflow">if</span> (is_string($adapter)) {
<a name="l00213"></a>00213             <span class="keywordflow">if</span> (null === ($adapterNamespace = $this-&gt;<a class="code" href="class_zend___queue.html#a86acce3c002ca1af709fd1b04f2f82fa">getOption</a>(<span class="stringliteral">&#39;adapterNamespace&#39;</span>))) {
<a name="l00214"></a>00214                 $adapterNamespace = <span class="stringliteral">&#39;Zend_Queue_Adapter&#39;</span>;
<a name="l00215"></a>00215             }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217             $adapterName = str_replace(
<a name="l00218"></a>00218                 <span class="charliteral">&#39; &#39;</span>,
<a name="l00219"></a>00219                 <span class="charliteral">&#39;_&#39;</span>,
<a name="l00220"></a>00220                 ucwords(
<a name="l00221"></a>00221                     str_replace(
<a name="l00222"></a>00222                         <span class="charliteral">&#39;_&#39;</span>,
<a name="l00223"></a>00223                         <span class="charliteral">&#39; &#39;</span>,
<a name="l00224"></a>00224                         strtolower($adapterNamespace . <span class="charliteral">&#39;_&#39;</span> . $adapter)
<a name="l00225"></a>00225                     )
<a name="l00226"></a>00226                 )
<a name="l00227"></a>00227             );
<a name="l00228"></a>00228 
<a name="l00229"></a>00229             <span class="keywordflow">if</span> (!class_exists($adapterName)) {
<a name="l00230"></a>00230                 require_once <span class="stringliteral">&#39;Zend/Loader.php&#39;</span>;
<a name="l00231"></a>00231                 <a class="code" href="class_zend___loader.html#a3d4b9877e0dcc1904b8e41d86be11d93">Zend_Loader::loadClass</a>($adapterName);
<a name="l00232"></a>00232             }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234             <span class="comment">/*</span>
<a name="l00235"></a>00235 <span class="comment">             * Create an instance of the adapter class.</span>
<a name="l00236"></a>00236 <span class="comment">             * Pass the configuration to the adapter class constructor.</span>
<a name="l00237"></a>00237 <span class="comment">             */</span>
<a name="l00238"></a>00238             $adapter = <span class="keyword">new</span> $adapterName($this-&gt;<a class="code" href="class_zend___queue.html#a1a49b8dded6e91a52e2fd07195d334da">getOptions</a>(), $this);
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241         <span class="keywordflow">if</span> (!$adapter instanceof Zend_Queue_Adapter_AdapterInterface) {
<a name="l00242"></a>00242             require_once <span class="stringliteral">&#39;Zend/Queue/Exception.php&#39;</span>;
<a name="l00243"></a>00243             <span class="keywordflow">throw</span> <span class="keyword">new</span> Zend_Queue_Exception(<span class="stringliteral">&quot;Adapter class &#39;&quot;</span> . get_class($adapterName) . <span class="stringliteral">&quot;&#39; does not implement Zend_Queue_Adapter_AdapterInterface&quot;</span>);
<a name="l00244"></a>00244         }
<a name="l00245"></a>00245 
<a name="l00246"></a>00246         $this-&gt;_adapter = $adapter;
<a name="l00247"></a>00247 
<a name="l00248"></a>00248         $this-&gt;_adapter-&gt;setQueue($this);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250         <span class="keywordflow">if</span> (null !== ($name = $this-&gt;<a class="code" href="class_zend___queue.html#a86acce3c002ca1af709fd1b04f2f82fa">getOption</a>(self::NAME))) {
<a name="l00251"></a>00251             $this-&gt;<a class="code" href="class_zend___queue.html#a2cc68857f63d7a2a49b0a01af9b92849">_setName</a>($name);
<a name="l00252"></a>00252         }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254         <span class="keywordflow">return</span> $this;
<a name="l00255"></a>00255     }
<a name="l00256"></a>00256 
<a name="l00262"></a><a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">00262</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()
<a name="l00263"></a>00263     {
<a name="l00264"></a>00264         <span class="keywordflow">return</span> $this-&gt;_adapter;
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266 
<a name="l00271"></a><a class="code" href="class_zend___queue.html#a610300dc7243ace1e1a96cf817886ed8">00271</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a610300dc7243ace1e1a96cf817886ed8">setMessageClass</a>($className)
<a name="l00272"></a>00272     {
<a name="l00273"></a>00273         $this-&gt;_messageClass = (string) $className;
<a name="l00274"></a>00274         <span class="keywordflow">return</span> $this;
<a name="l00275"></a>00275     }
<a name="l00276"></a>00276 
<a name="l00280"></a><a class="code" href="class_zend___queue.html#af705366b36c393e0d8d61e6fdd911158">00280</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#af705366b36c393e0d8d61e6fdd911158">getMessageClass</a>()
<a name="l00281"></a>00281     {
<a name="l00282"></a>00282         <span class="keywordflow">return</span> $this-&gt;_messageClass;
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284 
<a name="l00289"></a><a class="code" href="class_zend___queue.html#a98979ed0f4849d3b186fd10cb7fe817c">00289</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a98979ed0f4849d3b186fd10cb7fe817c">setMessageSetClass</a>($className)
<a name="l00290"></a>00290     {
<a name="l00291"></a>00291         $this-&gt;_messageSetClass = (string) $className;
<a name="l00292"></a>00292         <span class="keywordflow">return</span> $this;
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294 
<a name="l00298"></a><a class="code" href="class_zend___queue.html#aff28cc8c476d48e8b4e249d9ed1d90f9">00298</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#aff28cc8c476d48e8b4e249d9ed1d90f9">getMessageSetClass</a>()
<a name="l00299"></a>00299     {
<a name="l00300"></a>00300         <span class="keywordflow">return</span> $this-&gt;_messageSetClass;
<a name="l00301"></a>00301     }
<a name="l00302"></a>00302 
<a name="l00311"></a><a class="code" href="class_zend___queue.html#a3d0963e68bb313b163a73f2803c64600">00311</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a3d0963e68bb313b163a73f2803c64600">getName</a>()
<a name="l00312"></a>00312     {
<a name="l00313"></a>00313         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___queue.html#a86acce3c002ca1af709fd1b04f2f82fa">getOption</a>(self::NAME);
<a name="l00314"></a>00314     }
<a name="l00315"></a>00315 
<a name="l00324"></a><a class="code" href="class_zend___queue.html#a5ca455dfdc8a46cc12a0caf24784b824">00324</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a5ca455dfdc8a46cc12a0caf24784b824">createQueue</a>($name, $timeout = null)
<a name="l00325"></a>00325     {
<a name="l00326"></a>00326         <span class="keywordflow">if</span> (!is_string($name)) {
<a name="l00327"></a>00327             require_once <span class="stringliteral">&#39;Zend/Queue/Exception.php&#39;</span>;
<a name="l00328"></a>00328             <span class="keywordflow">throw</span> <span class="keyword">new</span> Zend_Queue_Exception(<span class="stringliteral">&#39;$name is not a string&#39;</span>);
<a name="l00329"></a>00329         }
<a name="l00330"></a>00330 
<a name="l00331"></a>00331         <span class="keywordflow">if</span> ((null !== $timeout) &amp;&amp; !is_integer($timeout)) {
<a name="l00332"></a>00332             require_once <span class="stringliteral">&#39;Zend/Queue/Exception.php&#39;</span>;
<a name="l00333"></a>00333             <span class="keywordflow">throw</span> <span class="keyword">new</span> Zend_Queue_Exception(<span class="stringliteral">&#39;$timeout must be an integer&#39;</span>);
<a name="l00334"></a>00334         }
<a name="l00335"></a>00335 
<a name="l00336"></a>00336         <span class="comment">// Default to standard timeout</span>
<a name="l00337"></a>00337         <span class="keywordflow">if</span> (null === $timeout) {
<a name="l00338"></a>00338             $timeout = $this-&gt;<a class="code" href="class_zend___queue.html#a86acce3c002ca1af709fd1b04f2f82fa">getOption</a>(self::TIMEOUT);
<a name="l00339"></a>00339         }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341         <span class="comment">// Some queues allow you to create on the fly, but cannot return</span>
<a name="l00342"></a>00342         <span class="comment">// a list of queues.  Stomp protocol for example.</span>
<a name="l00343"></a>00343         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_zend___queue.html#ab5cc2b10ab2ca65e08d2a1b76d8499aa">isSupported</a>(<span class="stringliteral">&#39;create&#39;</span>)) {
<a name="l00344"></a>00344             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;isExists($name)) {
<a name="l00345"></a>00345                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00346"></a>00346             }
<a name="l00347"></a>00347 
<a name="l00348"></a>00348             <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;create($name, $timeout)) {
<a name="l00349"></a>00349                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00350"></a>00350             }
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353         $options = array(
<a name="l00354"></a>00354             self::NAME  =&gt; $name,
<a name="l00355"></a>00355             <span class="stringliteral">&#39;timeout&#39;</span>   =&gt; $timeout
<a name="l00356"></a>00356         );
<a name="l00357"></a>00357 
<a name="l00358"></a>00358         <span class="keywordflow">return</span> <span class="keyword">new</span> <span class="keyword">self</span>($this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>(), $options);
<a name="l00359"></a>00359     }
<a name="l00360"></a>00360 
<a name="l00369"></a><a class="code" href="class_zend___queue.html#a6213fed13242d59f0aed403fa577992b">00369</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a6213fed13242d59f0aed403fa577992b">deleteQueue</a>()
<a name="l00370"></a>00370     {
<a name="l00371"></a>00371         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_zend___queue.html#ab5cc2b10ab2ca65e08d2a1b76d8499aa">isSupported</a>(<span class="stringliteral">&#39;delete&#39;</span>)) {
<a name="l00372"></a>00372             $deleted = $this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;delete($this-&gt;<a class="code" href="class_zend___queue.html#a3d0963e68bb313b163a73f2803c64600">getName</a>());
<a name="l00373"></a>00373         }
<a name="l00374"></a>00374         <span class="keywordflow">else</span> {
<a name="l00375"></a>00375             $deleted = <span class="keyword">true</span>;
<a name="l00376"></a>00376         }
<a name="l00377"></a>00377 
<a name="l00381"></a>00381         require_once(<span class="stringliteral">&#39;Zend/Queue/Adapter/Null.php&#39;</span>);
<a name="l00382"></a>00382         $this-&gt;<a class="code" href="class_zend___queue.html#a1beb9464cf6edcc63f5507d55e173001">setAdapter</a>(<span class="keyword">new</span> Zend_Queue_Adapter_Null($this-&gt;<a class="code" href="class_zend___queue.html#a1a49b8dded6e91a52e2fd07195d334da">getOptions</a>()));
<a name="l00383"></a>00383 
<a name="l00384"></a>00384         <span class="keywordflow">return</span> $deleted;
<a name="l00385"></a>00385     }
<a name="l00386"></a>00386 
<a name="l00399"></a><a class="code" href="class_zend___queue.html#a2bd451d5473f1e7bd545373d485b30dc">00399</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a2bd451d5473f1e7bd545373d485b30dc">deleteMessage</a>(Zend_Queue_Message $message)
<a name="l00400"></a>00400     {
<a name="l00401"></a>00401         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;<a class="code" href="class_zend___queue.html#ab5cc2b10ab2ca65e08d2a1b76d8499aa">isSupported</a>(<span class="stringliteral">&#39;deleteMessage&#39;</span>)) {
<a name="l00402"></a>00402             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;deleteMessage($message);
<a name="l00403"></a>00403         }
<a name="l00404"></a>00404         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00405"></a>00405     }
<a name="l00406"></a>00406 
<a name="l00414"></a><a class="code" href="class_zend___queue.html#aa06a9d0e68532ceeeb176f5ceb9e15ca">00414</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#aa06a9d0e68532ceeeb176f5ceb9e15ca">send</a>($message)
<a name="l00415"></a>00415     {
<a name="l00416"></a>00416         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;send($message);
<a name="l00417"></a>00417     }
<a name="l00418"></a>00418 
<a name="l00424"></a><a class="code" href="class_zend___queue.html#ac751e87b3d4c4bf2feb03bee8b092755">00424</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#ac751e87b3d4c4bf2feb03bee8b092755">count</a>()
<a name="l00425"></a>00425     {
<a name="l00426"></a>00426         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;<a class="code" href="class_zend___queue.html#ab5cc2b10ab2ca65e08d2a1b76d8499aa">isSupported</a>(<span class="stringliteral">&#39;count&#39;</span>)) {
<a name="l00427"></a>00427             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;count();
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429         <span class="keywordflow">return</span> 0;
<a name="l00430"></a>00430     }
<a name="l00431"></a>00431 
<a name="l00439"></a><a class="code" href="class_zend___queue.html#ad041b430d06a557c153a172a17f24309">00439</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#ad041b430d06a557c153a172a17f24309">receive</a>($maxMessages=null, $timeout=null)
<a name="l00440"></a>00440     {
<a name="l00441"></a>00441         <span class="keywordflow">if</span> (($maxMessages !== null) &amp;&amp; !is_integer($maxMessages)) {
<a name="l00442"></a>00442             require_once <span class="stringliteral">&#39;Zend/Queue/Exception.php&#39;</span>;
<a name="l00443"></a>00443             <span class="keywordflow">throw</span> <span class="keyword">new</span> Zend_Queue_Exception(<span class="stringliteral">&#39;$maxMessages must be an integer or null&#39;</span>);
<a name="l00444"></a>00444         }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446         <span class="keywordflow">if</span> (($timeout !== null) &amp;&amp; !is_integer($timeout)) {
<a name="l00447"></a>00447             require_once <span class="stringliteral">&#39;Zend/Queue/Exception.php&#39;</span>;
<a name="l00448"></a>00448             <span class="keywordflow">throw</span> <span class="keyword">new</span> Zend_Queue_Exception(<span class="stringliteral">&#39;$timeout must be an integer or null&#39;</span>);
<a name="l00449"></a>00449         }
<a name="l00450"></a>00450 
<a name="l00451"></a>00451         <span class="comment">// Default to returning only one message</span>
<a name="l00452"></a>00452         <span class="keywordflow">if</span> ($maxMessages === null) {
<a name="l00453"></a>00453             $maxMessages = 1;
<a name="l00454"></a>00454         }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456         <span class="comment">// Default to standard timeout</span>
<a name="l00457"></a>00457         <span class="keywordflow">if</span> ($timeout === null) {
<a name="l00458"></a>00458             $timeout = $this-&gt;<a class="code" href="class_zend___queue.html#a86acce3c002ca1af709fd1b04f2f82fa">getOption</a>(self::TIMEOUT);
<a name="l00459"></a>00459         }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;receive($maxMessages, $timeout);
<a name="l00462"></a>00462     }
<a name="l00463"></a>00463 
<a name="l00473"></a><a class="code" href="class_zend___queue.html#aef6a344a8de433b50039668ea77ed506">00473</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#aef6a344a8de433b50039668ea77ed506">getCapabilities</a>()
<a name="l00474"></a>00474     {
<a name="l00475"></a>00475         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;getCapabilities();
<a name="l00476"></a>00476     }
<a name="l00477"></a>00477 
<a name="l00484"></a><a class="code" href="class_zend___queue.html#ab5cc2b10ab2ca65e08d2a1b76d8499aa">00484</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#ab5cc2b10ab2ca65e08d2a1b76d8499aa">isSupported</a>($name)
<a name="l00485"></a>00485     {
<a name="l00486"></a>00486         $translation = array(
<a name="l00487"></a>00487             <span class="stringliteral">&#39;deleteQueue&#39;</span> =&gt; <span class="stringliteral">&#39;delete&#39;</span>,
<a name="l00488"></a>00488             <span class="stringliteral">&#39;createQueue&#39;</span> =&gt; <span class="stringliteral">&#39;create&#39;</span>
<a name="l00489"></a>00489         );
<a name="l00490"></a>00490 
<a name="l00491"></a>00491         <span class="keywordflow">if</span> (isset($translation[$name])) {
<a name="l00492"></a>00492             $name = $translation[$name];
<a name="l00493"></a>00493         }
<a name="l00494"></a>00494 
<a name="l00495"></a>00495         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;isSupported($name);
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497 
<a name="l00504"></a><a class="code" href="class_zend___queue.html#a6b6e231467d1199cd7a1a0e7f24cddcd">00504</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#a6b6e231467d1199cd7a1a0e7f24cddcd">getQueues</a>()
<a name="l00505"></a>00505     {
<a name="l00506"></a>00506         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="class_zend___queue.html#ab5cc2b10ab2ca65e08d2a1b76d8499aa">isSupported</a>(<span class="stringliteral">&#39;getQueues&#39;</span>)) {
<a name="l00507"></a>00507             <span class="keywordflow">throw</span> <span class="keyword">new</span> Zend_Queue_Exception( __FUNCTION__ . <span class="stringliteral">&#39;() is not supported by &#39;</span> . get_class($this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()));
<a name="l00508"></a>00508         }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;getQueues();
<a name="l00511"></a>00511     }
<a name="l00512"></a>00512 
<a name="l00521"></a><a class="code" href="class_zend___queue.html#a2cc68857f63d7a2a49b0a01af9b92849">00521</a>     <span class="keyword">protected</span> function <a class="code" href="class_zend___queue.html#a2cc68857f63d7a2a49b0a01af9b92849">_setName</a>($name)
<a name="l00522"></a>00522     {
<a name="l00523"></a>00523         <span class="keywordflow">if</span> (!is_string($name)) {
<a name="l00527"></a>00527             require_once <span class="stringliteral">&#39;Zend/Queue/Exception.php&#39;</span>;
<a name="l00528"></a>00528             <span class="keywordflow">throw</span> <span class="keyword">new</span> Zend_Queue_Exception(<span class="stringliteral">&quot;$name is not a string&quot;</span>);
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530 
<a name="l00531"></a>00531         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;<a class="code" href="class_zend___queue.html#ab5cc2b10ab2ca65e08d2a1b76d8499aa">isSupported</a>(<span class="stringliteral">&#39;create&#39;</span>)) {
<a name="l00532"></a>00532             <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;isExists($name)) {
<a name="l00533"></a>00533                 $timeout = $this-&gt;<a class="code" href="class_zend___queue.html#a86acce3c002ca1af709fd1b04f2f82fa">getOption</a>(self::TIMEOUT);
<a name="l00534"></a>00534 
<a name="l00535"></a>00535                 <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;create($name, $timeout)) {
<a name="l00536"></a>00536                     <span class="comment">// Unable to create the new queue</span>
<a name="l00537"></a>00537                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00538"></a>00538                 }
<a name="l00539"></a>00539             }
<a name="l00540"></a>00540         }
<a name="l00541"></a>00541 
<a name="l00542"></a>00542         $this-&gt;<a class="code" href="class_zend___queue.html#a7184fec9134a57cae6ef66b3588513d1">setOption</a>(self::NAME, $name);
<a name="l00543"></a>00543 
<a name="l00544"></a>00544         <span class="keywordflow">return</span> $this;
<a name="l00545"></a>00545     }
<a name="l00546"></a>00546 
<a name="l00553"></a><a class="code" href="class_zend___queue.html#ae3f4a73488445b464740e5f3fc54d4ed">00553</a>     <span class="keyword">public</span> function <a class="code" href="class_zend___queue.html#ae3f4a73488445b464740e5f3fc54d4ed">debugInfo</a>()
<a name="l00554"></a>00554     {
<a name="l00555"></a>00555         $info = array();
<a name="l00556"></a>00556         $info[<span class="stringliteral">&#39;self&#39;</span>]                     = get_class($this);
<a name="l00557"></a>00557         $info[<span class="stringliteral">&#39;adapter&#39;</span>]                  = get_class($this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>());
<a name="l00558"></a>00558         <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="class_zend___queue.html#a23a4c71383d4d2dfc4ccade9fc78e5b9">getAdapter</a>()-&gt;<a class="code" href="class_zend___queue.html#aef6a344a8de433b50039668ea77ed506">getCapabilities</a>() as $feature =&gt; $supported) {
<a name="l00559"></a>00559             $info[<span class="stringliteral">&#39;adapter-&#39;</span> . $feature]  = ($supported) ? <span class="stringliteral">&#39;yes&#39;</span> : <span class="stringliteral">&#39;no&#39;</span>;
<a name="l00560"></a>00560         }
<a name="l00561"></a>00561         $info[<span class="stringliteral">&#39;options&#39;</span>]                  = $this-&gt;<a class="code" href="class_zend___queue.html#a1a49b8dded6e91a52e2fd07195d334da">getOptions</a>();
<a name="l00562"></a>00562         $info[<span class="stringliteral">&#39;options&#39;</span>][<span class="stringliteral">&#39;driverOptions&#39;</span>] = <span class="stringliteral">&#39;[hidden]&#39;</span>;
<a name="l00563"></a>00563         $info[<span class="stringliteral">&#39;currentQueue&#39;</span>]             = $this-&gt;<a class="code" href="class_zend___queue.html#a3d0963e68bb313b163a73f2803c64600">getName</a>();
<a name="l00564"></a>00564         $info[<span class="stringliteral">&#39;messageClass&#39;</span>]             = $this-&gt;<a class="code" href="class_zend___queue.html#af705366b36c393e0d8d61e6fdd911158">getMessageClass</a>();
<a name="l00565"></a>00565         $info[<span class="stringliteral">&#39;messageSetClass&#39;</span>]          = $this-&gt;<a class="code" href="class_zend___queue.html#aff28cc8c476d48e8b4e249d9ed1d90f9">getMessageSetClass</a>();
<a name="l00566"></a>00566 
<a name="l00567"></a>00567         <span class="keywordflow">return</span> $info;
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Apr 19 2012 17:01:18 for openbiz by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
